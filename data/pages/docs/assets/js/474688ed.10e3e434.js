"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[4305],{1184(n,e,a){a.d(e,{R:()=>o,x:()=>r});var t=a(4041);const s={},i=t.createContext(s);function o(n){const e=t.useContext(i);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:o(n.components),t.createElement(i.Provider,{value:e},n.children)}},9753(n,e,a){a.r(e),a.d(e,{assets:()=>d,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"boards/automations","title":"Automations & Scheduling","description":"Create scheduled tasks and automated workflows that run independently of user interaction.","source":"@site/docs/boards/automations.md","sourceDirName":"boards","slug":"/boards/automations","permalink":"/docs/docs/boards/automations","draft":false,"unlisted":false,"editUrl":"https://github.com/protofy-xyz/protofy/tree/main/apps/docs/docs/boards/automations.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Boards & Cards","permalink":"/docs/docs/category/boards--cards"},"next":{"title":"Card Rendering","permalink":"/docs/docs/boards/card-rendering"}}');var s=a(1085),i=a(1184);const o={},r="Automations & Scheduling",d={},c=[{value:"Creating Automations",id:"creating-automations",level:2},{value:"Basic Automation",id:"basic-automation",level:3},{value:"Automation Options",id:"automation-options",level:2},{value:"What Gets Created",id:"what-gets-created",level:2},{value:"Scheduling",id:"scheduling",level:2},{value:"One-Time Schedule",id:"one-time-schedule",level:3},{value:"Periodic Schedule (Cron-like)",id:"periodic-schedule-cron-like",level:3},{value:"Advanced Scheduling",id:"advanced-scheduling",level:3},{value:"Day Names",id:"day-names",level:3},{value:"Cron Expression Format",id:"cron-expression-format",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"API Endpoints",id:"api-endpoints",level:2}];function l(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"automations--scheduling",children:"Automations & Scheduling"})}),"\n",(0,s.jsx)(e.p,{children:"Create scheduled tasks and automated workflows that run independently of user interaction."}),"\n",(0,s.jsx)(e.h2,{id:"creating-automations",children:"Creating Automations"}),"\n",(0,s.jsxs)(e.p,{children:["Automations are defined in ",(0,s.jsx)(e.code,{children:"data/automations/"})," and expose custom API endpoints."]}),"\n",(0,s.jsx)(e.h3,{id:"basic-automation",children:"Basic Automation"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-javascript",children:"// data/automations/myTask.ts\nimport { Protofy } from 'protobase'\nimport APIContext from 'app/bundles/context'\n\nexport default Protofy(\"code\", async (app, context: typeof APIContext) => {\n    await context.automations.automation({\n        name: 'daily-report',\n        app: app,\n        description: 'Generate and send daily report',\n        automationParams: {\n            email: { description: 'Email to send report to' }\n        },\n        onRun: async (params, res, name) => {\n            // Your automation logic here\n            console.log('Running daily report for', params.email)\n            // res.send() is available for manual response mode\n        }\n    })\n})\n"})}),"\n",(0,s.jsx)(e.h2,{id:"automation-options",children:"Automation Options"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-typescript",children:"context.automations.automation({\n    name: string,                    // Unique identifier\n    app: Express.Application,        // Express app instance\n    \n    // Response handling\n    responseMode?: 'instant' | 'wait' | 'manual',\n    // - 'instant': Returns immediately, task runs in background\n    // - 'wait': Waits for task completion (default)\n    // - 'manual': You control the response via res.send()\n    \n    // Parameters\n    automationParams?: Record<string, { description: string }>,\n    cardConfigParams?: Record<string, CardConfigParam>,\n    \n    // Metadata\n    displayName?: string,\n    description?: string,\n    tags?: string[],\n    sourceFile?: string,\n    \n    // Callbacks\n    onRun: (params, res, name) => Promise<void>,\n    onError?: (err) => void\n})\n"})}),"\n",(0,s.jsx)(e.h2,{id:"what-gets-created",children:"What Gets Created"}),"\n",(0,s.jsxs)(e.p,{children:["When you call ",(0,s.jsx)(e.code,{children:"automation()"}),", it automatically:"]}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Registers in automations API"})," at ",(0,s.jsx)(e.code,{children:"/api/core/v1/automations"})]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Creates action endpoint"})," at ",(0,s.jsx)(e.code,{children:"/api/v1/automations/{name}"})]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Registers action"})," for board use"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Creates card template"})," for AI agents"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"scheduling",children:"Scheduling"}),"\n",(0,s.jsx)(e.h3,{id:"one-time-schedule",children:"One-Time Schedule"}),"\n",(0,s.jsx)(e.p,{children:"Schedule a task to run at a specific date/time:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-javascript",children:"context.automations.createSchedule(\n    '14:30',           // time (HH:mm)\n    async () => {\n        // Task logic\n        console.log('Running scheduled task')\n    },\n    15,                // day of month\n    'march',           // month\n    2025               // year\n)\n"})}),"\n",(0,s.jsx)(e.h3,{id:"periodic-schedule-cron-like",children:"Periodic Schedule (Cron-like)"}),"\n",(0,s.jsx)(e.p,{children:"Schedule recurring tasks:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-javascript",children:"context.automations.createPeriodicSchedule(\n    8,                 // hour (0-23)\n    30,                // minute (0-59)\n    async () => {\n        // Task logic\n        await generateReport()\n    },\n    'monday,wednesday,friday'  // days\n)\n"})}),"\n",(0,s.jsx)(e.h3,{id:"advanced-scheduling",children:"Advanced Scheduling"}),"\n",(0,s.jsxs)(e.p,{children:["For more control, use ",(0,s.jsx)(e.code,{children:"scheduleJob"}),":"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-javascript",children:"const job = context.automations.scheduleJob({\n    name: 'backup-job',           // For logging\n    hours: 2,                     // 2 AM\n    minutes: 0,\n    days: 'sunday',               // Every Sunday\n    \n    // Or use raw cron expression\n    croneTime: '0 0 2 * * 0',    // Alternative to hours/minutes/days\n    \n    callback: async () => {\n        await performBackup()\n    },\n    \n    autoStart: true,              // Start immediately\n    runOnInit: false              // Don't run on creation\n})\n\n// Control the job\njob.stop()   // Pause\njob.start()  // Resume\n"})}),"\n",(0,s.jsx)(e.h3,{id:"day-names",children:"Day Names"}),"\n",(0,s.jsx)(e.p,{children:"Supported day names (case-insensitive):"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"monday, tuesday, wednesday, thursday, friday, saturday, sunday"}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["Combine multiple: ",(0,s.jsx)(e.code,{children:"'monday,wednesday,friday'"})]}),"\n",(0,s.jsx)(e.h2,{id:"cron-expression-format",children:"Cron Expression Format"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 second (0-59)\n\u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 minute (0-59)\n\u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 hour (0-23)\n\u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 day of month (1-31)\n\u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500 month (1-12)\n\u2502 \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500 day of week (0-7, 0 or 7 is Sunday)\n\u2502 \u2502 \u2502 \u2502 \u2502 \u2502\n* * * * * *\n"})}),"\n",(0,s.jsx)(e.p,{children:"Examples:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"0 30 8 * * 1,3,5"})," - 8:30 AM on Mon, Wed, Fri"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"0 0 2 * * 0"})," - 2:00 AM every Sunday"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"0 */15 * * * *"})," - Every 15 minutes"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-javascript",children:"const job = context.automations.scheduleJob({\n    name: 'critical-task',\n    hours: 0,\n    minutes: 0,\n    days: 'sunday',\n    callback: async () => {\n        try {\n            await riskyOperation()\n        } catch (err) {\n            // Log error - job continues running\n            logger.error('Task failed:', err)\n            // Optionally notify\n            await sendAlert(err.message)\n        }\n    }\n})\n"})}),"\n",(0,s.jsx)(e.h2,{id:"api-endpoints",children:"API Endpoints"}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"Endpoint"}),(0,s.jsx)(e.th,{children:"Method"}),(0,s.jsx)(e.th,{children:"Description"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"/api/core/v1/automations"})}),(0,s.jsx)(e.td,{children:"GET"}),(0,s.jsx)(e.td,{children:"List automations"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"/api/core/v1/automations"})}),(0,s.jsx)(e.td,{children:"POST"}),(0,s.jsx)(e.td,{children:"Register automation"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"/api/v1/automations/{name}"})}),(0,s.jsx)(e.td,{children:"GET"}),(0,s.jsx)(e.td,{children:"Execute automation"})]})]})]})]})}function u(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(l,{...n})}):l(n)}}}]);