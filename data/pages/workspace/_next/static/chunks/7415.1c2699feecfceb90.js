"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7415],{97415:function(e,t,n){n.r(t),n.d(t,{BoardTextArea:function(){return k}});var r=n(52322),l=n(2784),o=n(37288),a=n(94291),i=n(47401),s=n(65009),c=n(18261),u=n(12497),d=n(77843),p=n(65606),g=n(17518),f=n(60166);let h=e=>{let{option:t,onSelect:n}=e,[a,i]=l.useState(!1);return t.children&&t.children.length>0?(0,r.jsxs)(o.FA,{gap:"$3",children:[(0,r.jsxs)(o.sL,{jc:"space-between",gap:"$3",ai:"center",onPress:()=>n(),children:[(0,r.jsx)(g.x,{children:t.label}),(0,r.jsx)(o.FA,{br:"$2",hoverStyle:{backgroundColor:"$gray8"},onPress:e=>{e.stopPropagation(),i(e=>!e)},children:(0,r.jsx)(f._,{height:"20px",color:"$gray9",rotate:a?"180deg":"0deg",style:{transition:"all ease-in-out 120ms"}})})]}),a&&(0,r.jsx)(o.FA,{pl:"$5",pb:"$2",children:t.children.map(e=>(0,r.jsxs)(o.sL,{jc:"space-between",gap:"$3",br:"$2",px:"$2",py:"$1",hoverStyle:{backgroundColor:"var(--gray8)"},onPress:()=>n(e.key),children:[(0,r.jsx)(o.sL,{gap:"$3",ai:"center",children:(0,r.jsx)(g.x,{children:e.label})}),e.rightText?(0,r.jsx)(g.x,{color:"$green11",children:e.rightText}):null]},e.key))})]}):(0,r.jsxs)(o.sL,{onPress:e=>{setTimeout(()=>n(),100)},jc:"space-between",gap:"$3",ai:"center",children:[(0,r.jsx)(o.sL,{gap:"$3",ai:"center",children:(0,r.jsx)(g.x,{children:t.label})}),t.description?(0,r.jsx)(g.x,{color:"$blue11",ellipsizeMode:"tail",numberOfLines:1,children:t.description}):t.rightText?(0,r.jsx)(g.x,{color:"$green11",textAlign:"right",ellipsizeMode:"tail",numberOfLines:1,children:t.rightText}):null]})};var b=e=>{var t;let{tabs:n,activeTabKey:a,onTabChange:i,position:s,maxWidth:c,selectedIndex:u,onSelectedIndexChange:d,onSelect:p,itemRefs:f,anchorRef:b,onClose:y}=e,x=l.useRef(null),v=()=>{null==y||y(),setTimeout(()=>{let e=null==b?void 0:b.current;e&&"function"==typeof e.focus&&e.focus()},50)},m=l.useMemo(()=>n.find(e=>e.key===a),[n,a]),w=null!==(t=null==m?void 0:m.options)&&void 0!==t?t:[];return(0,r.jsxs)(o.FA,{ref:x,style:{position:"absolute",minWidth:c?"".concat(Math.min(220,c),"px"):"220px",maxWidth:c?"".concat(c,"px"):"100%",width:"max-content",zIndex:10,top:s.top,left:s.left},maxHeight:"200px",overflowY:"scroll",p:"10px",br:"$4",bg:"$gray4",borderWidth:"1px",borderColor:"$gray6",gap:"$2",children:[(0,r.jsx)(o.sL,{gap:"$1",children:n.map(e=>{var t,n;let l=e.key===a,s=null!==(t=e.color)&&void 0!==t?t:"gray";return(0,r.jsx)(o.sL,{onPress:()=>{i(e.key),d(0)},bc:l?"$".concat(s,"6"):"transparent",px:"$3",py:"$1",br:"$2",children:(0,r.jsx)(g.x,{color:l?"$".concat(s,"11"):"$gray9",fontSize:"$5",textAlign:"center",alignSelf:"center",cursor:"pointer",style:{transition:"all ease-in-out 80ms"},children:null!==(n=e.label)&&void 0!==n?n:e.key})},e.key)})}),w.length?w.map((e,t)=>(0,r.jsx)(o.FA,{ref:e=>f.current[t]=e,onMouseEnter:()=>d(t),backgroundColor:t===u?"var(--gray6)":"transparent",hoverStyle:{backgroundColor:"var(--gray6"},justifyContent:"flex-start",cursor:"pointer",p:"$2",br:"$2",children:(0,r.jsx)(h,{option:e,onSelect:t=>{p({tabKey:a,optionKey:e.key,childKey:t}),v()}})},e.key)):(0,r.jsx)(g.x,{children:"no results"})]})};let y=e=>{let t=e.map(e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("");return new RegExp("^<[".concat(t,"][^>]+>$"))},x=(e,t,n)=>{let r=e.lastIndexOf("<",t);if(-1===r)return null;let l=e.indexOf(">",Math.max(t-1,0));if(-1===l)return null;let o=e.slice(r,l+1);return n.test(o)?{start:r,end:l+1}:null},v=["box-sizing","width","height","overflow-x","overflow-y","border-top-width","border-right-width","border-bottom-width","border-left-width","border-top-style","border-right-style","border-bottom-style","border-left-style","padding-top","padding-right","padding-bottom","padding-left","font-style","font-variant","font-weight","font-stretch","font-size","line-height","font-family","text-align","text-transform","text-indent","text-decoration","letter-spacing","word-spacing","tab-size","direction"],m=(e,t)=>{if(!e)return null;let n=window.getComputedStyle(e),r=document.createElement("div");v.forEach(e=>{let t=n.getPropertyValue(e);t&&r.style.setProperty(e,t)}),r.style.position="absolute",r.style.visibility="hidden",r.style.whiteSpace="pre-wrap",r.style.wordWrap="break-word",r.style.overflow="hidden";let l=e.value;r.textContent=l.slice(0,t);let o=document.createElement("span");o.textContent=l.slice(t)||".",r.appendChild(o),document.body.appendChild(r);let a=o.offsetTop,i=o.offsetLeft,s=parseFloat(n.lineHeight||"")||parseFloat(n.fontSize||"")||16,c=parseFloat(n.borderTopWidth||"")||0,u=parseFloat(n.borderLeftWidth||"")||0;return document.body.removeChild(r),{top:a,left:i,lineHeight:s,borderTop:c,borderLeft:u}},w=e=>{let{value:t,onChange:n,onEnter:a,placeholder:i,readOnly:s,disabled:c,style:u,containerStyle:d,mentionTabs:p,tokenSelectionPrefixes:g,...f}=e,h=e=>Object.entries(e).sort((e,t)=>t[0].length-e[0].length),v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;for(let[e,r]of h(t))n=n.replaceAll(e,r);return n},w=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;for(let[e,r]of h(t))n=n.replaceAll(r,e);return n},k=(e,t,n)=>e.replace(/<([^&][\s\S]*?)>/g,(e,r)=>{if(!Object.values(t).includes(e)){var l,o;return"<"+(null!==(o=null!==(l=n.find(e=>r.startsWith(e)))&&void 0!==l?l:n[0])&&void 0!==o?o:"#")+"unknown>"}return e}),S=(e,t)=>{let n={};for(let t of p)if("function"==typeof t.buildSymbols)try{let r=t.buildSymbols(e)||{};n={...n,...r}}catch(e){}t(n)},j=(0,l.useRef)(null),$=(0,l.useRef)(null),T=(0,l.useRef)(null),A=(0,l.useRef)([]),[C,E]=(0,l.useState)(null),[L,R]=(0,l.useState)(0),[M,O]=(0,l.useState)(0),[z,D]=(0,l.useState)({top:50,left:0}),[F,I]=(0,l.useState)(void 0),[P,W]=(0,l.useState)({}),[_,B]=(0,l.useState)(t),H=(0,l.useMemo)(()=>null!=g?g:p.map(e=>e.prefix),[p,g]),K=(0,l.useMemo)(()=>y(H),[H]),N=(0,l.useMemo)(()=>p.map(e=>{let{key:t,label:n,color:r,options:l}=e;return{key:t,label:n,color:r,options:l}}),[p]),U=(0,l.useMemo)(()=>{var e;let t=N.find(e=>e.key===C);return null!==(e=null==t?void 0:t.options)&&void 0!==e?e:[]},[N,C]),Z=(0,l.useCallback)(()=>{var e;if(!C)return;let t=$.current,n=j.current;if(!t||!n)return;let r="number"==typeof t.selectionStart?t.selectionStart:L,l=m(t,null!=r?r:0);if(!l)return;let o=t.getBoundingClientRect(),a=n.getBoundingClientRect(),i=o.top-a.top+l.top-t.scrollTop+l.lineHeight+l.borderTop,s=o.left-a.left+l.left-t.scrollLeft+l.borderLeft,c=null!==(e=null==n?void 0:n.offsetWidth)&&void 0!==e?e:a.width,u=Math.max(0,Math.min(s,Math.max(0,a.width-Math.min(320,c))));I(Math.min(320,Math.max(140,a.width-u-8))),D({top:Math.max(0,i+4),left:Math.max(0,u)})},[C,L]),q=(0,l.useMemo)(()=>{if(!C)return N;let e=_.slice(0,L).replace(/<[^>]*>/g,""),t=H.map(e=>e.replace(/[.*+?^${}()|[\]\\-]/g,"\\$&")).join(""),n=new RegExp("[".concat(t,"]\\s*$")),r=RegExp("[".concat(t,"]([^\\s").concat(t,"]+)"),"g"),l=n.test(e)?null:(()=>{let t=[...e.matchAll(r)];return t.length?t[t.length-1][1]:null})(),o=e=>{if(!l)return e;let t=l.toLowerCase();return e.filter(e=>e.label.toLowerCase().startsWith(t))};return N.map(e=>({...e,options:o(e.options)}))},[N,C,_,L]),J=(0,l.useMemo)(()=>{let e={};for(let n of p){var t;n.prefix&&(e[n.prefix]=null!==(t=n.color)&&void 0!==t?t:"gray")}let n=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return t=>n(t).replace(/&lt;([^&][\s\S]*?)&gt;/g,(t,n)=>{let r=null==n?void 0:n[0],l=r&&e[r]||"gray";return'<span style="'+"background-color: var(--".concat(l,"6); ")+"color: var(--".concat(l,"11); ")+'width: fit-content; display: inline; padding-block: 3px; border-radius: 5px;">'+'<span style="color:transparent">&lt;</span>'.concat(null!=n?n:"",'<span style="color:transparent">&gt;</span>')+"</span>"})},[p]);(0,l.useEffect)(()=>{let e=A.current[M];null==e||e.scrollIntoView({block:"nearest"})},[M]),(0,l.useEffect)(()=>{if(C){var e;null===(e=$.current)||void 0===e||e.focus(),Z()}},[C,M,Z]),(0,l.useLayoutEffect)(()=>{let e=$.current;e&&T.current&&(T.current.style.transform="translate(".concat(-e.scrollLeft,"px, ").concat(-e.scrollTop,"px)"))},[_]),(0,l.useEffect)(()=>{let e=w(k(t,P,H),P),n={};S(e,e=>Object.assign(n,e)),W(n),B(v(e,n))},[t]);let V=(0,l.useCallback)(e=>{var t;if(!e||C)return!1;let n=x(_,null!==(t=e.selectionStart)&&void 0!==t?t:0,K);return!!n&&(e.setSelectionRange(n.start,n.end),!0)},[_,C,K]),Y=()=>p.find(e=>e.key===C),G=()=>{let e=_.slice(0,L).replace(/<[^>]*>/g,""),t=H.map(e=>e.replace(/[.*+?^${}()|[\]\\-]/g,"\\$&")).join(""),n=new RegExp("[".concat(t,"]\\s*$")),r=RegExp("[".concat(t,"]([^\\s").concat(t,"]+)"),"g"),l=n.test(e)?null:(()=>{let t=[...e.matchAll(r)];return t.length?t[t.length-1][1]:null})();return null!=l?l:void 0},Q=e=>{var t;let n=Y();if(!n)return;let r=n.onInsert(e,{filter:G()}),l=_.slice(0,L).replace(/<[^>]*>/g,""),o=H.map(e=>e.replace(/[.*+?^${}()|[\]\\-]/g,"\\$&")).join(""),a=new RegExp("[".concat(o,"]([^\\s").concat(o,"]+)(?!.*[").concat(o,"][^\\s").concat(o,"]+)")),i=null===(t=l.match(a))||void 0===t?void 0:t[1];ee(i?_.slice(0,L-i.length-1)+(r+" ")+_.slice(L+1):_.slice(0,L-1)+(r+" ")+_.slice(L+1))},X=(e,t)=>{R(e);let n=(t.slice(0,e).split(" ").pop()||"")[0],r=p.find(e=>e.prefix===n);E(r?r.key:null)},ee=e=>{let t=w(k(e,P,H),P),r={};S(t,e=>Object.assign(r,e)),W(r),B(v(t,r)),n(t)};return(0,r.jsxs)(o.sL,{ref:j,position:"relative",flex:1,gap:"$3",height:"100%",opacity:c?.7:1,backgroundColor:"$bgPanel",padding:"$2",flexDirection:"column",style:d,children:[C&&(0,r.jsx)(b,{anchorRef:$,itemRefs:A,selectedIndex:M,onSelectedIndexChange:O,position:z,maxWidth:F,activeTabKey:C,onTabChange:E,tabs:q,onSelect:e=>{let{optionKey:t,childKey:n}=e,r=t,l=U.find(e=>e.key===t);(null==l?void 0:l.children)&&n&&(r=[t,n]),Q(r),E(null),setTimeout(()=>{let e=$.current;if(!e)return;let t="string"==typeof r?r.length:r.join("").length;e.setSelectionRange(L+t+3,L+t+3),e.focus()},1)},onClose:()=>E(null)}),(0,r.jsxs)(o.FA,{pos:"relative",f:1,w:"100%",children:[J&&(0,r.jsx)(o.FA,{display:"block","aria-hidden":!0,pointerEvents:"none",pos:"absolute",t:0,l:0,r:0,b:0,style:{boxSizing:"border-box",overflow:"hidden",lineHeight:"1.4",fontFamily:"inherit",fontSize:"inherit",fontWeight:"inherit",letterSpacing:"inherit",whiteSpace:"pre-wrap",overflowWrap:"break-word",wordBreak:"normal"},children:(0,r.jsx)("div",{ref:T,style:{willChange:"transform",transform:"translate(0,0)",padding:"12px"},dangerouslySetInnerHTML:{__html:J(_)}})}),(0,r.jsx)("textarea",{ref:$,readOnly:s,value:_,placeholder:i,disabled:c,onMouseDown:e=>{},onClick:e=>{var t;let n=e.currentTarget,r=null!==(t=n.selectionStart)&&void 0!==t?t:0,l=x(_,r,K);l&&r>l.start&&r<l.end&&n.setSelectionRange(l.start,l.end)},onDoubleClick:e=>{V(e.currentTarget)&&(e.preventDefault(),e.stopPropagation())},onSelect:e=>{var t;X(null!==(t=e.currentTarget.selectionStart)&&void 0!==t?t:0,e.currentTarget.value),C&&window.requestAnimationFrame(()=>Z())},onChange:e=>{var t;X(null!==(t=e.currentTarget.selectionStart)&&void 0!==t?t:0,e.currentTarget.value),ee(e.currentTarget.value)},onKeyUp:e=>{var t;R(null!==(t=e.currentTarget.selectionStart)&&void 0!==t?t:0),C&&window.requestAnimationFrame(()=>Z())},onKeyDown:e=>{var t,n,r,l,o,i,s,c,u;if(null===C){let s=e.currentTarget;switch(e.key){case"ArrowLeft":{let r=null!==(t=s.selectionStart)&&void 0!==t?t:0;if(r===(null!==(n=s.selectionEnd)&&void 0!==n?n:0)){let t=x(_,r,K);if(t&&r===t.end){e.preventDefault();let n=t.start;s.setSelectionRange(n,n)}}break}case"ArrowRight":{let t=null!==(r=s.selectionStart)&&void 0!==r?r:0;if(t===(null!==(l=s.selectionEnd)&&void 0!==l?l:0)){let n=x(_,t,K);if(n&&t===n.start){e.preventDefault();let t=n.end;s.setSelectionRange(t,t)}}break}case"Backspace":case"Delete":let c=null!==(o=s.selectionStart)&&void 0!==o?o:0;if(c===(null!==(i=s.selectionEnd)&&void 0!==i?i:0)){let t=_.slice(0,c),n=_.slice(c),r=t.match(/<[^>]+>$/);if(r){e.preventDefault();let t=c-r[0].length;ee(_.slice(0,t)+n),setTimeout(()=>null==s?void 0:s.setSelectionRange(t,t),0)}}break;case"Enter":if(e.shiftKey)return;e.preventDefault(),"function"==typeof a&&a(w(k(_,P,H),P))}}else{if("Backspace"===e.key){let t=e.currentTarget,n=null!==(s=t.selectionStart)&&void 0!==s?s:0;if(n===(null!==(c=t.selectionEnd)&&void 0!==c?c:0)){let e=_[n-1];e&&H.includes(e)&&E(null)}return}if(!["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Escape","Enter","Tab"].includes(e.key))return;e.preventDefault(),e.stopPropagation();let t=p.map(e=>e.key),n=t.indexOf(C);switch(e.key){case"ArrowLeft":E(t[(n-1+t.length)%t.length]),O(0);break;case"ArrowRight":E(t[(n+1)%t.length]),O(0);break;case"ArrowUp":O(e=>e-1>=0?e-1:U.length-1);break;case"ArrowDown":O(e=>e+1<U.length?e+1:0);break;case"Escape":E(null);break;case"Tab":case"Enter":{let e=q.find(e=>e.key===C),t=(null!==(u=null==e?void 0:e.options)&&void 0!==u?u:[])[M];if(t){let e=t.key;Q(e),E(null),setTimeout(()=>{let t=$.current;if(!t)return;let n="string"==typeof e?e.length:e.join("").length;t.setSelectionRange(L+n+3,L+n+3),t.focus()},1)}}}return}},onScroll:e=>{let t=e.currentTarget,n=t.scrollTop,r=t.scrollLeft;T.current&&(T.current.style.transform="translate(".concat(-r,"px, ").concat(-n,"px)")),C&&Z()},spellCheck:!1,style:{lineHeight:"1.4",width:"100%",resize:"none",overflowY:"auto",height:"100%",boxSizing:"border-box",color:J?"transparent":"inherit",caretColor:"var(--color)",fontSize:"inherit",padding:"12px",...u},...f})]})]})},k=e=>{let{value:t="",speechRecognition:n,onChange:g,onEnter:f,onKeyDown:h,readOnly:b,placeholder:y,style:x,enableShortcuts:v=!1,disabled:m=!1,footer:k=null,actionInsertMode:S="code",availableParams:j=[],allowParams:$=!1,...T}=e,A=(0,u.UW)(),C=(0,u.eL)(),E=Object.keys(C),L=Object.keys(A),R=(0,l.useMemo)(()=>{let e=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>void 0,r=[...e.matchAll(t)],l={};return r.forEach(e=>{var t;let r=e[0];l[r]=null!==(t=n(r))&&void 0!==t?t:"unknown"}),l},t=E.map(e=>{var t,n;return{key:e,label:e,description:null!==(n=null==C?void 0:null===(t=C[e])||void 0===t?void 0:t.description)&&void 0!==n?n:void 0}}),n=L.map(e=>{let t=null==A?void 0:A[e];return t&&"object"==typeof t?{key:e,label:e,children:Object.keys(t).map(e=>({key:e,label:e,rightText:typeof t[e]}))}:"number"==typeof t?{key:e,label:e,rightText:String(t)}:"string"==typeof t?{key:e,label:e,rightText:t}:{key:e,label:e}}),r=(j||[]).map(e=>({key:e,label:e})),l=[{key:"actions",label:"actions",color:"blue",prefix:"@",options:t,onInsert:e=>(0,d.M)(e),buildSymbols:t=>e(t,RegExp("await\\s+(?:\\w+\\.)?execute[_A-Za-z]*\\(\\{\\s*name\\s*:\\s*[\"'][^\"']+[\"'](?:\\s*,[\\s\\S]*?)?\\}\\)","gs"),e=>{var t;let n=e.match(/name\s*:\s*["']([^"']+)["']/);return"<@"+(null!==(t=null==n?void 0:n[1])&&void 0!==t?t:"unknown")+">"})},{key:"states",label:"states",color:"green",prefix:"#",options:n,onInsert:e=>(0,d.uS)(Array.isArray(e)?e:[e]),buildSymbols:t=>e(t,/\bboard(?:\?\.\[\s*"(?:[^"\\]|\\.)*"\s*\])+/g,e=>"<#"+[...e.matchAll(/\?\.\["([^"]+)"\]/g)].map(e=>e[1]).join(".")+">")}];return $&&l.push({key:"params",label:"params",color:"purple",prefix:"$",options:r,onInsert:e=>(0,d.oI)(Array.isArray(e)?e:[e]),buildSymbols:t=>e(t,/\bparams(?:\?\.\[\s*"(?:[^"\\]|\\.)*"\s*\])+/g,e=>"<$"+[...e.matchAll(/\?\.\["([^"]+)"\]/g)].map(e=>e[1]).join(".")+">")}),l},[E,L,j,$,C,A]),[M,O]=(0,l.useState)(!1),{transcript:z,resetTranscript:D,browserSupportsSpeechRecognition:F}=(0,c.x)();return(0,l.useEffect)(()=>{M&&z&&g({target:{value:z}})},[z,M]),(0,r.jsxs)(o.sL,{position:"relative",flex:1,gap:"$3",height:"100%",opacity:m?.7:1,backgroundColor:"$bgPanel",padding:"$2",flexDirection:"column",children:[(0,r.jsx)(w,{value:t,onChange:e=>g({target:{value:e}}),onEnter:e=>{"function"==typeof f&&f(e)},placeholder:y,readOnly:b,disabled:m,mentionTabs:R,style:x,...T}),(0,r.jsxs)(o.sL,{children:[k,!(0,p.d)()&&n&&F&&(0,r.jsx)(a.w,{label:(M?"Disable":"Enable")+" Speech Recognition",delay:{open:500,close:0},restMs:0,children:(0,r.jsx)(i.zx,{ml:"$2",size:"$3",p:"$0",onPress:()=>{M?(O(!1),c.Z.stopListening()):(D(),O(!0),c.Z.startListening({continuous:!0}))},circular:!0,backgroundColor:M?"$red6":"transparent",hoverStyle:{backgroundColor:"$gray11"},pressStyle:{backgroundColor:"$gray10"},scaleIcon:1.4,icon:s.u})})]})]})}},77843:function(e,t,n){n.d(t,{M:function(){return o},oI:function(){return a},uS:function(){return r}});let r=(e,t)=>{try{return("boards"===t?"states?.boards":"board")+e.filter(e=>e).map(e=>"?.[".concat(JSON.stringify(e),"]")).join("")}catch(t){return console.error("cannot generate state code for "+e+", ",t),""}},l=e=>{try{if(!e)return"{}";return"{ ".concat(Object.entries(e).map(e=>{let[t,n]=e;return"\n	".concat(t,": ").concat("string"==typeof n?"'".concat(n,"'"):n,", // ").concat(n)}).join("")," \n}")}catch(e){return"{}"}},o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;try{let r=l(t);if("board"===n)return'await board.execute_action({name: "'.concat(e,'", params: ').concat(r,"})");return'await executeAction({name: "'.concat(e,'", params: ').concat(r,"})")}catch(t){return console.error("cannot generate action code for "+e+", ",t),""}},a=e=>{try{return"params"+e.filter(e=>e).map(e=>"?.[".concat(JSON.stringify(e),"]")).join("")}catch(t){return console.error("cannot generate param code for "+e+", ",t),""}}}}]);