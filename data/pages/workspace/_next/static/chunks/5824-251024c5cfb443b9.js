"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5824],{95824:function(e,t,r){r.d(t,{Z:function(){return F}});var n=r(52322),o=r(7211),s=r(97909),a=r(37288),l=r(17518),i=r(75136),d=r(19653),c=r(65457),g=r(26602),u=r(47401),h=r(16399),p=r(25184),x=r(56491),m=r(28575),b=r(2784),f=r(73750),v=r(81815),y=r(41585),j=r(66788),$=r(83716),C=r(76728),w=r(62624),S=r(5632),z=r(40826);(0,p.Protofy)("protected",!0);let k=["Detect when the camera sees a person and play an alarm...","What is vento? i'm lost, explain it like i'm five","What can you see right now? Describe the camera feed in detail","Create a page that displays how many people are visible on the camera..."],A=e=>{let{children:t}=e;return(0,n.jsxs)(a.FA,{flex:1,width:"100%",height:"100%",position:"relative",overflow:"hidden",children:[(0,n.jsx)(a.FA,{position:"absolute",top:0,left:0,right:0,bottom:0,style:{background:"\n                        radial-gradient(ellipse 80% 50% at 50% 0%, rgba(99, 102, 241, 0.15), transparent),\n                        radial-gradient(ellipse 50% 50% at 20% 50%, rgba(139, 92, 246, 0.1), transparent),\n                        radial-gradient(ellipse 50% 50% at 80% 50%, rgba(59, 130, 246, 0.1), transparent)\n                    "},"$theme-dark":{style:{background:"\n                            radial-gradient(ellipse 80% 50% at 50% 0%, rgba(99, 102, 241, 0.2), transparent),\n                            radial-gradient(ellipse 50% 50% at 20% 50%, rgba(139, 92, 246, 0.15), transparent),\n                            radial-gradient(ellipse 50% 50% at 80% 50%, rgba(59, 130, 246, 0.15), transparent)\n                        "}}}),(0,n.jsx)(a.FA,{flex:1,position:"relative",zIndex:1,children:t})]})},R=e=>{let{title:t,icon:r,color:o,href:s,children:d,loading:c}=e,g=(0,S.useRouter)();return(0,n.jsxs)(a.FA,{backgroundColor:"$bgContent",borderRadius:"$6",width:270,minHeight:200,borderWidth:1,borderColor:"$borderColor",overflow:"hidden",children:[(0,n.jsxs)(a.sL,{padding:"$3",alignItems:"center",justifyContent:"space-between",borderBottomWidth:1,borderBottomColor:"$borderColor",cursor:"pointer",hoverStyle:{backgroundColor:"$backgroundHover"},onPress:()=>g.push(s),children:[(0,n.jsxs)(a.sL,{gap:"$2",alignItems:"center",children:[(0,n.jsx)(a.FA,{backgroundColor:o,borderRadius:"$2",padding:"$1.5",children:r}),(0,n.jsx)(l.x,{fontSize:14,fontWeight:"600",color:"$gray12",children:t})]}),(0,n.jsx)(w._,{size:16,color:"$gray8"})]}),(0,n.jsx)(a.FA,{flex:1,padding:"$3",children:c?(0,n.jsx)(a.FA,{flex:1,justifyContent:"center",alignItems:"center",children:(0,n.jsx)(i.$,{})}):d})]})},I=e=>{let{name:t,online:r}=e,o=(0,S.useRouter)();return(0,n.jsxs)(a.sL,{padding:"$2",alignItems:"center",gap:"$2",borderRadius:"$2",cursor:"pointer",hoverStyle:{backgroundColor:"$backgroundHover"},onPress:()=>o.push("/project?tabs=board-".concat(t,"&active=board-").concat(t)),children:[(0,n.jsx)(C.C,{size:8,fill:r?"#22c55e":"$gray8",color:r?"#22c55e":"$gray8"}),(0,n.jsx)(l.x,{fontSize:13,color:"$gray11",flex:1,children:t}),(0,n.jsx)(y.x,{size:14,color:"$gray8"})]})},W=e=>{let{name:t,hasAgent:r}=e,o=(0,S.useRouter)();return(0,n.jsxs)(a.sL,{padding:"$2",alignItems:"center",gap:"$2",borderRadius:"$2",cursor:"pointer",hoverStyle:{backgroundColor:"$backgroundHover"},onPress:()=>o.push("/project?tabs=board-".concat(t,"&active=board-").concat(t)),children:[(0,n.jsx)(v.J,{size:14,color:"$blue10"}),(0,n.jsx)(l.x,{fontSize:13,color:"$gray11",flex:1,children:t}),r&&(0,n.jsx)(l.x,{fontSize:10,color:"$green10",backgroundColor:"$green4",paddingHorizontal:"$2",borderRadius:"$1",children:"agent"})]})},P=e=>{var t;let{pageSession:r}=e,[s]=(0,m.kP)(),[x,y]=(0,b.useState)(""),[C,w]=(0,b.useState)(!1),P=(0,S.useRouter)(),[F,H]=(0,b.useState)({devices:[],boards:[],objects:[]}),[M,E]=(0,b.useState)(!0),{resolvedTheme:L}=(0,h.P)(),q="dark"===L?"dark":"light",V=(null==s?void 0:null===(t=s.user)||void 0===t?void 0:t.id)||"there",D=V.charAt(0).toUpperCase()+V.slice(1),{sendToRoom:T}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{onMessage:t,onDMSuccess:r,onDMError:n,onAgentDone:o,onRoomMessageSuccess:s,onRoomMessageError:a,filterSender:l}=e,[i,d]=(0,b.useState)([]),[c,g]=(0,b.useState)(null),[u,h]=(0,b.useState)(!1),p=(0,b.useRef)(t),x=(0,b.useRef)(r),m=(0,b.useRef)(n),f=(0,b.useRef)(o),v=(0,b.useRef)(s),y=(0,b.useRef)(a);return(0,b.useEffect)(()=>{p.current=t,x.current=r,m.current=n,f.current=o,v.current=s,y.current=a},[t,r,n,o,s,a]),(0,b.useEffect)(()=>{let e=e=>{var t,r,n,o,s,a,i;let c=e.data;if(null==c?void 0:c.type){if((null===(t=c.type)||void 0===t?void 0:t.startsWith("cinny-"))&&console.log("[useChatMessages] Received postMessage:",c.type,"sender:",c.sender),"cinny-message-sent"===c.type||"cinny-message-received"===c.type){if(l&&c.sender!==l){console.log("[useChatMessages] Filtered out message from:",c.sender,"(filter:",l,")");return}console.log("[useChatMessages] Passing message to callback:",c.type,c.sender),d(e=>[...e,c]),g(c),null===(r=p.current)||void 0===r||r.call(p,c)}"cinny-dm-sent-success"===c.type&&(h(!1),null===(n=x.current)||void 0===n||n.call(x,c)),"cinny-dm-sent-error"===c.type&&(h(!1),null===(o=m.current)||void 0===o||o.call(m,c)),"cinny-agent-done"===c.type&&(console.log("[useChatMessages] Agent done signal received"),null===(s=f.current)||void 0===s||s.call(f,c)),"cinny-room-message-success"===c.type&&(h(!1),null===(a=v.current)||void 0===a||a.call(v,c)),"cinny-room-message-error"===c.type&&(h(!1),null===(i=y.current)||void 0===i||i.call(y,c))}};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[l]),{messages:i,lastMessage:c,sendDM:(0,b.useCallback)(function(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];h(!0);let n=document.querySelector('iframe[title="Vento Chat"]');if(null==n?void 0:n.contentWindow)n.contentWindow.postMessage({type:"vento-send-dm",userId:e,message:t,navigate:r},"*");else{var o;console.warn("[useChatMessages] Cinny iframe not found"),h(!1),null===(o=m.current)||void 0===o||o.call(m,{type:"cinny-dm-sent-error",userId:e,error:"Chat iframe not found"})}},[]),sendToRoom:(0,b.useCallback)(function(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];h(!0);let n=document.querySelector('iframe[title="Vento Chat"]');if(null==n?void 0:n.contentWindow)n.contentWindow.postMessage({type:"vento-send-to-room",roomName:e,message:t,navigate:r},"*");else{var o;console.warn("[useChatMessages] Cinny iframe not found"),h(!1),null===(o=y.current)||void 0===o||o.call(y,{type:"cinny-room-message-error",roomName:e,error:"Chat iframe not found"})}},[]),clearMessages:(0,b.useCallback)(()=>{d([]),g(null)},[]),isSending:u}}({});(0,b.useEffect)(()=>{let e=e=>{let t=null==e?void 0:e.data;return t?Array.isArray(t)?t:t.items&&Array.isArray(t.items)?t.items:[]:[]};(async()=>{try{let[t,r,n]=await Promise.all([p.API.get("/api/core/v1/devices?all=1"),p.API.get("/api/core/v1/boards?all=1"),p.API.get("/api/core/v1/objects?all=1")]);H({devices:e(t),boards:e(r),objects:e(n)})}catch(e){console.error("Error fetching data:",e)}finally{E(!1)}})()},[]);let N=()=>{x.trim()&&!C&&(w(!0),T("#vento:vento.local","[Context: You are integrated into Vento and the user has written a prompt from the welcome page. It could be a question or a request to create something.]\n\n"+x,!0),y(""),P.push("/project"))};return(0,n.jsx)(o.D,{title:"Home",pageSession:r,children:(0,n.jsxs)(A,{children:[(0,n.jsx)(a.sL,{position:"absolute",top:0,left:0,right:0,height:56,paddingHorizontal:"$4",alignItems:"center",zIndex:10,children:(0,n.jsx)(a.sL,{cursor:"pointer",onPress:()=>P.push("/project"),hoverStyle:{opacity:.8},pressStyle:{opacity:.6},children:(0,n.jsx)(d.E,{style:{filter:"dark"===q?"invert(70%) brightness(10)":"invert(5%)"},src:"/public/vento-square.png",alt:"Vento",width:22,height:28,resizeMode:"contain"},q)})}),(0,n.jsx)(c.p,{flex:1,children:(0,n.jsxs)(a.FA,{flex:1,padding:"$4",minHeight:"100%",children:[(0,n.jsxs)(a.FA,{paddingTop:"15vh",paddingBottom:"$12",alignItems:"center",gap:"$4",children:[(0,n.jsxs)(l.x,{fontSize:28,fontWeight:"600",color:"$gray12",textAlign:"center",children:["What should we build, ",D,"?"]}),(0,n.jsxs)(a.sL,{backgroundColor:"$bgContent",borderRadius:"$8",padding:"$3",width:"100%",maxWidth:600,alignItems:"center",gap:"$2",shadowColor:"$shadowColor",shadowOffset:{width:0,height:4},shadowOpacity:.1,shadowRadius:20,elevation:4,children:[(0,n.jsx)(g.II,{flex:1,placeholder:"Ask Vento to create something...",value:x,onChangeText:y,borderWidth:0,outlineColor:"transparent",backgroundColor:"transparent",fontSize:15,onSubmitEditing:N}),(0,n.jsx)(u.zx,{size:"$3",circular:!0,backgroundColor:"$gray6",icon:C?(0,n.jsx)(i.$,{size:"small",color:"$color12"}):(0,n.jsx)(f.a,{size:16,color:"$color12"}),onPress:N,disabled:C})]}),(0,n.jsx)(a.FA,{gap:"$1",alignItems:"center",paddingTop:"$4",children:k.slice(0,4).map((e,t)=>(0,n.jsx)(l.x,{fontSize:12,color:"$gray9",cursor:"pointer",paddingHorizontal:"$2",paddingVertical:"$1",hoverStyle:{color:"$gray11"},pressStyle:{color:"$gray12"},onPress:()=>y(e),children:e},t))})]}),(0,n.jsxs)(a.sL,{gap:"$4",flexWrap:"wrap",justifyContent:"center",maxWidth:1200,alignSelf:"center",width:"100%",children:[(()=>{let e=F.boards.filter(e=>(0,z.s)(e,"agents"));return(0,n.jsx)(R,{title:"Agents (".concat(e.length,")"),icon:(0,n.jsx)(v.J,{size:16,color:"white"}),color:"$blue9",href:"/project",loading:M,children:(0,n.jsxs)(a.FA,{gap:"$1",children:[0===e.length?(0,n.jsx)(l.x,{fontSize:13,color:"$gray9",textAlign:"center",paddingVertical:"$4",children:"No agents yet"}):e.slice(0,5).map((e,t)=>(0,n.jsx)(W,{name:e.name,hasAgent:e.agent_input},t)),e.length>5&&(0,n.jsxs)(l.x,{fontSize:12,color:"$gray9",textAlign:"center",marginTop:"$2",children:["+",e.length-5," more"]})]})})})(),(0,n.jsx)(R,{title:"Devices (".concat(F.devices.length,")"),icon:(0,n.jsx)($.k,{size:16,color:"white"}),color:"$green9",href:"/project",loading:M,children:(0,n.jsxs)(a.FA,{gap:"$1",children:[0===F.devices.length?(0,n.jsx)(l.x,{fontSize:13,color:"$gray9",textAlign:"center",paddingVertical:"$4",children:"No devices yet"}):F.devices.slice(0,5).map((e,t)=>(0,n.jsx)(I,{name:e.name,online:e.online},t)),F.devices.length>5&&(0,n.jsxs)(l.x,{fontSize:12,color:"$gray9",textAlign:"center",marginTop:"$2",children:["+",F.devices.length-5," more"]})]})}),(0,n.jsx)(R,{title:"Storages (".concat(F.objects.length,")"),icon:(0,n.jsx)(j.x,{size:16,color:"white"}),color:"$purple9",href:"/project",loading:M,children:(0,n.jsxs)(a.FA,{gap:"$1",children:[0===F.objects.length?(0,n.jsx)(l.x,{fontSize:13,color:"$gray9",textAlign:"center",paddingVertical:"$4",children:"No storages yet"}):F.objects.slice(0,5).map((e,t)=>(0,n.jsxs)(a.sL,{padding:"$2",alignItems:"center",gap:"$2",borderRadius:"$2",cursor:"pointer",hoverStyle:{backgroundColor:"$backgroundHover"},onPress:()=>P.push("/project?tabs=board-".concat(e.name,"&active=board-").concat(e.name)),children:[(0,n.jsx)(j.x,{size:14,color:"$purple10"}),(0,n.jsx)(l.x,{fontSize:13,color:"$gray11",children:e.name})]},t)),F.objects.length>5&&(0,n.jsxs)(l.x,{fontSize:12,color:"$gray9",textAlign:"center",marginTop:"$2",children:["+",F.objects.length-5," more"]})]})})]})]})})]})})};var F={dashboard:{component:e=>{var t,r,l,i;let{pageState:d,initialItems:c,pageSession:g,extraData:u}=e,h=(0,x.c)(),p=(null==h?void 0:null===(t=h.dashboards)||void 0===t?void 0:t.length)?null==h?void 0:null===(r=h.dashboards[0])||void 0===r?void 0:r.layout:[],m=(null==h?void 0:null===(l=h.dashboards)||void 0===l?void 0:l.length)?null==h?void 0:null===(i=h.dashboards[0])||void 0===i?void 0:i.content:[];return(0,n.jsx)(o.D,{title:"Dashboard",pageSession:g,children:(0,n.jsx)(a.FA,{flex:1,padding:20,children:(0,n.jsx)(s.Zq,{items:m,layouts:p,borderRadius:10,padding:10,backgroundColor:"white"})})})}},home:{component:e=>{let{pageSession:t}=e;return(0,n.jsx)(P,{pageSession:t})}}}},97909:function(e,t,r){r.d(t,{Zq:function(){return u},w7:function(){return g}});var n=r(52322),o=r(66244),s=r(22522),a=r(70142),l=r(25184),i=r(12497);let d=(0,o.WidthProvider)(o.Responsive),c={lg:1500,md:800,sm:400,xs:0},g=(e,t)=>(t||(t=c),e>=t.lg?"lg":e>=t.md?"md":e>=t.sm?"sm":"xs"),u=e=>{let{items:t=[],layouts:r={},borderRadius:o=10,padding:g=10,settings:u={},extraScrollSpace:h=0,...p}=e,[x]=(0,i.cY)(),m=t.filter(e=>(e.layer||"base")===x),b=["n","s","e","w","ne","nw","se","sw"],f=Object.fromEntries(Object.entries(r).map(e=>{let[t,r]=e;return[t,r.map(e=>({...e,resizeHandles:b}))]}));return(0,n.jsx)(a.I,{children:(0,n.jsx)(s.Kq,{style:h?{height:"100%",overflow:"auto",flex:1,minHeight:0,paddingBottom:h,boxSizing:"border-box"}:{},children:(0,n.jsx)(d,{...p,className:"layout",layouts:f,margin:[6,6],breakpoints:c,rowHeight:30,draggableCancel:".no-drag",...u,style:{...p.style,...u.style},cols:{lg:l.gridSizes.lg.totalCols,md:l.gridSizes.md.totalCols,sm:l.gridSizes.sm.totalCols,xs:l.gridSizes.xs.totalCols},children:m.map(e=>(0,n.jsx)(s.Kq,{flex:1,children:e.content},e.key))},x)})})}}}]);