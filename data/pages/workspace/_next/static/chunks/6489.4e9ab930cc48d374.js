"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6489],{96489:function(e,l,o){o.r(l),o.d(l,{DataTableList:function(){return I},getFieldPreview:function(){return N}});var t=o(52322),n=o(37288),d=o(12397),i=o(86407),a=o(17518),r=o(50923),s=o(22522),u=o(79327),c=o(3828),v=o(70142),p=o(1963),m=o(61773),h=o(89560),y=o(3443),b=o(36265),x=o(69517),g=o(78822),f=o(25184),j=o(2784);let N=(e,l,o,r)=>(null==o?void 0:o.color)?(0,t.jsx)(g.A,{color:"$gray5",children:(0,t.jsxs)(n.sL,{ai:"center",height:20,children:[(0,t.jsx)(d.C,{size:12,backgroundColor:l[e]}),(0,t.jsx)(i.LZ,{size:5}),l[e]&&l[e].toUpperCase?l[e].toUpperCase():l[e]]})}):(null==o?void 0:o.typeName)==="ZodBoolean"?!0==l[e]?"true":!1==l[e]?"false":"":(null==o?void 0:o.typeName)==="ZodArray"?r?l[e]&&l[e].length>0&&l[e].join(", "):l[e]&&l[e].length?(0,t.jsx)(n.sL,{space:"$1",children:l[e].map((e,l)=>(0,t.jsx)(g.A,{text:e,color:"$color5"},l))}):"":(0,t.jsx)(a.x,{fos:"$3",children:l[e]}),I=e=>{var l;let{sourceUrl:o,onDelete:d=()=>{},items:i,model:a,deleteable:g=()=>{},extraMenuActions:I=[],enableAddToInitialData:Z,selected:P=[],rowIcon:w=h.z,columns:$,state:k={},setSelected:_=e=>{},onSelectItem:A=e=>{},onEditItem:C=e=>{},disableRowIcon:D=!1,disableItemSelection:S=!1}=e,{push:L,mergePush:T}=(0,b.N)(k),[F,O]=(0,j.useState)([]);(0,j.useEffect)(()=>{(async()=>{var e,l;let o=null!==(l=null==i?void 0:null===(e=i.data)||void 0===e?void 0:e.items)&&void 0!==l?l:[];O(await Promise.all(o.map(async e=>{let l={};for(let t of Object.keys(e)){let n=e[t];if("object"==typeof n&&(null==n?void 0:n.relationId))try{var o;let e=await f.API.get("/api/v1/".concat(n.model,"/").concat(n.relationId)),d=null===(o=e.data)||void 0===o?void 0:o[n.displayField];l[t]=null!=d?d:n.relationId}catch(e){l[t]=n.relationId}else l[t]=n}return l})))})()},[i]);let X=a.getObjectSchema().isDisplay("table"),z=["ZodString","ZodNumber","ZodBoolean","ZodDate"],R=null!=$?$:c.Z.columns(...Object.keys(X.shape).filter(e=>{var l,o,t,n,d;let i=null!==(t=null===(o=X.shape[e]._def)||void 0===o?void 0:null===(l=o.innerType)||void 0===l?void 0:l._def)&&void 0!==t?t:X.shape[e]._def;return(null==i?void 0:i.typeName)==="ZodArray"?z.includes(null==i?void 0:null===(d=i.type)||void 0===d?void 0:null===(n=d._def)||void 0===n?void 0:n.typeName):(null==i?void 0:i.typeName)==="ZodObject"&&null!=i&&!!i.relation||z.includes(null==i?void 0:i.typeName)}).map(e=>{var l,o,t,n,d;let i=X.shape[e]._def,a=null!==(n=null==i?void 0:null===(l=i.innerType)||void 0===l?void 0:l._def)&&void 0!==n?n:i,r=(null==a?void 0:a.typeName)==="ZodObject"&&(null==a?void 0:a.relation),s=(null==a?void 0:a.typeName)==="ZodArray"?null==a?void 0:null===(t=a.type)||void 0===t?void 0:null===(o=t._def)||void 0===o?void 0:o.typeName:null==a?void 0:a.typeName,u=r?e:(null!=i&&!!i.indexed||"ZodNumber"===s)&&e;return c.Z.column(null!==(d=null==i?void 0:i.label)&&void 0!==d?d:e,l=>N(e,l,a),u,void 0,void 0,"",{relationDisplay:r,dataType:s})}));return(0,t.jsx)(n.sL,{pt:"$1",flexWrap:"wrap",f:1,bc:"$bgPanel",br:"$6",mt:"$2",mb:"$6",overflow:"scroll",overflowX:"hidden",children:(0,t.jsx)(v.I,{children:(0,t.jsx)(c.Z.component,{disableItemSelection:S,pagination:!1,conditionalRowStyles:[{when:e=>P.some(l=>l.id===a.load(e).getId()),style:{backgroundColor:"var(--color4)"},"&:hover":{backgroundColor:"var(--color4)"}}],rowsPerPage:k.itemsPerPage?k.itemsPerPage:25,handleSort:(e,l)=>{if(null==e?void 0:e.relationDisplay){let o="asc"===l?1:-1;O([...F].sort((l,t)=>{let n=null==l?void 0:l[e.sortField],d=null==t?void 0:t[e.sortField],i="number"!=typeof n&&("string"!=typeof n||""===n.trim()||Number.isNaN(Number(n)))?null!=n?n:"":Number(n),a="number"!=typeof d&&("string"!=typeof d||""===d.trim()||Number.isNaN(Number(d)))?null!=d?d:"":Number(d);return i>a?o:i<a?-o:0}))}else T({orderBy:e.sortField,orderDirection:l})},handlePerRowsChange:e=>L("itemsPerPage",e),handlePageChange:e=>L("page",parseInt(e,10)-1),currentPage:(isNaN(parseInt(k.page,10))?0:parseInt(k.page,10))+1,totalRows:null==i?void 0:null===(l=i.data)||void 0===l?void 0:l.total,columns:[c.Z.column((0,t.jsx)(r.Q,{reset:!0,children:(0,t.jsxs)(n.sL,{children:[(0,t.jsx)(s.Kq,{mt:"$2",ml:"$3",o:.8,children:(0,t.jsx)(u.XZ,{focusStyle:{outlineWidth:0},br:"$2",checked:P.length>1,onPress:e=>{if(P.length)_([]);else{var l,o;console.log("selection all: ",null==i?void 0:null===(l=i.data)||void 0===l?void 0:l.items),_(null==i?void 0:null===(o=i.data)||void 0===o?void 0:o.items)}},children:(0,t.jsx)(u.XZ.Indicator,{children:(0,t.jsx)(p.G,{})})})}),P.length>1&&(0,t.jsx)(y.o,{enableAddToInitialData:Z,type:"bulk",mt:"1px",ml:"-5px",element:a.load(P),sourceUrl:o,deleteable:g,onDelete:d,extraMenuActions:I})]})}),()=>"",!1,e=>(0,t.jsx)(r.Q,{reset:!0,children:(0,t.jsxs)(n.sL,{ml:"$3",o:.8,children:[(0,t.jsx)(s.Kq,{mt:"$2",children:(0,t.jsx)(u.XZ,{id:"select-checkbox-".concat(a.load(e).getId()),focusStyle:{outlineWidth:0},br:"$2",onPress:()=>{let l=e=>a.load(e).getId(),o=l(e);P.some(e=>l(e)===o)?_(P.filter(e=>l(e)!==o)):_([...P,e])},checked:P.some(l=>a.load(l).getId()===a.load(e).getId()),children:(0,t.jsx)(u.XZ.Indicator,{children:(0,t.jsx)(m.J,{})})})}),(0,t.jsx)(y.o,{enableAddToInitialData:Z,type:"item",ml:"-5px",mt:"1px",element:a.load(e),sourceUrl:o+"/"+a.load(e).getId(),deleteable:g,onDelete:d,extraMenuActions:I}),!D&&(0,t.jsx)(x.z,{Icon:w,onPress:()=>C(a.load(e))})]})}),!0,"115px"),...R],rows:F,onRowPress:e=>A(a.load(e))})})})}}}]);