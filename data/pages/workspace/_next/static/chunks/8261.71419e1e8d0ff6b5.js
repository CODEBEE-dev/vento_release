"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8261],{18261:function(i,t,n){let e;n.d(t,{Z:function(){return P},x:function(){return O}});var s=n(2784);let r="undefined"!=typeof window&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),o=i=>i===r;var c=()=>/(android)/i.test("undefined"!=typeof navigator?navigator.userAgent:"");let a=(i,t,n)=>{let e;return function(){let n=arguments,s=!e;clearTimeout(e),e=setTimeout(function(){e=null},t),s&&i.apply(this,n)}},h=(...i)=>i.map(i=>i.trim()).join(" ").trim(),l=/\s*\((.*?)\)\s*/g,g=/(\(\?:[^)]+\))\?/g,u=/(\(\?)?:\w+/g,p=/\*/g,b=/[-{}[\]+?.,\\^$|#]/g,f=i=>i instanceof RegExp?RegExp(i.source,"i"):RegExp("^"+(i=i.replace(b,"\\$&").replace(l,"(?:$1)?").replace(u,(i,t)=>t?i:"([^\\s]+)").replace(p,"(.*?)").replace(g,"\\s*$1?\\s*"))+"$","i"),d=(i,t)=>{if(i=i.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!i.length&&!t.length)return 1;if(!i.length||!t.length)return 0;if(i===t)return 1;if(1===i.length&&1===t.length||i.length<2||t.length<2)return 0;let n=new Map;for(let t=0;t<i.length-1;t++){let e=i.substring(t,t+2),s=n.has(e)?n.get(e)+1:1;n.set(e,s)}let e=0;for(let i=0;i<t.length-1;i++){let s=t.substring(i,i+2),r=n.has(s)?n.get(s):0;r>0&&(n.set(s,r-1),e++)}return 2*e/(i.length+t.length-2)},w=()=>"undefined"!=typeof window&&void 0!==window.navigator&&void 0!==window.navigator.mediaDevices&&void 0!==window.navigator.mediaDevices.getUserMedia&&(void 0!==window.AudioContext||void 0!==window.webkitAudioContext);function m(i,t,n,e,s,r,o){try{var c=i[r](o),a=c.value}catch(i){n(i);return}c.done?t(a):Promise.resolve(a).then(e,s)}function R(i){return function(){var t=this,n=arguments;return new Promise(function(e,s){var r=i.apply(t,n);function o(i){m(r,e,s,o,c,"next",i)}function c(i){m(r,e,s,o,c,"throw",i)}o(void 0)})}}class T{setSpeechRecognition(i){let t=!!i&&(o(i)||w());t&&(this.disableRecognition(),this.recognition=new i,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(t)}subscribe(i,t){this.subscribers[i]=t}unsubscribe(i){delete this.subscribers[i]}emitListeningChange(i){this.listening=i,Object.keys(this.subscribers).forEach(t=>{let{onListeningChange:n}=this.subscribers[t];n(i)})}emitMicrophoneAvailabilityChange(i){this.isMicrophoneAvailable=i,Object.keys(this.subscribers).forEach(t=>{let{onMicrophoneAvailabilityChange:n}=this.subscribers[t];n(i)})}emitTranscriptChange(i,t){Object.keys(this.subscribers).forEach(n=>{let{onTranscriptChange:e}=this.subscribers[n];e(i,t)})}emitClearTranscript(){Object.keys(this.subscribers).forEach(i=>{let{onClearTranscript:t}=this.subscribers[i];t()})}emitBrowserSupportsSpeechRecognitionChange(i){Object.keys(this.subscribers).forEach(t=>{let{onBrowserSupportsSpeechRecognitionChange:n,onBrowserSupportsContinuousListeningChange:e}=this.subscribers[t];n(i),e(i)})}disconnect(i){if(this.recognition&&this.listening)switch(i){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;default:this.pauseAfterDisconnect=!0,this.stop()}}disableRecognition(){this.recognition&&(this.recognition.onresult=()=>{},this.recognition.onend=()=>{},this.recognition.onerror=()=>{},this.listening&&this.stopListening())}onError(i){i&&i.error&&"not-allowed"===i.error&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}onRecognitionDisconnect(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}updateTranscript({results:i,resultIndex:t}){let n=void 0===t?i.length-1:t;this.interimTranscript="",this.finalTranscript="";for(let t=n;t<i.length;++t)i[t].isFinal&&(!c()||i[t][0].confidence>0)?this.updateFinalTranscript(i[t][0].transcript):this.interimTranscript=h(this.interimTranscript,i[t][0].transcript);let e=!1;""===this.interimTranscript&&""!==this.finalTranscript?(this.previousResultWasFinalOnly&&(e=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,e||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}updateFinalTranscript(i){this.finalTranscript=h(this.finalTranscript,i)}resetTranscript(){this.disconnect("RESET")}startListening({continuous:i=!1,language:t}={}){var n=this;return R(function*(){if(!n.recognition)return;let e=i!==n.recognition.continuous,s=t&&t!==n.recognition.lang;if((e||s)&&(n.listening&&(yield n.stopListening()),n.recognition.continuous=e?i:n.recognition.continuous,n.recognition.lang=s?t:n.recognition.lang),!n.listening){n.recognition.continuous||(n.resetTranscript(),n.emitClearTranscript());try{yield n.start(),n.emitListeningChange(!0)}catch(i){i instanceof DOMException||n.emitMicrophoneAvailabilityChange(!1)}}})()}abortListening(){var i=this;return R(function*(){i.disconnect("ABORT"),i.emitListeningChange(!1),yield new Promise(t=>{i.onStopListening=t})})()}stopListening(){var i=this;return R(function*(){i.disconnect("STOP"),i.emitListeningChange(!1),yield new Promise(t=>{i.onStopListening=t})})()}getRecognition(){return this.recognition}start(){var i=this;return R(function*(){i.recognition&&!i.listening&&(yield i.recognition.start(),i.listening=!0)})()}stop(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}abort(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}constructor(i){this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=()=>{},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(i),c()&&(this.updateFinalTranscript=a(this.updateFinalTranscript,250))}}let y="CLEAR_TRANSCRIPT",v="APPEND_TRANSCRIPT",S=()=>({type:y}),C=(i,t)=>({type:v,payload:{interimTranscript:i,finalTranscript:t}}),L=(i,t)=>{switch(t.type){case y:return{interimTranscript:"",finalTranscript:""};case v:return{interimTranscript:t.payload.interimTranscript,finalTranscript:h(i.finalTranscript,t.payload.finalTranscript)};default:throw Error()}};function A(i,t,n,e,s,r,o){try{var c=i[r](o),a=c.value}catch(i){n(i);return}c.done?t(a):Promise.resolve(a).then(e,s)}function E(i){return function(){var t=this,n=arguments;return new Promise(function(e,s){var r=i.apply(t,n);function o(i){A(r,e,s,o,c,"next",i)}function c(i){A(r,e,s,o,c,"throw",i)}o(void 0)})}}let M=!!r,k=M&&!c(),O=({transcribing:i=!0,clearTranscriptOnListen:t=!0,commands:n=[]}={})=>{let[e]=(0,s.useState)(P.getRecognitionManager()),[r,o]=(0,s.useState)(M),[c,a]=(0,s.useState)(k),[{interimTranscript:l,finalTranscript:g},u]=(0,s.useReducer)(L,{interimTranscript:e.interimTranscript,finalTranscript:""}),[p,b]=(0,s.useState)(e.listening),[w,m]=(0,s.useState)(e.isMicrophoneAvailable),R=(0,s.useRef)(n);R.current=n;let T=()=>{u(S())},y=(0,s.useCallback)(()=>{e.resetTranscript(),T()},[e]),v=(i,t,n)=>{let e=("object"==typeof i?i.toString():i).replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),s=d(e,t);return s>=n?{command:i,commandWithoutSpecials:e,howSimilar:s,isFuzzyMatch:!0}:null},A=(i,t)=>{let n=f(i).exec(t);return n?{command:i,parameters:n.slice(1)}:null},E=(0,s.useCallback)((i,t)=>{R.current.forEach(({command:n,callback:e,matchInterim:s=!1,isFuzzyMatch:r=!1,fuzzyMatchingThreshold:o=.8,bestMatchOnly:c=!1})=>{let a=!t&&s?i.trim():t.trim(),h=(Array.isArray(n)?n:[n]).map(i=>r?v(i,a,o):A(i,a)).filter(i=>i);if(r&&c&&h.length>=2){h.sort((i,t)=>t.howSimilar-i.howSimilar);let{command:i,commandWithoutSpecials:t,howSimilar:n}=h[0];e(t,a,n,{command:i,resetTranscript:y})}else h.forEach(i=>{if(i.isFuzzyMatch){let{command:t,commandWithoutSpecials:n,howSimilar:s}=i;e(n,a,s,{command:t,resetTranscript:y})}else{let{command:t,parameters:n}=i;e(...n,{command:t,resetTranscript:y})}})})},[y]),O=(0,s.useCallback)((t,n)=>{i&&u(C(t,n)),E(t,n)},[E,i]),D=(0,s.useCallback)(()=>{t&&T()},[t]);return(0,s.useEffect)(()=>{let i=P.counter;return P.counter+=1,e.subscribe(i,{onListeningChange:b,onMicrophoneAvailabilityChange:m,onTranscriptChange:O,onClearTranscript:D,onBrowserSupportsSpeechRecognitionChange:o,onBrowserSupportsContinuousListeningChange:a}),()=>{e.unsubscribe(i)}},[i,t,e,O,D]),{transcript:h(g,l),interimTranscript:l,finalTranscript:g,listening:p,isMicrophoneAvailable:w,resetTranscript:y,browserSupportsSpeechRecognition:r,browserSupportsContinuousListening:c}},P={counter:0,applyPolyfill:i=>{e?e.setSpeechRecognition(i):e=new T(i);let t=!!i&&w();M=t,k=t},removePolyfill:()=>{e?e.setSpeechRecognition(r):e=new T(r),k=(M=!!r)&&!c()},getRecognitionManager:()=>(e||(e=new T(r)),e),getRecognition:()=>P.getRecognitionManager().getRecognition(),startListening:E(function*({continuous:i,language:t}={}){let n=P.getRecognitionManager();yield n.startListening({continuous:i,language:t})}),stopListening:E(function*(){let i=P.getRecognitionManager();yield i.stopListening()}),abortListening:E(function*(){let i=P.getRecognitionManager();yield i.abortListening()}),browserSupportsSpeechRecognition:()=>M,browserSupportsContinuousListening:()=>k}}}]);