(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9344],{64386:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth/login",function(){return r(64565)}])},64565:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return W}});var t=r(52322),s=r(2784),i=r(37288),l=r(78994),a=r(26602),c=r(47401),o=r(75136),d=r(25184),u=r(55493),f=r(39097),h=r.n(f),x=r(70952),j=r(27704),p=r(74433),g=r(21498),b=r(28575);let v=async(e,n,r)=>d.API.post("/api/core/v1/auth/login",{username:e,password:n},r);var m=r(43850),w=r(96082),$=r(88480),y=r(24551),E=r(1627),P=r(31933),S=r(62858),k=r(50666),A=r(752),F=r(65058),_=r(82814),C=r(34229);let I=(0,F.cn)(!1),N=(0,F.cn)(null,async(e,n)=>{e(I)||(await (0,_.bP)(async e=>{await (0,C.S)(e)}),n(I,!0))});var R=r(16399);function T(){let e=(0,A.b9)(N),{resolvedTheme:n}=(0,R.P)(),r="dark"===n,[l,a]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{a(!0),r&&e()},[e,r]),(0,t.jsx)(S.T,{children:(0,t.jsx)(u.H,{header:null,title:"Protofy",description:"Made with love from Barcelona",footer:null,children:(0,t.jsx)(i.FA,{f:1,overflow:"hidden",children:(0,t.jsxs)(y.$,{containerProps:{f:1},sectionProps:{index:0,p:0},children:[(0,t.jsx)(E.P,{t:"20vh"}),(0,t.jsx)(m.M,{children:(0,t.jsx)(P.Q,{br:"$8",children:(0,t.jsx)(w.g,{children:(0,t.jsx)(L,{darkMode:r,isClient:l})})})})]})})})})}function L(e){let{darkMode:n,isClient:r}=e,[u,f]=(0,s.useState)(""),[m,w]=(0,s.useState)(""),y=(0,s.useRef)(null),[E,P]=(0,s.useState)((0,d.getPendingResult)("pending")),[S,A]=(0,b.kP)(),[F,_]=(0,b.Tt)(),[C,I]=(0,s.useState)(null);(0,x.t)();let N=Object.fromEntries((0,j.l)().entries());(0,s.useEffect)(()=>{var e;null===(e=y.current)||void 0===e||e.focus()},[]),(0,s.useEffect)(()=>{E.isLoaded&&E.data&&(A((0,d.createSession)(E.data.session.user,E.data.session.token)),_(E.data.context))},[E]),function(e){let[n,r]=(0,b.kP)();(0,s.useEffect)(()=>{n.loggedIn&&e&&e(n)},[n])}(()=>{document.location.href=N.return||"/"});let R=async e=>{e.preventDefault(),v(u,m,P)};return(0,s.useEffect)(()=>{let e=!1;return(async()=>{try{let n=await fetch("/api/core/v1/users/has",{credentials:"include"});if(!n.ok)throw Error("users/has failed");let r=await n.json();e||I(!!(null==r?void 0:r.hasUsers))}catch(n){e||I(!0)}})(),()=>{e=!0}},[]),(0,t.jsxs)(i.FA,{ai:"center",jc:"center",p:"$2",children:[(0,t.jsxs)(i.FA,{miw:300,maw:320,jc:"space-between",p:"$2",gap:"$4",children:[(0,t.jsx)(i.FA,{mb:"$4",children:(0,t.jsx)(k.K,{children:(0,t.jsx)("img",{src:"/public/vento-logo.png",alt:"Vento logo",style:{marginTop:"2.5rem",width:"120px",filter:r?n?"invert(1)":"invert(0)":"none"}})})}),!1===C&&(0,t.jsx)($.q,{children:g.l.signupEnabled?(0,t.jsxs)(i.FA,{space:"$2",children:[(0,t.jsxs)(l.n,{children:["No users have been created yet.",(0,t.jsx)("br",{}),(0,t.jsx)("br",{})]}),(0,t.jsxs)(l.n,{children:["Please"," ",(0,t.jsx)(h(),{id:"first-user-register-link",href:"/auth/register".concat(N.return?"?return=".concat(N.return):""),style:{fontWeight:800},children:"register the first account"}),"."]})]}):(0,t.jsxs)(i.FA,{space:"$2",children:[(0,t.jsxs)(l.n,{children:["No users have been created yet!",(0,t.jsx)("br",{}),(0,t.jsx)("br",{})]}),(0,t.jsxs)(l.n,{children:["Create the first user from ",(0,t.jsx)("strong",{children:"Config â†’ Users"})," and press ",(0,t.jsx)("strong",{children:"(+)"}),", or run:",(0,t.jsx)("br",{})]}),(0,t.jsxs)(l.n,{children:[(0,t.jsx)("code",{children:"yarn add-user <email> <password> <type>"}),(0,t.jsx)("br",{}),(0,t.jsx)("br",{})]})]})}),!!E.isError&&(0,t.jsx)($.q,{children:(0,t.jsx)(l.n,{children:(0,p.e)(E.error)})}),(0,t.jsx)("form",{onSubmit:R,children:(0,t.jsxs)(i.FA,{space:"$2",mt:"$5",children:[(0,t.jsx)(a.II,{id:"sign-in-username-input",ref:y,autoComplete:"username",placeholder:"Username",value:u,onChange:e=>f(e.nativeEvent.text),required:!0}),(0,t.jsx)(a.II,{id:"sign-in-password-input",autoComplete:"password",secureTextEntry:!0,placeholder:"Password",value:m,onChange:e=>w(e.nativeEvent.text),required:!0}),(0,t.jsx)(c.zx,{id:"sign-in-btn",type:"submit",loading:E.isLoading,disabled:!u||!m||E.isLoading,mt:"$5",children:S.loggedIn||E.isLoading?(0,t.jsx)(o.$,{}):"Sign in"})]})}),g.l.signupEnabled&&(0,t.jsx)(i.FA,{space:"$2",children:(0,t.jsxs)(l.n,{theme:"alt2",ta:"center",size:"$2",children:["Don't have an account?"," ",(0,t.jsx)(h(),{id:"sign-up-link",href:"/auth/register".concat(N.return?"?return=".concat(N.return):""),style:{fontWeight:"800"},children:"Sign up."})]})})]}),(0,t.jsx)("style",{children:"\n        @keyframes float {\n          0%, 100% { transform: translateY(0); }\n          50% { transform: translateY(-8px); }\n        }\n      "})]})}var q=r(97729),z=r.n(q);function W(e){let n=g.l.projectName;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(z(),{children:(0,t.jsx)("title",{children:n+" - Sign In"})}),(0,t.jsx)(T,{...e})]})}},31933:function(e,n,r){"use strict";r.d(n,{Q:function(){return i}});var t=r(52322),s=r(37288);let i=r(2784).forwardRef((e,n)=>{var r;return(0,t.jsxs)(s.FA,{ref:n,pos:"relative",elevation:"$4",py:"$4",pt:"$6",pb:"$10",zIndex:1,br:null!==(r=e.br)&&void 0!==r?r:void 0,...e,children:[(0,t.jsx)(s.FA,{fullscreen:!0,bc:"$color3",zi:-1,o:.25,btw:1,btc:"$borderColor",br:e.br}),e.children]})});n.Z=i},96082:function(e,n,r){"use strict";r.d(n,{g:function(){return a}});var t=r(52322),s=r(2784),i=r(35827),l=r(37288);let a=s.forwardRef((e,n)=>(0,t.jsx)(i._k,{ref:n,children:(0,t.jsx)(l.sL,{flex:1,overflow:"hidden",maxWidth:"100%",space:"$8",flexWrap:"nowrap",px:"$2",mb:-8,$sm:{flexDirection:"column"},$gtSm:{px:"$6"},...e,children:e.children})}));n.Z=a},50666:function(e,n,r){"use strict";r.d(n,{K:function(){return l}});var t=r(52322),s=r(2784),i=r(37288);let l=s.forwardRef((e,n)=>{let{children:r,...s}=e;return(0,t.jsx)(i.FA,{ref:n,tag:"span",className:"unselectable",alignSelf:"center",marginVertical:-10,pressStyle:{opacity:1,scale:.95},hoverStyle:{opacity:.8},...s,children:r})})},24551:function(e,n,r){"use strict";r.d(n,{$:function(){return a}});var t=r(52322),s=r(2784),i=r(37288),l=r(70142);let a=s.forwardRef((e,n)=>(0,t.jsx)(i.FA,{ref:n,flex:1,...e,children:(0,t.jsx)(l.I,{children:e.children})}));n.Z=a},1627:function(e,n,r){"use strict";r.d(n,{P:function(){return l}});var t=r(52322),s=r(2784),i=r(37288);let l=s.forwardRef((e,n)=>(0,t.jsx)(i.FA,{ref:n,o:.75,pos:"absolute",t:0,l:0,r:0,h:2e3,className:"hero-blur",...e}));n.Z=l}},function(e){e.O(0,[2834,2888,9774,179],function(){return e(e.s=64386)}),_N_E=e.O()}]);