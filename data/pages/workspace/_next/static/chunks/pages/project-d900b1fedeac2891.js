(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8512],{46174:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project",function(){return r(64391)}])},64391:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return q}});var o=r(52322),n=r(2784),s=r(97729),i=r.n(s),c=r(5632),l=r(25237),a=r.n(l),d=r(21498),u=r(37288),h=r(17518),p=r(19653),b=r(94291),g=r(47401),m=r(75136),f=r(57441),x=r(15810),v=r(78905),y=r(4852),j=r(40966),w=r(12778),$=r(73147),k=r(70142),S=r(16399),C=r(67045),L=r(37946),E=r(59149),z=r(39635),I=r(5486),P=r(65606),W=r(5333),T=r(79564);let _=a()(()=>r.e(9568).then(r.bind(r,59568)).then(e=>e.SettingsConnector),{loadableGenerated:{webpack:()=>[59568]},ssr:!1}),M="network",N="settings",R=e=>{let{tab:t,isActive:r,onSelect:s,onClose:i}=e,[c,l]=(0,n.useState)(!1);return(0,o.jsx)(k.I,{children:(0,o.jsxs)(u.sL,{ai:"center",gap:"$2",px:"$2",height:32,cursor:"pointer",br:"$3",bc:r?"var(--color2)":"var(--bgContent)",bw:2,boc:r?"var(--color7)":"transparent",pressStyle:{bg:"$color4"},onPress:s,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[(0,o.jsx)(h.x,{fontSize:"$2",color:"$color12",opacity:c?.85:1,fontWeight:r?"500":"400",children:t.name}),(0,o.jsx)(u.sL,{pos:"absolute",right:4,ai:"center",jc:"center",width:18,height:18,br:"$10",ml:"$1",opacity:c?1:0,bg:"$bgPanel",onPress:i,children:(0,o.jsx)(f.X,{size:14,color:c?"$color12":"transparent"})})]})})},A={assets:"/workspace/assets",tasks:"/workspace/tasks",devices:"/workspace/devices",storages:"/workspace/objects",files:"/workspace/files?path=/",users:"/workspace/users",keys:"/workspace/keys",events:"/workspace/events",databases:"/workspace/databases",settings:"/workspace/settings",themes:"/workspace/themes"},F=e=>{if(e===N)return{id:N,name:"Config",type:"settings"};let t=e.match(/^(board|settings)-(.+)$/);if(t){let[,r,o]=t,n="settings"===r?A[o]:void 0;return{id:e,name:o,type:r,url:n}}return null};function q(){let e=(0,c.useRouter)(),t=d.l.projectName,[r,s]=(0,n.useState)([]),[l,a]=(0,n.useState)(M),[h,f]=(0,n.useState)(!1),{resolvedTheme:A}=(0,S.P)(),q="dark"===A?"dark":"light",{tint:O}=(0,C.d5)(),X=(0,n.useRef)(q),J=(0,n.useRef)(O),[B,Q]=(0,n.useState)(!1),V=(0,n.useRef)(null);!function(){let{onMessage:e}=(0,T.Z)("notifications/event/create/ui/commands/#");(0,n.useEffect)(()=>e(e=>{try{let t="string"==typeof e.message?JSON.parse(e.message):e.message,r=null==t?void 0:t.payload;if(!r)return;let o=e.topic.match(/ui\/commands\/([^/]+)/),n=null==o?void 0:o[1];"open-tab"===n&&r.name&&(0,W.Al)({type:"open-tab",name:r.name,tabType:r.tabType||"board"})}catch(e){console.error("[useUICommands] Error processing message:",e)}}),[e])}(),(0,W.m9)((0,n.useCallback)(e=>{if("open-tab"===e.type&&e.name){let t=e.tabType||"board",o="".concat(t,"-").concat(e.name.toLowerCase().replace(/\s+/g,"-"));if(r.find(e=>e.id===o))a(o);else{let r={id:o,name:e.name,type:t,url:"board"===t?void 0:e.url};s(e=>[...e,r]),a(o)}}else if("close-tab"===e.type&&e.name){let t=e.tabType||"board",o="".concat(t,"-").concat(e.name.toLowerCase().replace(/\s+/g,"-"));if(r.find(e=>e.id===o)){let e=r.findIndex(e=>e.id===o),t=r.filter(e=>e.id!==o);et(e=>{let t=new Set(e);return t.delete(o),t}),s(t),a(r=>{if(r===o){if(t.length>0){var n;let r=Math.min(e,t.length-1);return(null===(n=t[r])||void 0===n?void 0:n.id)||M}return M}return r})}}else"cinny-ready"===e.type?Q(!0):"cinny-collapse-chat"===e.type?D(!1):"theme-changed"===e.type&&window.location.reload()},[r])),(0,n.useEffect)(()=>{if(!e.isReady||h)return;let{tabs:t,active:r}=e.query,o=[];if(t&&s(o=("string"==typeof t?t:t[0]).split(",").filter(Boolean).map(F).filter(e=>null!==e)),r){let e="string"==typeof r?r:r[0];(e===M||o.some(t=>t.id===e))&&a(e)}f(!0)},[e.isReady,e.query,h]),(0,n.useEffect)(()=>{if(!h)return;let t=r.map(e=>e.id).join(","),o={};t&&(o.tabs=t),l!==M&&(o.active=l);let n={...e.query};delete n.tabs,delete n.active;let s={...n,...o};JSON.stringify(e.query)!==JSON.stringify(s)&&e.replace({pathname:e.pathname,query:s},void 0,{shallow:!0})},[r,l,h]);let[Z,D]=(0,n.useState)(!0),[G,K]=(0,n.useState)(()=>{{let e=localStorage.getItem("vento-tabs-chat-width");return e?parseInt(e):380}}),U=(0,n.useRef)(G),[Y,H]=(0,n.useState)(!1),[ee,et]=(0,n.useState)(new Set),er=(0,n.useCallback)(e=>{et(t=>new Set(t).add(e))},[]),eo=(0,n.useMemo)(()=>r.map(e=>{let t;return t=e.id===N?"/workspace/config":e.url?e.url:"/workspace/boards/view?board=".concat(e.name),{tabId:e.id,url:t,name:e.name}}),[r]);(0,n.useEffect)(()=>{U.current=G},[G]),(0,n.useEffect)(()=>{let e=setTimeout(()=>{localStorage.setItem("vento-tabs-chat-width",String(G))},100);return()=>clearTimeout(e)},[G]),(0,n.useEffect)(()=>{var e;B&&(null===(e=V.current)||void 0===e?void 0:e.contentWindow)&&V.current.contentWindow.postMessage({type:"vento-theme-change",theme:q},"*")},[q,B]),(0,n.useEffect)(()=>{var e;B&&(null===(e=V.current)||void 0===e?void 0:e.contentWindow)&&V.current.contentWindow.postMessage({type:"vento-accent-change",accent:O},"*")},[O,B]);let en=(0,n.useCallback)(e=>{e.preventDefault();let t=e.clientX,r=U.current;H(!0),document.body.style.cursor="col-resize",document.body.style.userSelect="none";let o=e=>{K(Math.max(250,r+(e.clientX-t))),window.dispatchEvent(new Event("resize"))},n=()=>{H(!1),document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",n)};document.addEventListener("mousemove",o),document.addEventListener("mouseup",n)},[]),es=(0,n.useCallback)((e,t)=>{t.stopPropagation(),et(t=>{let r=new Set(t);return r.delete(e),r}),s(t=>{let r=t.filter(t=>t.id!==e);if(l===e){let n=t.findIndex(t=>t.id===e);if(r.length>0){var o;let e=Math.min(n,r.length-1);a((null===(o=r[e])||void 0===o?void 0:o.id)||M)}else a(M)}return r})},[l]);(0,n.useMemo)(()=>r.find(e=>e.id===l),[r,l]);let ei=l===M,ec=(0,n.useCallback)(()=>{if(r.find(e=>e.id===N)){a(N);return}let e={id:N,name:"Config",type:"settings"};s(t=>[...t,e]),a(N)},[r]);return(0,o.jsx)(W.Y0,{children:(0,o.jsxs)(_,{children:[(0,o.jsx)(i(),{children:(0,o.jsxs)("title",{children:[t," - Workspace Tabs"]})}),Y&&(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:99999,cursor:"col-resize"}}),(0,o.jsxs)(u.sL,{height:44,borderBottomWidth:1,borderBottomColor:"$borderColor",children:[(0,o.jsxs)(u.sL,{width:Z?G:44,ai:"center",jc:Z?"space-between":"center",px:"$2",bc:"$bgPanel",borderRightWidth:1,borderRightColor:"$borderColor",flexShrink:0,children:[(0,o.jsx)(u.FA,{children:Z&&A&&(0,o.jsx)(p.E,{style:{filter:"dark"===q?"invert(70%) brightness(10)":"invert(5%)"},src:"/public/vento-square.png",alt:"Vento",width:22,height:28,resizeMode:"contain"},q)}),(0,o.jsx)(k.I,{children:(0,o.jsx)(u.sL,{width:32,height:32,ai:"center",jc:"center",cursor:"pointer",br:"$2",hoverStyle:{bg:"$color3"},pressStyle:{bg:"$color4"},onPress:()=>D(!Z),children:Z?(0,o.jsx)(v.T,{size:20,color:"$color11"}):(0,o.jsx)(y.a,{size:20,color:"$color11"})})})]}),(0,o.jsxs)(u.sL,{f:1,ai:"center",px:"$2",gap:"$2",pl:"$4",bc:"$bgPanel",children:[(0,o.jsx)(k.I,{children:(0,o.jsx)(u.sL,{width:32,height:32,ai:"center",jc:"center",cursor:"pointer",br:"$2",bc:ei?"var(--color2)":"var(--bgContent)",boc:"var(--color7)",bw:ei?2:0,hoverStyle:{bg:"$color3"},pressStyle:{bg:"$color4"},onPress:()=>a(M),children:(0,o.jsx)(x.Z,{size:18,color:"$color12"})})}),(0,o.jsx)(u.sL,{ai:"center",gap:"$2",f:1,children:r.map(e=>(0,o.jsx)(R,{tab:e,isActive:l===e.id,onSelect:()=>a(e.id),onClose:t=>es(e.id,t)},e.id))}),(0,o.jsxs)(u.sL,{ai:"center",gap:"$1",children:[(0,o.jsx)(b.w,{label:"Configuration",placement:"bottom",children:(0,o.jsx)(u.sL,{p:"$2",cursor:"pointer",br:"$3",hoverStyle:{bg:"$color3"},pressStyle:{bg:"$color4"},onPress:ec,children:(0,o.jsx)(j.Z,{size:20,color:"$color11",strokeWidth:1.5})})}),(0,o.jsx)(L.J,{menuPlacement:"bottom",trigger:(0,o.jsx)(u.sL,{p:"$2",cursor:"pointer",br:"$3",hoverStyle:{bg:"$color3"},pressStyle:{bg:"$color4"},children:(0,o.jsx)(w.n,{size:20,color:"$color11",strokeWidth:1.5})}),children:(0,o.jsxs)(u.sL,{p:"$2",gap:"$1",ai:"center",children:[(0,o.jsx)(E.T,{borderWidth:0,chromeless:!0}),(0,o.jsx)(z.L,{borderWidth:0,chromeless:!0}),!(0,P.d)()&&(0,o.jsx)(I.K,{borderWidth:0,chromeless:!0}),(0,P.d)()&&(0,o.jsx)(b.w,{label:"Open in browser",placement:"bottom",children:(0,o.jsx)(g.zx,{size:"$3",chromeless:!0,onPress:()=>{var e;return null===(e=window.electronAPI)||void 0===e?void 0:e.openExternal("http://localhost:8000")},icon:$.T,scaleIcon:1.3,color:"$gray9"})})]})})]})]})]}),(0,o.jsx)(u.FA,{f:1,height:"calc(100vh - ".concat(44,"px)"),bc:"$bgPanel",children:(0,o.jsxs)(u.sL,{f:1,bc:"$bgPanel",children:[A&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.FA,{width:G,bg:"$bgPanel",flexShrink:0,display:Z?"flex":"none",children:(0,o.jsx)(W.Qx,{innerRef:V,src:"/chat/home/?theme=".concat(X.current,"&accent=").concat(J.current),onLoad:()=>Q(!0),style:{width:"100%",height:"100%",border:"none"},title:"Vento Chat"})}),Z&&(0,o.jsx)("div",{onMouseDown:en,style:{width:8,cursor:"col-resize",backgroundColor:"transparent",flexShrink:0,marginLeft:-4}})]}),(0,o.jsxs)(u.FA,{f:1,position:"relative",br:"$4",m:"$1",ml:Z?0:void 0,overflow:"hidden",bc:"$bgContent",children:[(0,o.jsxs)(o.Fragment,{children:[ei&&!ee.has(M)&&(0,o.jsx)(u.FA,{position:"absolute",top:0,left:0,right:0,bottom:0,ai:"center",jc:"center",zIndex:2,bc:"$bgContent",children:(0,o.jsx)(k.I,{children:(0,o.jsx)(m.$,{size:"large",color:"$color9"})})}),(0,o.jsx)(W.Qx,{src:"/workspace/network",onLoad:()=>er(M),style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",border:"none",zIndex:ei?1:0,pointerEvents:ei?"auto":"none",opacity:ee.has(M)?1:0},title:"Network View"})]}),eo.map(e=>{let{tabId:t,url:r,name:s}=e,i=l===t,c=ee.has(t);return(0,o.jsxs)(n.Fragment,{children:[i&&!c&&(0,o.jsx)(u.FA,{position:"absolute",top:0,left:0,right:0,bottom:0,ai:"center",jc:"center",zIndex:2,bc:"$bgContent",children:(0,o.jsx)(k.I,{children:(0,o.jsx)(m.$,{size:"large",color:"$color9"})})}),(0,o.jsx)(W.Qx,{src:r,onLoad:()=>er(t),style:{position:"absolute",top:4,left:4,width:"calc(100% - 8px)",height:"calc(100% - 8px)",border:"none",display:"block",zIndex:i&&!ei?1:0,pointerEvents:i&&!ei?"auto":"none",opacity:c?1:0},title:s})]},t)})]})]})})]})})}}},function(e){e.O(0,[2888,9774,179],function(){return e(e.s=46174)}),_N_E=e.O()}]);