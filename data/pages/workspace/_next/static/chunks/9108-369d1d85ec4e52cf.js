"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9108],{60417:function(e,t,r){r.d(t,{w:function(){return s}});var n=r(52322),o=r(37288),l=r(17518),a=r(70142),i=r(49852);let s=e=>{var t,r;let{template:s,isSelected:c,onPress:d}=e;return(0,n.jsx)(a.I,{children:(0,n.jsxs)(o.FA,{id:"template-card-"+s.id,onPress:d,height:"180px",width:"357px",overflow:"hidden",borderWidth:c?"$1":"$0.5",borderColor:c?"$color7":"$gray8",backgroundColor:c?"$color3":"",cursor:"pointer",borderRadius:"$3",justifyContent:"center",alignItems:"center",padding:"$4",children:[(0,n.jsx)(i.p,{size:35,color:"var(--color8)",name:null!==(t=s.icon)&&void 0!==t?t:"layout-dashboard"}),(0,n.jsx)(l.x,{ta:"center",marginBottom:"$2",marginTop:"$4",children:null!==(r=s.name)&&void 0!==r?r:s.id}),(0,n.jsx)(l.x,{ta:"center",fontWeight:"300",opacity:.4,children:s.description})]})})}},42589:function(e,t,r){r.d(t,{_m:function(){return a}});var n=r(25184);(0,n.Protofy)("features",{adminPage:"/boards"});let o=n.Schema.object({name:n.z.string().id(),label:n.z.string().optional(),type:n.z.string(),settings:n.z.any().optional(),description:n.z.string().optional(),rules:n.z.array(n.z.string()).optional(),params:n.z.record(n.z.string(),n.z.any()).optional(),content:n.z.string().optional(),stateMode:n.z.enum(["default","ephemeral","non-ephemeral"]).optional(),chainTerminator:n.z.boolean().optional()});n.AutoModel.createDerived("CardModel",o);let l=n.Schema.object((0,n.Protofy)("schema",{name:n.z.string().hint("room, system, controller, ...").regex(/^[a-z0-9_]+$/,"Only lower case chars, numbers or _").static().id(),layouts:n.z.any().optional().hidden(),cards:n.z.array(o).optional().hidden(),rules:n.z.array(n.z.string()).optional().hidden(),userPermissions:n.z.enum(["r","rw"]).optional(),ephemeral:n.z.boolean().optional()}));(0,n.Protofy)("api",{name:"boards",prefix:"/api/core/v1/"});let a=n.AutoModel.createDerived("BoardModel",l)},75434:function(e,t,r){r.d(t,{m:function(){return b}});var n=r(52322),o=r(37288),l=r(17518),a=r(47401),i=r(26602),s=r(93075),c=r(75136),d=r(70142),u=r(2784),p=r(57441),h=r(68604),g=r(25184),x=r(3471),v=r(86184),f=r(67662),m=r(19025);let b=e=>{var t,r,b,y,j,$,w,C,S,k,A,P,I,z,L,R,F,T;let{board:E,onSave:_,readOnly:W=!1}=e,[O,D]=(0,u.useState)(null!==(w=null!==($=E.displayName)&&void 0!==$?$:E.name)&&void 0!==w?w:""),[M,N]=(0,u.useState)(null!==(C=E.icon)&&void 0!==C?C:"layout-dashboard"),[V,H]=(0,u.useState)((null===(t=E.visibility)||void 0===t?void 0:t.length)===0),[B,G]=(0,u.useState)(null!==(S=E.tags)&&void 0!==S?S:[]),[U,q]=(0,u.useState)(""),[J,Z]=(0,u.useState)([]),[K,Y]=(0,u.useState)(null!==(k=E.settings)&&void 0!==k?k:{}),[X,Q]=(0,u.useState)(null!==(A=E.users)&&void 0!==A?A:[]),[ee,et]=(0,u.useState)([]),[er,en]=(0,u.useState)(!0),[eo,el]=(0,u.useState)(!1),ea=e=>{G(t=>t.filter(t=>t!==e))};(0,u.useEffect)(()=>{let e=!1;return(async()=>{try{var t,r;let n=await g.API.get("/api/core/v1/icons"),o=null!==(r=null==n?void 0:null===(t=n.data)||void 0===t?void 0:t.icons)&&void 0!==r?r:[];e||Z(o)}catch(t){e||Z([])}})(),()=>{e=!0}},[]),(0,u.useEffect)(()=>{let e=!1;return(async()=>{en(!0);try{var t,r,n;let o=await g.API.get("/api/core/v1/groups"),l=null!==(n=null!==(r=null==o?void 0:null===(t=o.data)||void 0===t?void 0:t.items)&&void 0!==r?r:null==o?void 0:o.data)&&void 0!==n?n:[],a=Array.isArray(l)?l.map(e=>{var t;return null!==(t=null==e?void 0:e.name)&&void 0!==t?t:e}).filter(Boolean):[];e||et(a)}catch(t){e||et([])}finally{e||en(!1)}})(),()=>{e=!0}},[]);let ei=async()=>{if(W)return;el(!0);let e={...E,displayName:O||E.name,icon:M,visibility:V?[]:void 0,tags:B,users:(null==X?void 0:X.length)?X:void 0,settings:K};await _(e),el(!1)};return(0,n.jsxs)(o.FA,{f:1,gap:"$2",py:"$4",children:[(0,n.jsx)(o.FA,{gap:"$4",overflow:"auto",f:1,px:"$4",children:(0,n.jsxs)(d.I,{children:[(0,n.jsxs)(f.j,{title:"General",children:[(0,n.jsx)(f.p,{type:"text",label:"Display Name",description:"The name shown in the UI",value:O,onChange:D,placeholder:"Enter display name",disabled:W}),(0,n.jsx)(f.p,{label:"Icon",description:"Icon displayed for this board",control:(0,n.jsx)(o.FA,{minWidth:280,children:(0,n.jsx)(v.xG,{icons:J,onSelect:N,selected:M,disabled:W,inputProps:{backgroundColor:"$bgContent",borderColor:"$gray6"}})})}),(0,n.jsx)(f.p,{type:"toggle",label:"Hide board",description:"Hide this board from navigation",value:V,onChange:H,disabled:W})]}),(0,n.jsx)(f.j,{title:"Tags",children:(0,n.jsxs)(o.FA,{gap:"$3",children:[(0,n.jsx)(o.sL,{flexWrap:"wrap",gap:"$2",children:B.length?B.map(e=>(0,n.jsxs)(o.sL,{ai:"center",br:"$10",px:"$2",py:"$1.5",gap:"$2",bg:"$bgContent",children:[(0,n.jsx)(l.x,{numberOfLines:1,ellipsizeMode:"tail",children:e}),!W&&(0,n.jsx)(a.zx,{size:"$1",circular:!0,theme:"red",icon:p.X,scaleIcon:.8,onPress:()=>ea(e)})]},e)):(0,n.jsx)(l.x,{color:"$gray9",children:"No tags"})}),!W&&(0,n.jsxs)(o.sL,{gap:"$2",ai:"center",children:[(0,n.jsx)(m.y,{flex:1,borderRadius:8,placeholder:"Add tag",value:U,onChangeText:q,backgroundColor:"$bgContent",borderColor:"$gray6"}),(0,n.jsx)(a.zx,{size:"$3",onPress:()=>{let e=U.trim();!e||B.includes(e)||(G(t=>[...t,e]),q(""))},icon:(0,n.jsx)(h.v,{}),children:"Add"})]})]})}),(0,n.jsxs)(f.j,{title:"Display",children:[(0,n.jsx)(f.p,{type:"text",label:"Background Image",description:"URL or path to background image",placeholder:"https://example.com/image.jpg",value:null!==(P=null==K?void 0:K.backgroundImage)&&void 0!==P?P:"",onChange:e=>Y({...K,backgroundImage:e}),disabled:W}),(0,n.jsx)(f.p,{label:"Margin",description:"Card margin in pixels (X, Y)",control:(0,n.jsxs)(o.sL,{gap:"$2",children:[(0,n.jsx)(i.II,{width:80,backgroundColor:"$bgContent",borderColor:"$gray6",borderWidth:1,borderRadius:8,placeholder:"X",maxLength:3,value:null!==(I=null==K?void 0:null===(b=K.margin)||void 0===b?void 0:null===(r=b[0])||void 0===r?void 0:r.toString())&&void 0!==I?I:"",onChangeText:e=>{var t,r;return Y({...K,margin:[e&&!isNaN(parseInt(e))?parseInt(e).toString():"",null!==(r=null==K?void 0:null===(t=K.margin)||void 0===t?void 0:t[1])&&void 0!==r?r:""]})},disabled:W}),(0,n.jsx)(i.II,{width:80,backgroundColor:"$bgContent",borderColor:"$gray6",borderWidth:1,borderRadius:8,placeholder:"Y",maxLength:3,value:null!==(z=null==K?void 0:null===(j=K.margin)||void 0===j?void 0:null===(y=j[1])||void 0===y?void 0:y.toString())&&void 0!==z?z:"",onChangeText:e=>{var t,r;return Y({...K,margin:[null!==(r=null==K?void 0:null===(t=K.margin)||void 0===t?void 0:t[0])&&void 0!==r?r:"",e&&!isNaN(parseInt(e))?parseInt(e).toString():""]})},disabled:W})]})}),(0,n.jsx)(f.p,{type:"select",label:"Overlap",description:"Allow cards to overlap each other",value:(null==K?void 0:K.allowOverlap)===!0?"yes":(null==K?void 0:K.allowOverlap)===!1?"no":"default",options:[{value:"default",label:"Default"},{value:"yes",label:"Yes"},{value:"no",label:"No"}],onChange:e=>Y({...K,allowOverlap:"yes"===e||"no"!==e&&void 0}),disabled:W}),(0,n.jsx)(f.p,{type:"select",label:"Compact type",description:"How cards compact when dragged",value:(null==K?void 0:K.compactType)||"default",options:[{value:"default",label:"Default"},{value:"vertical",label:"Vertical"},{value:"horizontal",label:"Horizontal"}],onChange:e=>Y({...K,compactType:e}),disabled:W})]}),(0,n.jsxs)(f.j,{title:"Behavior",children:[(0,n.jsx)(f.p,{type:"toggle",label:"Autoplay",description:"Automatically start when board loads",value:null!==(L=null==K?void 0:K.autoplay)&&void 0!==L&&L,onChange:e=>Y({...K,autoplay:e}),disabled:W}),(0,n.jsx)(f.p,{type:"toggle",label:"Show UI on play",description:"Display board controls when playing",value:null!==(R=null==K?void 0:K.showBoardUIOnPlay)&&void 0!==R&&R,onChange:e=>Y({...K,showBoardUIOnPlay:e}),disabled:W}),(0,n.jsx)(f.p,{type:"toggle",label:"Show UI while playing",description:"Keep board controls visible during playback",value:null!==(F=null==K?void 0:K.showBoardUIWhilePlaying)&&void 0!==F&&F,onChange:e=>Y({...K,showBoardUIWhilePlaying:e}),disabled:W}),(0,n.jsx)(f.p,{type:"toggle",label:"Ephemeral Mode",description:"Cards use isolated state for concurrent execution",value:null!==(T=null==K?void 0:K.ephemeral)&&void 0!==T&&T,onChange:e=>Y({...K,ephemeral:e}),disabled:W})]}),(0,n.jsx)(f.j,{title:"Permissions",children:(0,n.jsxs)(o.FA,{gap:"$3",children:[(0,n.jsxs)(o.FA,{gap:"$1",children:[(0,n.jsx)(s.__,{color:"$text",fontSize:"$5",children:"Visible to users"}),(0,n.jsx)(s.__,{fontSize:"$4",color:"$gray10",children:"Whitelist: only selected groups can see this board. Leave empty to allow everyone."})]}),er?(0,n.jsx)(c.$,{size:"small"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.C,{choices:ee,defaultSelections:X,onSetSelections:e=>Q(e),disabled:W}),(!ee||0===ee.length)&&(0,n.jsx)(l.x,{color:"$gray9",fontSize:"$3",children:"No groups available"})]})]})})]})}),(0,n.jsx)(o.sL,{justifyContent:"flex-end",pt:"$2",px:"$4",children:(0,n.jsx)(d.I,{children:W?(0,n.jsx)(a.zx,{disabled:!0,size:"$4",children:"Read-only"}):(0,n.jsxs)(a.zx,{onPress:ei,size:"$4",width:"200px",children:["Save",eo&&(0,n.jsx)(c.$,{size:"small",ml:"$2"})]})})})]})}},59302:function(e,t,r){r.d(t,{tT:function(){return lO}});var n=r(52322),o=r(39006),l=r(68604),a=r(40966),i=r(57441),s=r(40811),c=r(30),d=r(72857),u=r(42581),p=r(12675),h=r(15230),g=r(42934),x=r(7244),v=r(74254),f=r(25184),m=r(7211),b=r(89662),y=r(19940),j=r(35423),$=r(75136),w=r(37288),C=r(78994),S=r(17518),k=r(47401),A=r(22522),P=r(50923),I=r(59316),z=r(14444);let L={x:-1,y:0};var R=r(97909),F=r(2784),T=r(86407),E=r(90251),_=r(79327),W=r(44285),O=r(26602),D=r(65457),M=r(87343),N=r(67045),V=r(69517),H=r(17289),B=r(76929),G=r(28031),U=r(67825),q=r(78215),J=r(21228),Z=r(19133),K=r(61773),Y=r(70142),X=r(752),Q=r(12497);let ee={10:{name:"TRACE",color:"$green3",icon:B.x},20:{name:"DEBUG",color:"$color4",icon:v.t},30:{name:"INFO",color:"$color7",icon:G.k},40:{name:"WARN",color:"$yellow7",icon:U.b},50:{name:"ERROR",color:"$red7",icon:q.a},60:{name:"FATAL",color:"$red10",icon:J.m}},et=[{name:"trace",icon:B.x},{name:"debug",icon:v.t},{name:"info",icon:G.k},{name:"warn",icon:U.b},{name:"error",icon:q.a},{name:"fatal",icon:J.m}],er=["info","warn","error","fatal"],en=F.memo(e=>{var t,r;let{data:o,topic:l}=e,a=l.split("/")[1],i=l.split("/")[2],s=null===(t=ee[i])||void 0===t?void 0:t.icon,{level:c,time:d,pid:u,hostname:p,msg:h,name:g,_meta:x,...v}=JSON.parse(o),f=x&&x.card&&x.board?(0,n.jsx)(S.x,{o:.7,fontSize:14,fontWeight:"500",children:"[board] "+x.board+" "+x.card}):(0,n.jsxs)(S.x,{o:.7,fontSize:14,fontWeight:"500",children:["[",a,"]"]}),[m,b]=(0,Q.u2)();return(0,n.jsx)(w.sL,{pb:"$2",ml:"$0",ai:"center",jc:"center",f:1,onHoverIn:()=>{(null==x?void 0:x.board)&&(null==x?void 0:x.card)&&b(x.board+"/"+x.card)},onHoverOut:()=>{b("")},children:(0,n.jsxs)(w.FA,{f:1,children:[(0,n.jsx)(w.sL,{f:1,hoverStyle:{bc:"$bgContent"},cursor:"pointer",ai:"center",mb:"$2",py:3,px:"$3",children:(0,n.jsxs)(w.sL,{ai:"center",hoverStyle:{o:1},o:.9,f:1,children:[(0,n.jsx)(Y.I,{children:(0,n.jsx)(w.sL,{mr:"$2",children:(0,n.jsx)(s,{size:20,strokeWidth:2,color:null===(r=ee[i])||void 0===r?void 0:r.color})})}),f,(0,n.jsx)(S.x,{ml:"$3",o:.9,fontSize:14,fontWeight:"500",children:h}),(0,n.jsx)(T.LZ,{f:1}),(0,n.jsx)(w.sL,{ai:"center",space:"$2",children:(0,n.jsx)(S.x,{o:.5,fontSize:13,fontWeight:"400",children:function(e){let t=new Date(e),r=t.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit"}),n=t.toLocaleDateString();return"".concat(r," ").concat(n)}(d)})})]})}),(0,n.jsx)(w.FA,{pl:"$3",children:(0,n.jsx)(Y.I,{children:(0,n.jsx)(M.W,{src:v})})})]})})}),eo=e=>{var t;let{AppState:r,logs:o,setLogs:l}=e,[a,i]=(0,X.KO)(r),[s,c]=(0,F.useState)([]),[d,u]=(0,F.useState)(""),p=null!==(t=a.levels)&&void 0!==t?t:er,h=F.useMemo(()=>et.map(e=>e.name),[]),g=p.length===et.length;(0,F.useEffect)(()=>{var e;let t=null!==(e=a.levels)&&void 0!==e?e:er;c(o.filter(e=>{let r=null==e?void 0:e.topic;r.split("/")[1];let n=ee[r.split("/")[2]];return n&&(!d||JSON.stringify(e).toLowerCase().includes(d.toLocaleLowerCase()))&&t.includes(n.name.toLocaleLowerCase())}))},[d,o,a.levels]),(0,F.useEffect)(()=>{a.levels||i(e=>({...e,levels:er}))},[a.levels,i]);let{tint:x}=(0,N.d5)(),v=F.useMemo(()=>"$"+x+"8",[x]);return(0,n.jsx)(P.Q,{children:(0,n.jsxs)(w.FA,{f:1,children:[(0,n.jsxs)(w.sL,{px:"$2",ai:"center",backgroundColor:"$backgroundTransparent",borderBottomWidth:1,borderColor:"$borderColor",children:[(0,n.jsx)(w.sL,{px:"$2",py:"$1.5",ai:"center",space:"$2",backgroundColor:"$backgroundTransparent",borderBottomWidth:1,borderColor:"$borderColor",children:(0,n.jsxs)(w.sL,{px:"$2",ai:"center",backgroundColor:"$backgroundTransparent",children:[(0,n.jsx)(E.J2,{placement:"bottom-start",children:(0,n.jsx)(E.J2.Trigger,{m:"$0",p:"$0",children:(0,n.jsx)(V.z,{size:20,Icon:H.K,onPress:()=>l([])})})}),(0,n.jsxs)(E.J2,{placement:"bottom-start",children:[(0,n.jsx)(E.J2.Trigger,{m:"$0",p:"$0",children:(0,n.jsx)(V.z,{size:20,Icon:Z.w})}),(0,n.jsxs)(E.J2.Content,{p:"$3",boc:"$borderColor",bw:1,bc:"$bgPanel",gap:"$2",br:"$6",elevation:"$2",children:[(0,n.jsx)(S.x,{fontSize:"$2",fontWeight:"700",children:"Log levels"}),(0,n.jsxs)(w.sL,{w:"100%",jc:"space-between",pt:"$2",px:"$2",ai:"center",gap:"$2",children:[(0,n.jsx)(S.x,{fontSize:"$3",col:"$gray10",children:"All levels"}),(0,n.jsx)(_.XZ,{bc:"$bgContent",size:"$4",height:20,checked:g,onCheckedChange:()=>{g?i(e=>({...e,levels:[]})):i(e=>({...e,levels:h}))},children:(0,n.jsx)(_.XZ.Indicator,{children:(0,n.jsx)(K.J,{size:16,color:"$color"})})})]}),(0,n.jsxs)(W.t,{orientation:"vertical",type:"multiple",onValueChange:e=>{i(t=>({...t,levels:e}))},value:p,children:[" ",et.map(e=>{let t=!p||!p.includes(e.name),r=t?"$bgPanel":"$bgContent";return(0,n.jsxs)(W.t.Item,{jc:"flex-start",ai:"center",flexDirection:"row",px:"$3",py:"$2",miw:"160px",value:e.name,focusStyle:{borderColor:"transparent",bc:r},pressStyle:{borderColor:"transparent",bc:r},borderColor:t?"transparent":"$gray4",hoverStyle:{bc:"$bgContent"},bc:r,borderRadius:"$4",children:[(0,n.jsxs)(Y.I,{children:[" ",(0,n.jsx)(e.icon,{size:"$1",o:t?.8:1,color:t?"$color":"$color8"})]}),(0,n.jsx)(S.x,{o:t?.8:1,ml:"$4",children:e.name.charAt(0).toUpperCase()+e.name.slice(1)})]},e.name)})]})]})]})]})}),(0,n.jsx)(O.II,{focusStyle:{borderLeftWidth:0,borderRightWidth:0,borderTopWidth:0,outlineWidth:0},forceStyle:"focus",br:0,backgroundColor:"$backgroundTransparent",value:d,width:"100%",onChangeText:e=>{u(e)},placeholder:"Search logs...",bw:0})]}),(0,n.jsx)(D.p,{bc:"transparent",f:1,height:"calc( 100vh - 90px )",p:"2px",py:"$1",children:s.map((e,t)=>(0,n.jsx)(w.sL,{bc:"transparent",hoverStyle:{bc:"$bgPanel",outlineWidth:2,outlineColor:v,outlineStyle:"solid"},btw:0,bbw:1,boc:"$color4",p:"$1",children:(0,n.jsx)(en,{data:e.message,topic:e.topic})},t))})]})})};var el=r(93228),ea=r(56274),ei=r(91709),es=r(26682);let ec=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"states/#",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"states",[n,o]=(0,F.useState)(e),l=e=>{f.API.get("/api/core/v1/protomemdb/"+e).then(e=>{null!=e.data&&o(e.data)}).catch(e=>console.error("Error al obtener datos:",e))};return(0,F.useEffect)(()=>{l(r)},[r]),null==t||(0,es.u)((e,t)=>{var n;let l=null===(n=t.parsed.path)||void 0===n?void 0:n.split("/");if(!Array.isArray(l)||l.length<2)return;let a=l.slice(0,-1);a[0]===r&&(t.topic.endsWith("/update")&&o(e=>(function e(t,r,n,o){var l;if(0===r.length)return"states"===o?n.value:n;let[a,...i]=r;return{...t,[a]:e(null!==(l=null==t?void 0:t[a])&&void 0!==l?l:{},i,n,o)}})(e,a.slice(1),t.parsed.payload,r)),t.topic.endsWith("/delete")&&o(e=>(function e(t,r){if(!t||0===r.length)return t;let[n,...o]=r;if(0===o.length){let{[n]:e,...r}=t;return r}let l=e(t[n],o);if(null==l||"object"==typeof l&&0===Object.keys(l).length){let{[n]:e,...r}=t;return r}return{...t,[n]:l}})(e,a.slice(1))))},{path:t}),n};var ed=r(52146),eu=r(93075),ep=r(8448),eh=r(28965),eg=r(86184),ex=r(16399),ev=r(6364),ef=r(57334),em=r(95722);(0,f.Protofy)("features",{});let eb=f.Schema.object((0,f.Protofy)("schema",{name:f.z.string().search(),group:f.z.string().search(),tag:f.z.string().search(),id:f.z.string().id().search(),templateName:f.z.string().search(),defaults:f.z.record(f.z.any()).optional()}));(0,f.Protofy)("api",{name:"cards",prefix:"/api/core/v1/"});let ey=f.AutoModel.createDerived("CardModel",eb);var ej=r(71276);let e$=e=>{let{children:t}=e;return(0,n.jsx)(w.sL,{jc:"flex-start",ai:"center",gap:25,flexWrap:"wrap",children:t})},ew=e=>{let{selectedCards:t,setSelectedCards:r,options:o,errors:l}=e,a=(0,ed.C)(),{resolvedTheme:i}=(0,ex.P)(),[s,c]=(0,F.useState)(""),d=e=>{var t;return(null===(t=e.defaults)||void 0===t?void 0:t.type)==="action"},[u,p]=(0,F.useState)([]),h=(0,F.useRef)({}),[g,x]=(0,F.useState)(null),v=(0,F.useMemo)(()=>(o.sort((e,t)=>e.group&&t.group?e.group.localeCompare(t.group):0),[...new Set(o.map(e=>e.group).filter(Boolean))]),[o]),f=e=>{p(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},m=(e,t)=>{var r,n,o,l,a,i,s,c,d,u;let p=0,h=(null!==(l=e.templateName)&&void 0!==l?l:"").toLowerCase(),g=(null!==(a=e.name)&&void 0!==a?a:"").toLowerCase(),x=(null!==(i=null===(r=e.defaults)||void 0===r?void 0:r.description)&&void 0!==i?i:"").toLowerCase(),v=(null!==(s=e.group)&&void 0!==s?s:"").toLowerCase(),f=(null!==(c=e.tag)&&void 0!==c?c:"").toLowerCase(),m=Object.keys(null!==(d=null===(n=e.defaults)||void 0===n?void 0:n.params)&&void 0!==d?d:{}).join(" ").toLowerCase()+" "+Object.values(null!==(u=null===(o=e.defaults)||void 0===o?void 0:o.params)&&void 0!==u?u:{}).join(" ").toLowerCase();for(let e of t)h.includes(e)&&(p+=100),g.includes(e)&&(p+=80),x.includes(e)&&(p+=60),v.includes(e)&&(p+=40),f.includes(e)&&(p+=40),m.includes(e)&&(p+=20);return p},b=(e,t,r)=>{let n=t.toLowerCase().trim().split(/\s+/).filter(e=>e.length>0);return 0===n.length?e.filter(e=>0===r.length||r.includes(e.group)):e.filter(e=>0===r.length||r.includes(e.group)).map(e=>({opt:e,score:m(e,n)})).filter(e=>{let{score:t}=e;return t>0}).sort((e,t)=>t.score-e.score).map(e=>{let{opt:t}=e;return t})},y=(0,F.useMemo)(()=>b(o,s,u),[o,s,u]),j=(0,F.useMemo)(()=>y.reduce((e,t)=>{var r;let n=null!==(r=t.group)&&void 0!==r?r:"__no_group__";return e[n]||(e[n]=[]),e[n].push(t),e},{}),[y]),$=(0,F.useMemo)(()=>Object.values(j).flat(),[j]),A=e=>t.some(t=>t.id===e.id),P=(e,n)=>{if(n.shiftKey&&g&&$.length>0){let n=$.findIndex(e=>e.id===g),o=$.findIndex(t=>t.id===e.id);if(-1!==n&&-1!==o){let e=$.slice(Math.min(n,o),Math.max(n,o)+1),l=new Set(t.map(e=>e.id));r([...t,...e.filter(e=>!l.has(e.id))])}}else n.ctrlKey||n.metaKey?(A(e)?t.length>1&&r(t.filter(t=>t.id!==e.id)):r([...t,e]),x(e.id)):(r([e]),x(e.id),setTimeout(()=>{var t;return null===(t=h.current[e.id])||void 0===t?void 0:t.focus()},0))},I=(e,t)=>{r(r=>r.map(r=>r.id===e?{...r,defaults:{...r.defaults,customName:t&&t.length?t:null}}:r))},z=e=>{t.length>1&&r(t=>t.filter(t=>t.id!==e))};return(0,n.jsxs)(w.sL,{f:1,gap:"$4",pb:"$4",children:[(0,n.jsxs)(w.FA,{f:1,children:[(0,n.jsxs)(w.sL,{pb:8,mb:5,position:"relative",children:[(0,n.jsx)(eh.o,{pos:"absolute",left:"$3",top:14,size:16,pointerEvents:"none"}),(0,n.jsx)(O.II,{bg:"$gray3",color:"$gray12",paddingLeft:"$7",bw:"dark"===a?0:1,h:"47px",boc:"$gray5",w:"100%",placeholder:"search...",placeholderTextColor:"$gray9",outlineColor:"$gray8",value:s,onChangeText:e=>{var n;c(e);let l=null===(n=b(o,e,u))||void 0===n?void 0:n[0];l&&t.length<=1&&r([l])}})]}),(0,n.jsx)(w.sL,{gap:"$2",mb:"$4",flexWrap:"wrap",children:(0,n.jsx)(Y.I,{children:v.map(e=>{let t=u.includes(e);return(0,n.jsx)(k.zx,{onPress:()=>f(e),size:"$3",style:{backgroundColor:t?"var(--color4)":"var(--gray3)",borderColor:t?"var(--color7)":"var(--gray5)",borderWidth:"1px",borderRadius:"$10",color:t?"$color":"inherit"},children:e},e)})})}),(0,n.jsx)(w.sL,{flex:1,gap:"$3",children:(0,n.jsx)(Y.I,{children:(0,n.jsx)(D.p,{children:Object.entries(j).map(e=>{let[t,r]=e;return(0,n.jsxs)(w.FA,{mb:"$3",children:["__no_group__"!==t&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(S.x,{fontSize:"$5",fontWeight:"600",mb:"$2",children:t})}),(0,n.jsx)(e$,{children:r.map(e=>{var t,r;let o=A(e),l="devices"===e.group&&e.tag,a=l?(e=>{if(!e)return"";let t=e.split("_");if(t.length>=2){let e=t[0],r=t.slice(1).join("_"),n=r.length>12?r.slice(0,8)+"…":r;return"".concat(e," \xb7 ").concat(n)}return e})(e.tag):null;return(0,n.jsxs)(w.sL,{height:l?80:70,width:"calc(50% - 12.5px)",gap:"$2",p:"$2",px:"$3",cursor:"pointer",onPress:t=>P(e,t),borderRadius:"$3",ai:"center",bw:"1px",boc:o?"$color8":"$gray5",bc:o?"$color4":"$gray2",hoverStyle:{bc:"$color4",boc:"$color7"},children:[(0,n.jsx)(w.FA,{br:d(e)?"$10":"$2",p:"$2.5",bc:(null==e?void 0:null===(t=e.defaults)||void 0===t?void 0:t.color)?null==e?void 0:null===(r=e.defaults)||void 0===r?void 0:r.color:d(e)?"$yellow8":"$blue8",children:(0,n.jsx)(eg.N1,{name:e.defaults.icon,color:"var(--color)",size:20})}),(0,n.jsxs)(w.FA,{f:1,ml:"$2",children:[(0,n.jsx)(S.x,{fontSize:"$4",numberOfLines:1,children:e.templateName}),a&&(0,n.jsx)(S.x,{fontSize:"$2",color:"$gray9",numberOfLines:1,mt:"$1",children:a})]})]},e.id)})})]},t)})})})}),(0,n.jsx)(S.x,{fontSize:"$2",color:"$gray9",mt:"$2",children:"Tip: Shift+Click to select a range, Ctrl+Click to add/remove"})]}),(0,n.jsxs)(w.FA,{width:500,height:"100%",gap:"$3",children:[(0,n.jsx)(w.sL,{jc:"space-between",ai:"center",px:"$2",children:(0,n.jsxs)(S.x,{fontSize:"$5",fontWeight:"600",color:"$gray11",children:[t.length," card",1!==t.length?"s":""," selected"]})}),(0,n.jsx)(D.p,{f:1,children:(0,n.jsx)(w.FA,{gap:"$3",pr:"$2",children:t.map((e,r)=>{var o,a,i,s,c,u,p;return(0,n.jsxs)(w.FA,{bw:1,bc:"$gray3",br:"$3",p:"$4",boc:"$gray6",children:[(0,n.jsxs)(w.sL,{gap:"$2",ai:"center",jc:"space-between",mb:"$2",children:[(0,n.jsxs)(w.sL,{gap:"$2",ai:"center",f:1,children:[(0,n.jsx)(w.FA,{br:d(e)?"$10":"$2",p:"$2",bc:(null==e?void 0:null===(o=e.defaults)||void 0===o?void 0:o.color)?e.defaults.color:d(e)?"$yellow8":"$blue8",children:(0,n.jsx)(eg.N1,{name:null===(a=e.defaults)||void 0===a?void 0:a.icon,color:"var(--color)",size:16})}),(0,n.jsx)(S.x,{fontSize:"$4",fontWeight:"500",f:1,numberOfLines:1,children:e.templateName})]}),t.length>1&&(0,n.jsx)(k.zx,{size:"$2",circular:!0,bc:"transparent",hoverStyle:{bc:"$red4"},onPress:()=>z(e.id),children:(0,n.jsx)(S.x,{color:"$red9",fontSize:"$3",children:"✕"})})]}),(0,n.jsxs)(w.FA,{w:"100%",children:[(0,n.jsx)(eu.__,{alignSelf:"flex-start",ml:"$2",h:"$3",color:"$gray9",size:"$3",children:"Name"}),(0,n.jsx)(O.II,{bg:"$gray6",placeholder:null!==(u=null===(i=e.defaults)||void 0===i?void 0:i.name)&&void 0!==u?u:"Card name",placeholderTextColor:"$gray10",outlineColor:"$gray8",w:"100%",size:"$3",ref:t=>{h.current[e.id]=t},value:null!==(p=null===(s=e.defaults)||void 0===s?void 0:s.customName)&&void 0!==p?p:"",onChangeText:t=>I(e.id,t)})]}),(null===(c=e.defaults)||void 0===c?void 0:c.description)&&(0,n.jsxs)(w.FA,{w:"100%",mt:"$2",children:[(0,n.jsx)(eu.__,{alignSelf:"flex-start",ml:"$2",h:"$3",color:"$gray9",size:"$3",children:"Description"}),(0,n.jsx)(ef.Markdown,{readOnly:!0,copyToClipboardEnabled:!1,fontSize:14,p:4,data:e.defaults.description})]}),0===r&&(null==l?void 0:l.length)>0&&(0,n.jsx)(w.FA,{mt:"$2",children:l.map((e,t)=>(0,n.jsx)(C.n,{color:"$red9",fontSize:"$3",children:e},"err"+t))})]},e.id)})})})]})]})},eC={value:"tag",action:"zap"},eS=[{defaults:{type:"action",name:"action",width:2,height:7,displayResponse:!0,icon:"rocket",displayIcon:!1,params:{input:"action input"},configParams:{input:{visible:!0,defaultValue:"",type:"any"}},rulesCode:"return params.input",description:"Default description, edit this description to improve usability of this action"},group:"base",tag:"cards",name:"action",id:"base.cards.action",templateName:"Action"},{defaults:{width:3,height:22,type:"action",name:"AI Action",displayResponse:!0,editRulesInLowCode:!1,editRulesInNaturalLanguage:!1,rulesCode:'const instructionsExecution = context.ai.htmlBox(`\n<p>You are an AI agent inside <strong style="color:#0a84ff;">Vento</strong>, an AI agent platform.</p>\n<p>The agent is managed through a <strong>board</strong> composed of <em>states</em> and <em>actions</em>.</p>\n<p>Your mission is to generate a JSON response in this format:</p>\n<pre style="background:#2c2c2e;color:#0a84ff;padding:12px;border-radius:8px;overflow-x:auto;font-size:12px;margin:8px 0;border:1px solid #3a3a3c;">\n{\n  "response": "your message in markdown format",\n  "actions": [\n    { "name": "action name", "params": { "key": "value" } }\n  ]\n}\n</pre>\n<ul style="margin:8px 0;padding-left:20px;color:#e5e5e7;">\n<li>The <strong>response</strong> will be shown to the user</li>\n<li>The <strong>actions</strong> array can be empty if no actions needed</li>\n<li>Always use the action <strong>name</strong>, never the key, or id, just the name</li>\n<li>Use <strong style="color:#0a84ff;">Board States</strong> to answer questions</li>\n<li>If something is unavailable, suggest extending the board</li>\n</ul>\n`, \'Instructions\')\n\nconst instructionsReadOnly = context.ai.htmlBox(`\n<p>You are an assistant providing answers about an agent\'s state.</p>\n<p>Use the <strong style="color:#0a84ff;">Board States</strong> to answer questions.</p>\n<p>Answer in plain language, in the same language as the prompt.</p>\n<p>Your answer will be sent to a human. Please don\'t use json or other things except markdown</p>\n`, \'Instructions\')\n\n// Build prompt suffix if include_previous_actions is enabled (requires allow_read)\nconst promptSuffix = params.include_previous_actions && params.allow_read && params.previous_actions_card?.length\n  ? `The following actions have been executed. Use plain language, and not explain any tech details: ${params.previous_actions_card.map(card => JSON.stringify(board?.[card])).filter(Boolean).join(\'\\n\')}`\n  : undefined\n\nconst { prompt, response } = await context.ai.aiAction({\n  board,\n  boardActions,\n  name,\n  boardName,\n  prompt: params.prompt,\n  prompt_suffix: promptSuffix,\n  full_board_view: params.full_board_view,\n  allow_read: params.allow_read,\n  values: params.values,\n  invisible_values: [...(params.invisible_values || []), name],\n  allow_execution: params.allow_execution,\n  actions: params.actions,\n  invisible_actions: [...(params.invisible_actions || []), name],\n  debug: params.debug,\n  log_ai_calls: params.log_ai_calls,\n  instructionsExecution,\n  instructionsReadOnly,\n  getStatesByType: context.boards.getStatesByType\n})\n\nif (params.debug) return prompt\n\nif (params.allow_execution) {\n  return context.ai.processResponse({\n    response,\n    execute_action\n  })\n}\n\nreturn response\n',html:"//@card/react\n\nfunction Widget(card) {\n  const value = card.value;\n  \n  // Auto-detect HTML content\n  const isHtmlContent = typeof value === 'string' && value.trim().startsWith('<');\n  const mode = card.markdownDisplay ? 'markdown' : (card.htmlDisplay || isHtmlContent) ? 'html' : 'normal';\n\n  const content = <YStack f={1} mt={\"20px\"} ai=\"center\" jc=\"center\" width=\"100%\">\n      {card.icon && card.displayIcon !== false && (\n          <Icon name={card.icon} size={48} color={card.color}/>\n      )}\n      {card.displayResponse !== false && (\n          <CardValue mode={mode} value={value ?? \"N/A\"} />\n      )}\n  </YStack>\n\n  return (\n      <Tinted>\n        <ProtoThemeProvider forcedTheme={window.TamaguiTheme}>\n          <ActionCard data={card}>\n            {card.displayButton !== false ? <ParamsForm data={card}>{content}</ParamsForm> : card.displayResponse !== false && content}\n          </ActionCard>\n        </ProtoThemeProvider>\n      </Tinted>\n  );\n}",params:{prompt:"User prompt to send to the AI",full_board_view:"Allows the AI to see the entire board",allow_read:"Allows this AI action to read other card values",values:"name of the cards for the AI to see",invisible_values:"name of the cards the AI should not see",include_previous_actions:"Include results from a previous AI action in the prompt",previous_actions_card:"Card whose result to include",allow_execution:"Allow this AI action to execute other actions",actions:"name of the action cards visible for the AI to run",invisible_actions:"name of the action cards the AI should not see",debug:"Returns the prompt instead of calling the AI",log_ai_calls:"Enable AI call logging"},configParams:{prompt:{visible:!0,defaultValue:"",type:"any"},full_board_view:{visible:!0,defaultValue:"false",type:"boolean"},allow_read:{visible:!0,defaultValue:"true",type:"boolean"},values:{visible:!0,defaultValue:'["*"]',type:"array",cardSelector:!0,cardSelectorType:"value",visibility:{mode:"all",fields:["full_board_view","allow_read"],values:[!1,!0]}},invisible_values:{visible:!0,defaultValue:"[]",type:"array",cardSelector:!0,cardSelectorType:"value",visibility:{mode:"all",fields:["full_board_view","allow_read"],values:[!1,!0]}},include_previous_actions:{visible:!0,defaultValue:"false",type:"boolean",visibility:{field:"allow_read",mode:"boolean"}},previous_actions_card:{visible:!0,defaultValue:"[]",type:"array",cardSelector:!0,cardSelectorType:"action",visibility:{mode:"all",fields:["include_previous_actions","allow_read"],values:[!0,!0]}},allow_execution:{visible:!0,defaultValue:"true",type:"boolean"},actions:{visible:!0,defaultValue:'["*"]',type:"array",cardSelector:!0,cardSelectorType:"action",visibility:{mode:"all",fields:["full_board_view","allow_execution"],values:[!1,!0]}},invisible_actions:{visible:!0,defaultValue:"[]",type:"array",cardSelector:!0,cardSelectorType:"action",visibility:{mode:"all",fields:["full_board_view","allow_execution"],values:[!1,!0]}},debug:{visible:!0,defaultValue:"false",type:"boolean"},log_ai_calls:{visible:!0,defaultValue:"false",type:"boolean"}},description:"Unified AI action card for executing actions and answering questions using AI.\n\n#### Key Features\n- Execute actions OR read states based on configuration\n- Optionally include previous action results in the prompt\n- Full visibility control for actions and states",displayIcon:!1,displayButton:!0,displayButtonIcon:!0,icon:"sparkles",color:"var(--color7)"},name:"aiaction",id:"ai.cards.aiaction",templateName:"AI Action",group:"ai",tag:"cards"},{defaults:{type:"value",name:"value",width:2,height:7,icon:"scan-eye",description:"Default description, edit this description to improve usability of this value",params:{input:"input to observe"},configParams:{input:{visible:!0,defaultValue:"",type:"any"}},rulesCode:"return params.input;\n"},name:"Value",id:"base.cards.value",group:"base",tag:"cards",templateName:"Value"}],ek=async e=>{e(await f.API.get({url:"/api/core/v1/cards"}))},eA=function(){var e,t;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],[n,o]=(0,em.U)((0,f.getPendingResult)("pending"),ek,"notifications/card/#",ey,!0);return[...r,...null!==(t=null==n?void 0:null===(e=n.data)||void 0===e?void 0:e.items)&&void 0!==t?t:[]]},eP=e=>{var t,r,n,o,l,a,i,s,c;let d=(null==e?void 0:null===(t=e.defaults)||void 0===t?void 0:t.type)||(null==e?void 0:e.type)||"value",u=null!==(a=null==e?void 0:null===(r=e.defaults)||void 0===r?void 0:r.width)&&void 0!==a?a:"value"===d?1:2,p=null!==(i=null==e?void 0:null===(n=e.defaults)||void 0===n?void 0:n.height)&&void 0!==i?i:"value"===d?4:6,h=null!==(s=null==e?void 0:null===(o=e.defaults)||void 0===o?void 0:o.icon)&&void 0!==s?s:eC[d],g=null!==(c=null==e?void 0:null===(l=e.defaults)||void 0===l?void 0:l.html)&&void 0!==c?c:ej.R[d];return{key:"key",...e,...null==e?void 0:e.defaults,width:u,height:p,icon:h,html:g}},eI=e=>{let{defaults:t={},board:r,addOpened:o,setAddOpened:l,onFinish:a,states:i,icons:s,actions:c,errors:d}=e,u=eA(eS),[p,h]=(0,F.useState)([]),[g,x]=(0,F.useState)(!1),[v,f]=(0,F.useState)((0,ev.Z)()),m=p.length>1?"Create ".concat(p.length," cards"):"Create";return(0,F.useEffect)(()=>{o?f((0,ev.Z)()):(null==u?void 0:u.length)&&h([u[0]])},[o]),(0,n.jsx)(el.a,{integratedChat:!0,p:"$2",pt:"$5",pl:"$5",setOpen:l,open:o,hideAccept:!0,description:"",children:(0,n.jsx)(w.FA,{f:1,jc:"center",ai:"center",children:(0,n.jsx)(w.sL,{f:1,mr:"$5",children:(0,n.jsx)(ep.M,{hideHeader:!0,styles:{f:1,w:"90vw",maw:1400,h:"90vh",mah:1200},lastButtonCaption:m,disabled:0===p.length,loading:g,onFinish:async()=>{x(!0);try{var e;let t=new Set(null!==(e=null==r?void 0:r.cards.map(e=>e.name))&&void 0!==e?e:[]),n=p.map(e=>{var r,n;let o=eP(e),l=null!==(n=null===(r=e.defaults)||void 0===r?void 0:r.customName)&&void 0!==n?n:o.name;return o.name=function(e,t){let r;let n=t instanceof Set?t:new Set(t);if(!n.has(e))return e;let o=e.lastIndexOf("."),l=o>0?e.slice(o):"",a=o>0?e.slice(0,o):e,i=/^(.*?)(?: (\d+))?$/.exec(a),s=i[1],c=i[2]?+i[2]:1;do r="".concat(s," ").concat(++c).concat(l);while(n.has(r));return r}(l,t),t.add(o.name),o});await a(n),l(!1)}catch(e){console.error("Error creating cards: ",e)}x(!1)},slides:[{name:"Create new card",component:(0,n.jsx)(ew,{options:u,selectedCards:p,setSelectedCards:h,errors:d})}]})})})})};var ez=r(94182),eL=r(83103),eR=r(56814),eF=r(60892),eT=r(48780),eE=r(94631),e_=r(46507),eW=r(13296),eO=r(47246),eD=r(68346),eM=r(25538),eN=r(66431),eV=r(96876);let eH=e=>{if(!e.params||0===Object.keys(e.params).length)return"";let t=Object.entries(e.params).map(e=>{let[t,r]=e;return'	"'.concat(t,'": ').concat("string"==typeof r?"'".concat(r,"'"):r,", // ").concat(r)}).join("\n");return"declare const params: {\n".concat(t,"\n};")},eB=e=>{let{cardData:t,board:r,panels:o=["actions","states"],actions:l,states:a,rules:i,rulesCode:s,setRulesCode:c,value:d,valueReady:u=!0,setRules:p,rulesConfig:h={},readOnly:g=!1}=e,{resolvedTheme:x}=(0,ex.P)(),v=(0,eM.tg)("ai.enabled",!1),[f,m]=(0,F.useState)(null),b=(0,F.useMemo)(()=>{let e=function(e,t){let r=function e(t){if(null==t)return"any";switch(typeof t){case"string":return"string";case"number":return"number";case"boolean":return"boolean";case"function":return"(...args: any[]) => any"}if(Array.isArray(t)){let r=Array.from(new Set(t.map(e))),n=r.length>0?r.join(" | "):"any";return"Array<".concat(n,">")}let r=Object.entries(t).map(t=>{let[r,n]=t,o=e(n);return'"'.concat(r,'"?: ').concat(o)});return"{ ".concat(r.join("; ")," }")}(t);return"declare const ".concat(e,": ").concat(r,";")}("states",{board:a});return"\n".concat(e,"\n").concat("action"==t.type?"declare function executeAction({name: string, params?: Record<string, any>}): void;":"","\n").concat("action"==t.type?eH(t):"")},[a,t]),y=(0,eO.Fg)(),j=(0,F.useRef)(null!=s?s:"return;"),$=(0,F.useMemo)(()=>{var e;return(0,n.jsx)(eN.AU,{rulesProps:{title:"Card Rules",allowParams:!0,availableParams:Object.keys(null!==(e=null==t?void 0:t.params)&&void 0!==e?e:{})},pathname:"action"==t.type?"/rules":"/observerCard",onApplyRules:async e=>await p(e),disableAIPanels:!v||!1===t.editRulesInNaturalLanguage,disableFlowMode:!1===t.editRulesInLowCode,defaultMode:v?"rules":"code",rules:i,viewPort:{x:20,y:window.innerHeight/8,zoom:.8},onFlowChange:e=>{j.current=e,c(e)},onCodeChange:e=>{j.current=e,c(e)},path:t.name+(s&&s.trim&&s.trim().startsWith("<")?".html":".ts"),flowsPath:t.name,sourceCode:j,rulesConfig:h,monacoOnMount:(e,t)=>{var r,n;null===(r=(n=t.languages.typescript.typescriptDefaults).setDiagnosticsOptions)||void 0===r||r.call(n,{diagnosticCodesToIgnore:[1375,1108]}),t.languages.typescript.typescriptDefaults.setCompilerOptions({target:t.languages.typescript.ScriptTarget.ESNext,module:t.languages.typescript.ModuleKind.None,allowNonTsExtensions:!0,allowJs:!0,allowSyntheticDefaultImports:!0,moduleResolution:t.languages.typescript.ModuleResolutionKind.NodeJs,noEmit:!0,typeRoots:["node_modules/@types"],allowUmdGlobalAccess:!0,resolveJsonModule:!0,isolatedModules:!1,useDefineForClassFields:!0,lib:["esnext"]}),t.languages.typescript.typescriptDefaults.addExtraLib(b,"ts:filename/customTypes.d.ts")},monacoOptions:{folding:!0,lineDecorationsWidth:0,lineNumbersMinChars:0,lineNumbers:!0,minimap:{enabled:!1}},onModeChange:e=>m(e),readOnly:g})},[x,r.name,y,v,h.enabled,h.loading,t.returnType,g]);return(0,n.jsxs)(eW.eh,{direction:"horizontal",children:[(0,n.jsx)(eW.s_,{defaultSize:70,minSize:20,children:(0,n.jsx)(w.FA,{flex:1,height:"100%",borderRadius:"$3",gap:"$2",overflow:"hidden",children:(0,n.jsx)(Y.I,{children:$})})}),(0,n.jsx)(eD.Z,{direction:"vertical",borderLess:!1,borderColor:"var(--gray4)"}),(0,n.jsx)(eV.M,{type:"card",board:r,panels:o,actions:l,states:a,copyMode:f,showActionsTabs:!0,showStatesTabs:!0})]})};var eG=r(99362),eU=r(11793),eq=r(85522);let eJ=e=>{var t;let{board:r,actions:o,states:l,cardData:a,setCardData:i,compiler:s,onCodeChange:c,extraCompilerData:d={},readOnly:u=!1}=e,[p,h]=(0,F.useState)(void 0!==a.rulesCode),[g,x]=(0,F.useState)(),v=(0,eM.tg)("ai.provider",""),m=(0,F.useMemo)(()=>(0,eq.qI)(v),[v]),b=(null==m?void 0:m.apiKeyName)||"OPENAI_API_KEY",{hasKey:y,updateKey:j,loading:$}=(0,eG.W)(b),[w,C]=(0,F.useState)(0),{isAIReady:S,aiMode:k}=(0,F.useMemo)(()=>v&&"skip"!==v?(null==m?void 0:m.requiresApiKey)?{isAIReady:y,aiMode:"needs-key"}:{isAIReady:!0,aiMode:"ready"}:{isAIReady:!1,aiMode:"not-configured"},[v,m,y]),A=async e=>{if(e&&e.length>0){var t,n,o,i,c;let u=null!==(c=null==l?void 0:l[r.name])&&void 0!==c?c:{};"value"==a.type&&delete u[a.name],h(!1);let p=await f.API.post("/api/core/v1/autopilot/"+s+"?debug=true",{board:r.name,states:u,rules:e,previousRules:a.rules,card:a,...d});return(null==p?void 0:p.error)?{error:(null===(t=p.error)||void 0===t?void 0:t.error)||"Error generating rules code",message:(null==p?void 0:null===(n=p.error)||void 0===n?void 0:n.message)||""}:(null==p?void 0:null===(o=p.data)||void 0===o?void 0:o.jsCode)?(h(!0),{rulesCode:p.data.jsCode,rulesExplained:null===(i=p.data)||void 0===i?void 0:i.explanation}):{}}return{rulesCode:"//empty rules",rulesExplained:"The rules are empty"}};return(0,F.useEffect)(()=>{if(a.rulesCode)try{let e=c(a,l);x(e)}catch(e){}},[a.rulesCode]),(0,n.jsx)(eB,{cardData:a,board:r,panels:"value"==a.type?["states"]:["actions","states"],setRulesCode:e=>{u||i(t=>({...t,rulesCode:e}))},rulesCode:a.rulesCode,actions:o,states:l,rules:null!==(t=a.rules)&&void 0!==t?t:[],value:g,setRules:async e=>{var t;if(u)return;let r=await A(e);if(r.error)throw Error(null!==(t=r.message)&&void 0!==t?t:r.error);C(e=>e+1),i(t=>({...t,...r,rules:e}))},rulesConfig:{enabled:S,loading:$,disabledView:()=>(0,n.jsx)(eU.W,{updateKey:j,loading:$,mode:"not-configured"===k?"not-configured":"needs-key",providerName:null==m?void 0:m.name})},setReturnType:e=>i(t=>({...t,returnType:e})),valueReady:p,readOnly:u},w)};var eZ=r(54243),eK=r(39608),eY=r(95546),eX=r(89702),eQ=r(72311),e0=r(37164),e1=r(59328),e2=r(58795),e3=r(94291);let e4=e=>{let{links:t,setLinks:r,mode:o="all",selectProps:a={},readOnly:i=!1}=e,s=(0,Q.eL)(),c=(0,F.useMemo)(()=>Object.keys(s||{}),[s]),d=[{value:"pre",caption:"Before"},{value:"post",caption:"After"}],u=(0,F.useCallback)(()=>{i||r([...t,{name:"",type:"all"===o?"post":o}])},[o,t,r,i]),p=(0,F.useCallback)(e=>{i||r(t.filter((t,r)=>r!==e))},[t,r,i]),h=(0,F.useCallback)((e,n,o)=>{i||r(t.map((t,r)=>r===e?{...t,[n]:o}:t))},[t,r,i]),g=(0,F.useMemo)(()=>t.map((e,t)=>({...e,idx:t})).filter(e=>"all"===o||e.type===o),[t,o]);return(0,n.jsxs)(n.Fragment,{children:[g.map(e=>{let{idx:t,type:r,name:l}=e;return(0,n.jsxs)(w.sL,{alignItems:"center",mb:"$2",gap:"$2",borderRadius:"$2",w:"100%",children:["all"===o&&(0,n.jsx)(e1.E,{title:"Type",value:r,elements:d,setValue:e=>h(t,"type",e),triggerProps:{maxWidth:200,...a},disabled:i}),(0,n.jsx)(e1.E,{title:"Actions",elements:c,value:null!=l?l:"",setValue:e=>h(t,"name",e),placeholder:"Select an action...",triggerProps:{f:1,...a},selectorStyle:{normal:{backgroundColor:"var(--bgPanel)",...a},hover:{backgroundColor:"var(--bgPanel)",filter:"brightness(0.9)"}},rowStyle:{normal:{backgroundColor:"var(--bgPanel)"},hover:{backgroundColor:"var(--bgContent)"}},titleStyle:{normal:{backgroundColor:"var(--bgPanel)"}},disabled:i}),(0,n.jsx)(V.z,{mt:"4px",Icon:eY.r,IconColor:"var(--red10)",onPress:i?void 0:()=>p(t),disabled:i})]},t+o)}),(0,n.jsx)(e3.w,{label:"Add trigger",delay:{open:500,close:0},restMs:0,children:(0,n.jsx)(k.zx,{bc:"$gray6",circular:!0,icon:l.v,alignSelf:"center",scaleIcon:1.2,mt:"$2",onPress:u,disabled:i})})]})},e5=["any","string","number","boolean","json","array","text","path","markdown","html","select"],e8={backgroundColor:"$bgPanel",borderColor:"$gray6",placeholderTextColor:"$gray9",flex:1,w:"100%"},e6={...e8,hoverStyle:{borderColor:"$color7",bc:"$gray1"}},e7=e=>{let{children:t,...r}=e;return(0,n.jsx)(S.x,{color:"$gray9",...r,children:t})},e9=e=>{let{onClose:t,show:r,addRow:o,readOnly:l=!1}=e,[a,i]=(0,F.useState)(""),[s,c]=(0,F.useState)(""),[d,u]=(0,F.useState)(""),[p,h]=(0,F.useState)("");return(0,n.jsx)(w.FA,{onPress:()=>t(),style:{position:"absolute",height:"100%",width:"100%",backgroundColor:"#00000051",zIndex:200,top:"0px",right:"0px",visibility:r?"visible":"hidden",opacity:r?1:0,transition:"all 120ms ease-in-out"},children:(0,n.jsxs)(w.FA,{bg:"$bgContent",onPress:e=>e.stopPropagation(),borderLeftColor:"$gray6",borderLeftWidth:"1px",jc:"space-between",py:"$5",px:"$6",gap:"$4",overflowBlock:"scroll",style:{position:"absolute",height:"100%",minWidth:"400px",width:"fit-content",transform:r?"":"translateX(100%)",transition:"all 150ms ease-in-out",zIndex:200,top:"0px",right:"0px"},children:[(0,n.jsxs)(w.FA,{gap:"$5",children:[(0,n.jsxs)(w.FA,{children:[(0,n.jsx)(S.x,{h:"fit-content",w:"fit-content",fontSize:"$7",children:"New input"}),(0,n.jsx)(e7,{children:"Configure an input parameter to the card execution"})]}),(0,n.jsxs)(w.FA,{gap:"$2",children:[(0,n.jsx)(e7,{children:"Title"}),(0,n.jsx)(O.II,{placeholder:"Title",bg:"$bgPanel",borderColor:"$colorTransparent",placeholderTextColor:"$gray9",hoverStyle:{borderColor:"$gray6"},focusStyle:{borderColor:"$gray6",outlineColor:"$gray6",outlineOffset:"2px",outlineWidth:"2px"},value:a,onChange:e=>i(e.currentTarget.value),disabled:l}),(0,n.jsx)(e7,{children:"Description"}),(0,n.jsx)(O.II,{placeholder:"Description",bg:"$bgPanel",borderColor:"$colorTransparent",placeholderTextColor:"$gray9",hoverStyle:{borderColor:"$gray6"},focusStyle:{borderColor:"$gray6",outlineColor:"$gray6",outlineOffset:"2px",outlineWidth:"2px"},value:s,onChange:e=>c(e.currentTarget.value),disabled:l}),(0,n.jsx)(e7,{children:"Input Type"}),(0,n.jsx)(e1.E,{triggerProps:e6,title:"Select type",selectorStyle:{normal:{backgroundColor:"var(--bgPanel)"},hover:{backgroundColor:"var(--bgContent)"}},rowStyle:{normal:{backgroundColor:"var(--bgPanel)"},hover:{backgroundColor:"var(--bgContent)"}},titleStyle:{normal:{backgroundColor:"var(--bgPanel)"}},elements:e5,value:d,setValue:e=>u(e),disabled:l}),(0,n.jsx)(e7,{children:"Default value"}),(0,n.jsx)(eZ.K,{placeholder:"write some default value",height:"300px",bg:"$bgPanel",borderColor:"$colorTransparent",placeholderTextColor:"$gray9",hoverStyle:{borderColor:"$gray6"},focusStyle:{borderColor:"$gray6",outlineColor:"$gray6",outlineOffset:"2px",outlineWidth:"2px"},value:p,onChange:e=>h(e.currentTarget.value),disabled:l})]})]}),(0,n.jsx)(w.FA,{children:(0,n.jsx)(k.zx,{style:{whiteSpace:"nowrap"},h:"fit-content",w:"fit-content",px:"$4",py:"$2",bc:"$bgPanel",hoverStyle:{backgroundColor:"$bgPanel",border:"1px solid var(--gray8)"},focusStyle:{backgroundColor:"$bgPanel",border:"1px solid var(--gray8)"},onPress:()=>{l||(t(),o(a,s,d,p),i(""),c(""),u(""),h(""))},disabled:l,children:"Create input"})})]})})},te=e=>{let{params:t={},setParams:r,links:o,setLinks:l,configParams:a={},setConfigParams:i=e=>{},availableStates:s=[],readOnly:c=!1}=e,[d,u]=(0,F.useState)(null),[p,h]=(0,F.useState)(0),[g,x]=(0,F.useState)(!1),[v,f]=(0,F.useState)(()=>Array.from(new Set([...Object.keys(t),...Object.keys(a)])).map(e=>{var r,n,o,l,i,s,c,d,u;return{rowId:(0,e0.x0)(),paramKey:e,description:null!==(i=t[e])&&void 0!==i?i:"",visible:null===(s=null===(r=a[e])||void 0===r?void 0:r.visible)||void 0===s||s,defaultValue:null!==(c=null===(n=a[e])||void 0===n?void 0:n.defaultValue)&&void 0!==c?c:"",type:null!==(d=null===(o=a[e])||void 0===o?void 0:o.type)&&void 0!==d?d:"string",data:null!==(u=null===(l=a[e])||void 0===l?void 0:l.data)&&void 0!==u?u:[]}}));(0,ei.rf)(()=>{if(c)return;let e={},t={};v.forEach(r=>{let{paramKey:n,description:o,visible:l,defaultValue:i,type:s,data:c}=r;if(!n.trim())return;e[n]=o;let d=a&&a[n]?a[n]:{};t[n]={...d,visible:l,defaultValue:i,type:s,...c&&c.length>0?{data:c}:{}}}),r(e),i(t)},[v,c]);let m=(0,F.useCallback)(()=>{c||x(!0)},[c]),b=(0,F.useCallback)(e=>{c||f(t=>t.filter(t=>t.rowId!==e))},[c]),y=(0,F.useCallback)((e,t)=>{c||f(r=>r.map(r=>r.rowId===e?{...r,paramKey:t}:r))},[c]),j=(0,F.useCallback)((e,t)=>{c||f(r=>r.map(r=>r.rowId===e?{...r,description:t}:r))},[c]),$=(0,F.useCallback)((e,t)=>{c||("string"==typeof t&&(t.startsWith("board.")||t.startsWith("#"))?u(e):u(null),f(r=>r.map(r=>r.rowId===e?{...r,defaultValue:t}:r)))},[c]),C=(0,F.useCallback)(e=>{c||f(t=>t.map(t=>t.rowId===e?{...t,visible:!t.visible}:t))},[c]),A=(0,F.useCallback)((e,t)=>{c||f(r=>r.map(r=>r.rowId===e?{...r,type:t}:r))},[c]);return(0,n.jsxs)(w.FA,{height:"100%",width:"100%",px:"$8",py:"$6",gap:"$8",overflowBlock:"scroll",overflowInline:"hidden",children:[(0,n.jsx)(e9,{show:g,onClose:()=>x(!1),addRow:(e,t,r,n)=>{c||f(o=>[...o,{rowId:(0,e0.x0)(),paramKey:e,description:t,visible:!0,defaultValue:n,type:null!=r?r:"string"}])},readOnly:c}),(0,n.jsxs)(w.FA,{gap:"$5",children:[(0,n.jsxs)(w.sL,{justifyContent:"space-between",ai:"flex-end",children:[(0,n.jsxs)(w.FA,{children:[(0,n.jsx)(S.x,{h:"fit-content",lineHeight:"fit-content",color:"$color",fontSize:"$7",fontWeight:500,children:"Parameters"}),(0,n.jsx)(S.x,{h:"fit-content",lineHeight:"fit-content",color:"$gray9",fontSize:"$5",fontWeight:500,children:"Input parameter for the card execution"})]}),(0,n.jsx)(k.zx,{style:{whiteSpace:"nowrap"},h:"fit-content",w:"fit-content",px:"$4",py:"$2",bc:"$bgPanel",hoverStyle:{backgroundColor:"$bgPanel",border:"1px solid var(--gray8)"},focusStyle:{backgroundColor:"$bgPanel",border:"1px solid var(--gray8)"},onPress:m,disabled:c,children:"Add param"})]}),(0,n.jsx)(w.FA,{gap:"$3",borderRadius:"$3",ai:"flex-end",w:"100%",px:"$3",overflow:"visible",children:v.map(e=>{let{rowId:t,paramKey:r,description:o,visible:l,defaultValue:a,type:i}=e;return(0,n.jsxs)(w.sL,{gap:"$2",alignItems:"center",justifyContent:"center",w:"100%",h:"fit-content",children:[(0,n.jsx)(w.FA,{children:(0,n.jsx)(V.z,{Icon:eK.b,h:"fit-content",IconColor:l?"var(--color10)":"var(--gray9)",onPress:c?void 0:()=>C(t),disabled:c})}),(0,n.jsx)(O.II,{...e8,placeholder:"Param Key",value:r,onChange:e=>y(t,e.target.value),disabled:c}),(0,n.jsx)(O.II,{...e8,placeholder:"Description",value:o,onChange:e=>j(t,e.target.value),disabled:c}),(0,n.jsx)(w.sL,{width:"150px",children:(0,n.jsx)(e1.E,{triggerProps:e6,title:"Select type",selectorStyle:{normal:{backgroundColor:"var(--bgPanel)"},hover:{border:"1px solid var(--gray8)"}},rowStyle:{normal:{backgroundColor:"var(--bgPanel)"},hover:{backgroundColor:"var(--bgContent)"}},titleStyle:{normal:{backgroundColor:"var(--bgPanel)"}},elements:e5,value:null!=i?i:"any",setValue:e=>A(t,e),disabled:c})}),c?(0,n.jsx)(O.II,{...e8,placeholder:"Default Value",bg:"$bgPanel",value:String(null!=a?a:""),pr:"$7",disabled:!0}):(0,n.jsxs)(e2.p,{children:[(0,n.jsxs)(E.J2,{placement:"bottom-start",open:d===t,onOpenChange:e=>{u(e?t:null),h(0)},children:[(0,n.jsxs)(E.J2.Trigger,{disabled:!0,children:[(0,n.jsx)(e2.p.Trigger,{bc:"$backgroundColor",pos:"absolute",r:0,m:"$3",bottom:0,cursor:"pointer",children:(0,n.jsx)(eX.U,{size:20,color:"var(--gray8)"})}),(0,n.jsx)(O.II,{...e8,placeholder:"Default Value",bg:"$bgPanel",value:String(null!=a?a:""),pr:"$7",onChange:e=>$(t,e.target.value),onKeyDown:e=>{d===t&&("ArrowDown"===e.key?(h(e=>Math.min(e+1,s.length-1)),e.preventDefault()):"ArrowUp"===e.key?(h(e=>Math.max(e-1,0)),e.preventDefault()):"Enter"===e.key&&p>=0&&p<s.length&&($(t,"board."+s[p]),u(null),h(0),e.preventDefault()))}})]}),(0,n.jsxs)(E.J2.Content,{ai:"flex-start",miw:"200px",f:1,px:0,w:"100%",bc:"$gray1",py:"$2",gap:"$2",children:[(0,n.jsx)(eu.__,{lineHeight:"$2",pl:"$3",color:"$gray10",children:"States"}),(0,n.jsx)(w.FA,{overflow:"auto",maxHeight:200,f:1,w:"100%",children:s&&s.length>0?s.map((e,r)=>(0,n.jsx)(w.sL,{px:"$3",w:"100%",bc:r===p?"var(--gray5)":"transparent",onHoverIn:e=>e.currentTarget.style.backgroundColor="var(--gray4)",onHoverOut:e=>e.currentTarget.style.backgroundColor="transparent",hoverStyle:{bc:"$gray4"},gap:"$2",alignItems:"center",justifyContent:"space-between",width:"100%",onPress:()=>{$(t,"board."+e),u(null)},children:(0,n.jsx)(eu.__,{maw:300,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:e})},e)):(0,n.jsx)(eu.__,{px:"$3",opacity:.6,children:"No available states"})})]}),(0,n.jsx)(V.z,{ml:"$2",mt:"4px",Icon:eQ.s,onPress:()=>d===t?u(null):u(t)})]}),(0,n.jsx)(e2.p.Editor,{textAreaProps:{bc:"$gray4"},placeholder:r,value:String(null!=a?a:""),readValue:()=>String(null!=a?a:""),onChange:e=>$(t,e)})]},t),(0,n.jsx)(w.FA,{children:(0,n.jsx)(V.z,{Icon:eY.r,IconColor:"var(--red10)",onPress:c?void 0:()=>b(t),disabled:c})})]},t)})})]}),(0,n.jsxs)(w.FA,{gap:"$3",children:[(0,n.jsx)(w.sL,{justifyContent:"space-between",ai:"flex-end",children:(0,n.jsxs)(w.FA,{children:[(0,n.jsx)(S.x,{h:"fit-content",lineHeight:"fit-content",color:"$color",fontSize:"$7",fontWeight:500,children:"Actions before run"}),(0,n.jsx)(S.x,{h:"fit-content",lineHeight:"fit-content",color:"$gray9",fontSize:"$5",fontWeight:500,children:"Link actions to be executed before running the card"})]})}),(0,n.jsx)(w.FA,{borderRadius:"$3",p:"$3",children:(0,n.jsx)(e4,{mode:"pre",links:o,setLinks:l,selectProps:e8,readOnly:c})})]})]})};var tt=r(36293);let tr=e=>{let{cardData:t,setCardData:r,resolvedTheme:o,readOnly:l=!1}=e;return(0,n.jsx)(w.sL,{f:1,gap:"$4",children:(0,n.jsx)(tt.Monaco,{path:"card-".concat(t.name,".ts"),darkMode:"dark"===o,sourceCode:JSON.stringify(t,null,2),onChange:l?void 0:e=>{try{r(JSON.parse(e))}catch(e){console.error("Invalid JSON",e)}},disabled:l,options:{scrollBeyondLastLine:!1,scrollbar:{vertical:"auto",horizontal:"auto"},folding:!1,lineDecorationsWidth:0,lineNumbersMinChars:0,minimap:{enabled:!1},formatOnPaste:!0,formatOnType:!0}})})},tn=e=>{let{htmlCode:t,setHTMLCode:r,data:o,readOnly:l=!1}=e,[a,i]=(0,F.useState)(t);(0,F.useEffect)(()=>{i(t)},[t]);let{resolvedTheme:s}=(0,ex.P)();return(0,n.jsx)(w.FA,{flex:1,height:"100%",alignItems:"center",justifyContent:"center",backgroundColor:"$bgPanel",borderRadius:"$3",p:"$3",children:(0,n.jsx)(tt.Monaco,{path:"html-rules-"+o.name+".ts",darkMode:"dark"===s,sourceCode:t,onChange:l?void 0:e=>{i(e),r(e)},disabled:l,options:{folding:!1,lineDecorationsWidth:0,lineNumbersMinChars:0,lineNumbers:!1,minimap:{enabled:!1}}})})};var to=r(6773);let tl=e=>{let{setHTMLCode:t,cardData:r,readOnly:o=!1}=e,l=(0,eM.tg)("ai.enabled",!1);return(0,n.jsxs)(eW.eh,{direction:"horizontal",children:[(0,n.jsx)(eW.s_,{defaultSize:75,children:(0,n.jsx)(tn,{setHTMLCode:t,htmlCode:r.html,data:{...r,icon:r.icon,color:r.color,name:r.name,params:r.params},readOnly:o})}),(0,n.jsx)(eD.Z,{direction:"vertical"}),l&&!o?(0,n.jsx)(eW.s_,{defaultSize:25,minSize:25,children:(0,n.jsx)(to.n,{setHTMLCode:t,htmlCode:r.html})}):(0,n.jsx)(n.Fragment,{})]})};var ta=r(41771),ti=r(67662);let ts=["orange","yellow","green","blue","purple","pink","red","gray"],tc=[...[11,9,7,5].reduce((e,t)=>(ts.forEach(r=>{e.push("var(--".concat(r).concat(t,")"))}),e),[]),"default"],td=e=>{var t,r;let{card:o,cardData:l,setCardData:a,icons:i,board:s,style:c,readOnly:d=!1}=e,[u,p]=(0,F.useState)(null),[h,g]=(0,F.useState)(""),x=(0,F.useCallback)(function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return void 0===e[t]?r:e[t]},[]),[v]=(0,Q.cY)(),f=[{label:"Keep value permanently",description:"Persiste the value of the card on project restart",key:"persistValue",type:"toggle",section:"General",visible:e=>{let{card:t}=e;return"action"===t.type}},{label:"Autorun on start",description:"Autorun the card on board start",key:"autorun",type:"toggle",section:"General",visible:e=>{let{card:t}=e;return"action"===t.type}},{label:"Always report value",description:"Report the card value on each execution to the board",key:"alwaysReportValue",type:"toggle",section:"General"},{label:"Keep history",description:"Save value changes to history database",key:"keepHistory",type:"toggle",section:"General"},{label:"History retention (days)",description:"Number of days to keep history entries (default 30)",key:"historyRetentionDays",type:"text",section:"General",indent:1,visible:e=>{let{cardData:t}=e;return!!t.keepHistory},get:e=>{var t;return null!==(t=e.historyRetentionDays)&&void 0!==t?t:"30"}},{label:"Natural language rules",description:"Enable natural language rules view",key:"editRulesInNaturalLanguage",type:"toggle",section:"General",get:e=>!1!==e.editRulesInNaturalLanguage},{label:"Low code",description:"Enable low code view",key:"editRulesInLowCode",type:"toggle",section:"General",get:e=>!1!==e.editRulesInLowCode},{label:"Layer",description:"Layer to show the card in",key:"layer",type:"text",section:"General",get:e=>{var t;return null!==(t=e.layer)&&void 0!==t?t:v}},{label:"State Mode",description:"Controls how this card handles state during concurrent execution",key:"stateMode",type:"select",section:"Ephemeral State",visible:e=>{let{card:t}=e;return"action"===t.type},options:[{value:"default",caption:"Default (inherit from board)"},{value:"ephemeral",caption:"Ephemeral (isolated per request)"},{value:"non-ephemeral",caption:"Non-ephemeral (shared state)"}],get:e=>{var t;return null!==(t=e.stateMode)&&void 0!==t?t:"default"}},{label:"Chain Terminator",description:"When enabled, cleans up the ephemeral context after this action completes",key:"chainTerminator",type:"toggle",section:"Ephemeral State",visible:e=>{let{card:t}=e;return"action"===t.type}},{label:"Display title",description:"Show name of the card as title",key:"displayTitle",type:"toggle",section:"Display",get:e=>!1!==e.displayTitle},{label:"Display icon",description:"Show the card icon",key:"displayIcon",type:"toggle",section:"Display",get:e=>!1!==e.displayIcon},{label:"Display frame",description:"Show a background frame to the card content",key:"displayFrame",type:"toggle",section:"Display",get:e=>!1!==e.displayFrame},{label:"Markdown display",description:"Show the card output as formatted markdown",key:"markdownDisplay",type:"toggle",section:"Display"},{label:"Html display",description:"Show the card output as formatted html",key:"htmlDisplay",type:"toggle",section:"Display"},{label:"Display value",description:"Show the card output value on the card",key:"displayResponse",type:"toggle",section:"Display",get:e=>!1!==e.displayResponse,visible:e=>{let{card:t}=e;return"action"===t.type}},{label:"Display button",description:"Show the card execution button",key:"displayButton",type:"toggle",section:"Display",get:e=>!1!==e.displayButton,visible:e=>{let{card:t}=e;return"action"===t.type}},{label:"Button text",description:"Displayed text on the execution button",key:"buttonLabel",type:"text",section:"Display",visible:e=>{let{card:t,cardData:r}=e;return"action"===t.type&&!!x(r,"displayButton",!0)}},{label:"Button Full",description:"Grow the button size to fill the card size",key:"buttonMode",type:"toggle",section:"Display",visible:e=>{let{card:t,cardData:r}=e;return"action"===t.type&&!!x(r,"displayButton",!0)},get:e=>"full"===e.buttonMode,set:(e,t)=>{if(t)return{...e,buttonMode:"full"};let{buttonMode:r,...n}=e;return n}},{label:"Display button icon",description:"Show the card icon on the execution button",key:"displayButtonIcon",type:"toggle",section:"Display",visible:e=>{let{card:t,cardData:r}=e;return"action"===t.type&&!!x(r,"displayButton",!0)},get:e=>!0===e.displayButtonIcon,set:(e,t)=>({...e,displayButtonIcon:!!t})},{label:"Auto Minimize",description:"Enable card auto minimize to show in reduced space boards",key:"autoResponsive",type:"toggle",section:"Display",get:e=>!1!==e.autoResponsive},{label:"API access",description:"Allow access to this card through the API.",key:"apiAccess",type:"toggle",section:"Paths and Permissions",get:e=>{var t;return Object.keys(null!==(t=e.tokens)&&void 0!==t?t:{}).length>0},set:(e,t)=>{if(t)return{...e,tokens:{read:(0,ev.Z)(),run:(0,ev.Z)()}};let{tokens:r,...n}=e;return n}},{label:"User access",key:"userAccess",type:"toggle",section:"Paths and Permissions"},{label:"Admin access",key:"adminAccess",type:"toggle",section:"Paths and Permissions"},{label:"Allow public read",description:"Allow the read of the card content outside board",key:"publicRead",type:"toggle",section:"Paths and Permissions"},{label:"Card read path",description:"Path to read the content of the card outside the board. This setting requires <Allow public read> to be enabled.",key:"enableCustomPath",type:"toggle",section:"Paths and Permissions"},{label:"Path to card",key:"customPath",type:"text",section:"Paths and Permissions",indent:1,visible:e=>{let{cardData:t}=e;return!!t.enableCustomPath},get:e=>{var t;return null!==(t=e.customPath)&&void 0!==t?t:"/workspace/cards/".concat(e.name)}},{label:"Card page path",description:"Path of the card content page. This setting requires <Allow public read> to be enabled.",key:"customCardViewPath",type:"text",placeholder:"Path to card (Ex: /card)",section:"Paths and Permissions"},..."action"===l.type?[{label:"Event Trigger",description:"event path triggering this action",key:"eventPath",type:"text",placeholder:"Event path trigger (Ex: auth/login/done)",section:"Paths and Permissions"},{label:"Default Input",description:"The default input name for this action. Used by Event Trigger and similar triggers to know the name of the input to put the event payload into.",key:"defaultInput",type:"text",placeholder:"Default input name",section:"Paths and Permissions"},{label:"Allow public run",key:"publicRun",type:"toggle",section:"Paths and Permissions"},{label:"Custom run path",key:"enableCustomRunPath",type:"toggle",section:"Paths and Permissions"},{label:"Path to card run",key:"customRunPath",type:"text",section:"Paths and Permissions",indent:1,visible:e=>{let{cardData:t}=e;return!!t.enableCustomRunPath},get:e=>{var t;return null!==(t=e.customRunPath)&&void 0!==t?t:"/workspace/cards/".concat(e.name,"/run")}},{label:"Run Card Page Path",key:"customCardRunViewPath",type:"text",placeholder:"Path to card run (Ex: /card/run)",section:"Paths and Permissions"},{label:"Request approval",description:"Require user approval before executing this action",key:"requestApproval",type:"toggle",section:"Paths and Permissions",visible:e=>{let{card:t}=e;return"action"===t.type}},{label:"Approval message",description:"Custom message shown when requesting approval",key:"approvalMessage",type:"text",section:"Paths and Permissions",indent:1,visible:e=>{let{card:t,cardData:r}=e;return"action"===t.type&&!((null==r?void 0:r.requestApproval)!==!0)},placeholder:"Explain what this action will do"}]:[]],m=(0,F.useMemo)(()=>{let e={},t={card:o,cardData:l};for(let r of f)(!r.visible||r.visible(t))&&(e[r.section]||(e[r.section]=[]),e[r.section].push(r));return e},[f,o,l]),b=e=>{var t,r,i;let s={type:e.type,label:e.label,description:e.description,value:"checkbox"===e.type||"toggle"===e.type?e.get?!!e.get(l,o):x(l,e.key):e.get?e.get(l,o):null!==(i=null==l?void 0:l[e.key])&&void 0!==i?i:"",onChange:t=>{d||(e.set?a(e.set(l,t)):a({...l,[e.key]:t}))},disabled:d,..."select"===e.type&&{options:(null!==(t=e.options)&&void 0!==t?t:[]).map(e=>({value:e.value,label:e.caption}))},..."text"===e.type&&{placeholder:null!==(r=e.placeholder)&&void 0!==r?r:e.label}};return e.indent?(0,n.jsx)(w.FA,{ml:"$".concat(4*e.indent),children:(0,n.jsx)(ti.p,{...s})},e.key):(0,n.jsx)(ti.p,{...s},e.key)};return(0,n.jsxs)(w.sL,{f:1,gap:"$6",style:c,children:[(0,n.jsxs)(w.FA,{py:"$6",pl:"$5",gap:"$4",children:[(0,n.jsx)(ti.p,{label:"Icon",control:(0,n.jsx)(w.FA,{minWidth:280,children:(0,n.jsx)(eg.xG,{br:"8px",inputProps:{backgroundColor:"$bgPanel",borderColor:u?"$red9":"$gray6"},icons:i,onSelect:e=>a({...l,icon:e}),selected:l.icon,disabled:d})}),noDivider:!0}),(0,n.jsx)(ti.p,{label:"Main Color",control:(0,n.jsx)(w.FA,{minWidth:280,children:(0,n.jsx)(ta.S,{br:"8px",color:null!==(t=l.color)&&void 0!==t?t:"",mode:"custom",presetColors:tc,popoverProps:{width:"325px"},placeholder:"#F7B500 or var(--yellow9)",onChange:e=>{d||("default"===e?delete l.color:l.color=e,a({...l}))},inputProps:{backgroundColor:"$bgPanel",borderColor:u?"$red9":"$gray6",onChange:e=>{d||a({...l,color:e.target.value})}},disabled:d})}),noDivider:!0}),!1!==l.displayFrame&&(0,n.jsx)(ti.p,{label:"Background Color",control:(0,n.jsx)(w.FA,{minWidth:280,children:(0,n.jsx)(ta.S,{br:"8px",color:null!==(r=l.bgColor)&&void 0!==r?r:"",mode:"custom",placeholder:"#F7B500 or var(--yellow9)",presetColors:tc,popoverProps:{width:"325px"},onChange:e=>{d||("default"===e?delete l.bgColor:l.bgColor=e,a({...l}))},inputProps:{backgroundColor:"$bgPanel",borderColor:u?"$red9":"$gray6",onChange:e=>{d||a({...l,bgColor:e.target.value})}},disabled:d})}),noDivider:!0})]}),(0,n.jsxs)(w.FA,{pb:"$7",pr:"$5",overflow:"auto",overflowBlock:"scroll",flex:1,children:[(0,n.jsx)(w.FA,{pos:"sticky",top:"0px",left:"0px",zIndex:20,pt:"$6",px:"$3",children:(0,n.jsx)(O.II,{zi:1,br:"8px",value:h,fontSize:"$5",placeholderTextColor:"$gray8",disabled:d,style:{backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",background:"color-mix(in srgb, var(--bgPanel) 50%, transparent)"},boc:"$gray6",color:u?"$red9":void 0,onChangeText:e=>{g(e)},placeholder:"Search for a setting"})}),(0,n.jsx)(w.FA,{display:"grid",pt:"$3",gap:"$2",style:{gridTemplateColumns:"1fr 1fr"},children:Object.entries(m).map(e=>{var t;let[r,o]=e,l=h.toLowerCase(),a=null!==(t=o.filter(e=>{var t,r,n,o;return(null==e?void 0:null===(r=e.label)||void 0===r?void 0:null===(t=r.toLocaleLowerCase())||void 0===t?void 0:t.includes(l))||(null==e?void 0:null===(o=e.description)||void 0===o?void 0:null===(n=o.toLocaleLowerCase())||void 0===n?void 0:n.includes(l))}))&&void 0!==t?t:[];return(0,n.jsx)(n.Fragment,{children:a.length?(0,n.jsx)(w.FA,{gridColumn:"1 / -1",$gtMd:{gridColumn:"1 / -1"},children:(0,n.jsx)(ti.j,{title:r,children:a.map(b)})},r):(0,n.jsx)(n.Fragment,{})})})})]})]})};var tu=r(63771);let tp=["auto","number","string","json","array"],th=e=>{let{card:t,setCardData:r,links:o,setLinks:l,readOnly:a=!1}=e,[i,s]=(0,F.useState)(t.returnType),[c,d]=(0,F.useState)(!0),u="$gray6",p="$bgContent";return(0,F.useEffect)(()=>{a||("auto"===i?d(!0):d(!1),r(e=>({...e,returnType:i})))},[i,a]),(0,n.jsxs)(w.FA,{gap:"$3",f:1,w:"100%",children:[(0,n.jsxs)(w.FA,{bc:"$bgPanel",p:"$3",borderRadius:"$4",children:[(0,n.jsxs)(w.FA,{pb:"$3",children:[(0,n.jsx)(eu.__,{pl:"$2",children:"Return Type"}),(0,n.jsx)(w.sL,{gap:"$2",flexWrap:"wrap",children:tp.map(e=>(0,n.jsx)(k.zx,{size:"$3",bc:e===i?"$color3":p,borderColor:e===i?"$color6":u,color:e===i?"$color8":"$color",borderWidth:"1px",br:"$3",fontSize:"$5",onPress:a?void 0:()=>s(e),disabled:a,children:e}))})]}),(0,n.jsxs)(w.FA,{gap:"$3",children:[(0,n.jsxs)(w.sL,{gap:"$3",jc:"flex-start",ai:"center",children:[(0,n.jsx)(_.XZ,{w:"$2",h:"$2",bc:p,boc:u,focusStyle:{outlineWidth:0},checked:t.enableReturnCustomFallback,onCheckedChange:a?void 0:e=>r(t=>({...t,enableReturnCustomFallback:e})),disabled:a,children:(0,n.jsx)(_.XZ.Indicator,{children:(0,n.jsx)(K.J,{size:16,color:"var(--color8)"})})}),(0,n.jsx)(eu.__,{children:"Enable Custom Fallback"})]}),!c&&t.enableReturnCustomFallback&&(0,n.jsx)(eZ.K,{h:"100%",value:t.fallbackValue,bc:p,placeholderTextColor:"$gray10",borderColor:u,placeholder:"Define which should be the return type of the card execution",onChangeText:a?void 0:e=>r(t=>({...t,fallbackValue:e})),disabled:a})]})]}),(0,n.jsxs)(w.FA,{bc:"$bgPanel",p:"$3",borderRadius:"$4",children:[(0,n.jsx)(eu.__,{pl:"$2",children:"Actions after run"}),(0,n.jsx)(e4,{mode:"post",links:o,setLinks:l,selectProps:{backgroundColor:"var(--bgContent)",borderColor:u,placeholderTextColor:"$gray10"},readOnly:a})]})]})};var tg=r(33927),tx=r(20577),tv=r(44611),tf=r(31193),tm=r(4065),tb=r(86353),ty=r(11634),tj=r(16721),t$=r(92826);let tw=[{key:"1min",label:"1 min",ms:6e4},{key:"1h",label:"1 hour",ms:36e5},{key:"1d",label:"1 day",ms:864e5},{key:"1w",label:"1 week",ms:6048e5},{key:"1m",label:"1 month",ms:2592e6},{key:"1y",label:"1 year",ms:31536e6}],tC=(e,t)=>{let r=new Date(e);switch(t){case"1min":case"1h":return r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"});case"1d":return r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});case"1w":case"1m":return r.toLocaleDateString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});case"1y":return r.toLocaleDateString([],{month:"short",day:"numeric"});default:return r.toLocaleString()}},tS=e=>new Date(e).toLocaleString(),tk=e=>{if("number"==typeof e)return!0;if("string"==typeof e){let t=parseFloat(e);return!isNaN(t)&&isFinite(t)}return!1},tA=e=>"number"==typeof e?e:parseFloat(e),tP=e=>null==e?"null":"object"==typeof e?JSON.stringify(e,null,2):String(e),tI=e=>{let{data:t,range:r}=e,{resolvedTheme:o}=(0,ex.P)(),l="dark"===o;return 0===t.length?(0,n.jsx)(w.FA,{f:1,ai:"center",jc:"center",p:"$4",children:(0,n.jsx)(S.x,{color:"$gray10",children:"No history data available for this time range"})}):(0,n.jsx)(D.p,{f:1,children:(0,n.jsx)(w.FA,{gap:"$2",p:"$3",children:t.map((e,t)=>(0,n.jsxs)(w.sL,{gap:"$3",p:"$3",borderRadius:"$3",backgroundColor:l?"$gray3":"$gray2",borderLeftWidth:3,borderLeftColor:"$color8",children:[(0,n.jsx)(w.FA,{minWidth:140,children:(0,n.jsx)(S.x,{fontSize:"$2",color:"$gray11",fontFamily:"$mono",children:tS(e.created_at)})}),(0,n.jsx)(w.FA,{f:1,children:(0,n.jsx)(S.x,{fontSize:"$3",color:"$color",fontFamily:"object"==typeof e.value?"$mono":void 0,style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:tP(e.value)})})]},e.id))})})},tz=e=>{let{boardId:t,cardId:r,cardName:o}=e,[l,a]=(0,F.useState)("1h"),[i,s]=(0,F.useState)("line"),[c,d]=(0,F.useState)([]),[u,p]=(0,F.useState)(!0),[h,g]=(0,F.useState)(null),x=async()=>{p(!0),g(null);try{var e,n;let o=tw.find(e=>e.key===l),a=Date.now()-(null!==(n=null==o?void 0:o.ms)&&void 0!==n?n:36e5),i=await f.API.get("/api/core/v1/boards/".concat(t,"/cards/").concat(encodeURIComponent(r),"/history?from=").concat(a));if(null===(e=i.data)||void 0===e?void 0:e.history){let e=[...i.data.history].sort((e,t)=>e.created_at-t.created_at);d(e)}else d([])}catch(e){console.error("Error fetching history:",e),g(e.message||"Failed to fetch history"),d([])}finally{p(!1)}};(0,F.useEffect)(()=>{x();let e=setInterval(x,3e4);return()=>clearInterval(e)},[t,r,l]);let v=(0,F.useMemo)(()=>0!==c.length&&c.every(e=>tk(e.value)),[c]),m=(0,F.useMemo)(()=>v?c.map(e=>({time:tC(e.created_at,l),value:tA(e.value)})):[],[c,v,l]),b=(0,F.useMemo)(()=>[...c].reverse(),[c]);return(0,n.jsxs)(w.FA,{f:1,gap:"$3",width:"100%",children:[(0,n.jsxs)(w.sL,{gap:"$2",flexWrap:"wrap",ai:"center",jc:"space-between",width:"100%",children:[(0,n.jsx)(w.sL,{gap:"$2",flexWrap:"wrap",children:tw.map(e=>(0,n.jsx)(k.zx,{size:"$2",backgroundColor:l===e.key?"$color8":"$gray4",color:l===e.key?"white":"$color",borderRadius:"$2",onPress:()=>a(e.key),pressStyle:{opacity:.8},children:e.label},e.key))}),v&&(0,n.jsxs)(w.sL,{gap:"$2",children:[(0,n.jsx)(k.zx,{size:"$2",backgroundColor:"line"===i?"$color8":"$gray4",color:"line"===i?"white":"$color",borderRadius:"$2",onPress:()=>s("line"),pressStyle:{opacity:.8},children:"Line"}),(0,n.jsx)(k.zx,{size:"$2",backgroundColor:"area"===i?"$color8":"$gray4",color:"area"===i?"white":"$color",borderRadius:"$2",onPress:()=>s("area"),pressStyle:{opacity:.8},children:"Area"})]})]}),(0,n.jsx)(w.FA,{f:1,width:"100%",backgroundColor:"$bgPanel",borderRadius:"$3",overflow:"hidden",children:u?(0,n.jsxs)(w.FA,{f:1,ai:"center",jc:"center",p:"$4",children:[(0,n.jsx)($.$,{size:"large",color:"$color8"}),(0,n.jsx)(S.x,{color:"$gray10",mt:"$2",children:"Loading history..."})]}):h?(0,n.jsxs)(w.FA,{f:1,ai:"center",jc:"center",p:"$4",children:[(0,n.jsx)(S.x,{color:"$red10",children:h}),(0,n.jsx)(k.zx,{mt:"$3",onPress:x,children:"Retry"})]}):0===c.length?(0,n.jsxs)(w.FA,{f:1,ai:"center",jc:"center",p:"$4",children:[(0,n.jsx)(S.x,{color:"$gray10",children:"No history data available"}),(0,n.jsx)(S.x,{color:"$gray9",fontSize:"$2",mt:"$2",children:"History will appear here when the card value changes"})]}):v?(0,n.jsxs)(w.FA,{f:1,p:"$3",minHeight:300,width:"100%",children:[(0,n.jsx)(w.FA,{f:1,width:"100%",children:(0,n.jsx)(tg.h,{width:"100%",height:"100%",children:"line"===i?(0,n.jsxs)(tx.w,{data:m,children:[(0,n.jsx)(tv.q,{strokeDasharray:"3 3",stroke:"var(--gray6)"}),(0,n.jsx)(tf.K,{dataKey:"time",stroke:"var(--gray9)",fontSize:12,tickLine:!1}),(0,n.jsx)(tm.B,{stroke:"var(--gray9)",fontSize:12,tickLine:!1}),(0,n.jsx)(tb.u,{contentStyle:{backgroundColor:"var(--background)",border:"1px solid var(--gray6)",borderRadius:8}}),(0,n.jsx)(ty.x,{type:"monotone",dataKey:"value",stroke:"var(--color8)",strokeWidth:2,dot:{fill:"var(--color8)",strokeWidth:0,r:4},activeDot:{r:6,fill:"var(--color8)"},isAnimationActive:!1})]}):(0,n.jsxs)(tj.T,{data:m,children:[(0,n.jsx)(tv.q,{strokeDasharray:"3 3",stroke:"var(--gray6)"}),(0,n.jsx)(tf.K,{dataKey:"time",stroke:"var(--gray9)",fontSize:12,tickLine:!1}),(0,n.jsx)(tm.B,{stroke:"var(--gray9)",fontSize:12,tickLine:!1}),(0,n.jsx)(tb.u,{contentStyle:{backgroundColor:"var(--background)",border:"1px solid var(--gray6)",borderRadius:8}}),(0,n.jsx)(t$.u,{type:"monotone",dataKey:"value",stroke:"var(--color8)",fill:"var(--color8)",fillOpacity:.3,strokeWidth:2,isAnimationActive:!1})]})})}),(0,n.jsxs)(S.x,{color:"$gray9",fontSize:"$2",ta:"center",mt:"$2",children:[c.length," data points"]})]}):(0,n.jsx)(tI,{data:b,range:l})})]})},tL=e=>{let{children:t,...r}=e;return(0,n.jsx)(w.FA,{w:"100%",h:"100%",gap:"$5",px:"$3",py:"$2",flex:1,jc:"flex-start",ai:"flex-start",...r,children:t})},tR=["params","rules","output","history"],tF=[{id:"config",label:"Settings",icon:a.Z},{id:"view",label:"View",icon:eR.E},{id:"raw",label:"Raw JSON",icon:ez.z}],tT=e=>{var t,r,o,l;let{board:i,actions:s,states:c,card:d,icons:u,onEdit:p=e=>{},onSave:h=()=>{},onClose:g=()=>{},errors:x,mode:v="edit",tab:f="rules",readOnly:m=!1}=e,[b,y]=(0,F.useState)(d),j=(0,F.useRef)(null!==(o=null==d?void 0:d.name)&&void 0!==o?o:null),[k,A]=(0,F.useState)(!1),[P,I]=(0,F.useState)(!1),z="create"===v,[L,R]=(0,F.useState)(z?"config":f),[T,_]=(0,F.useState)(!1),{resolvedTheme:W}=(0,ex.P)();(0,ei.rf)(()=>{if(m)return;let e={...b},t=j.current;!z&&t&&(null==e?void 0:e.name)&&e.name!==t?e.previousName=t:delete e.previousName,p(e)},[b]);let D=[{id:"info",label:"",icon:(0,n.jsx)(G.k,{size:"$1"}),content:(0,n.jsx)(tL,{px:"$4",py:"$4",children:(0,n.jsx)(eW.eh,{direction:"horizontal",children:(0,n.jsx)(eW.s_,{defaultSize:50,children:(0,n.jsx)(w.FA,{flex:1,height:"100%",backgroundColor:"$bgPanel",borderRadius:"$3",p:"$3",children:(0,n.jsx)(ef.Markdown,{autoSaveOnBlur:!0,editOnDoubleClick:!0,data:b.description,setData:e=>{y({...b,description:e})}})})})})})},{id:"params",label:"Inputs",icon:(0,n.jsx)(eT.N,{size:"$1"}),content:(0,n.jsx)(tL,{px:"0px",py:"0px",children:(0,n.jsx)(te,{params:b.params||{},setParams:e=>{y(t=>({...t,params:e}))},links:b.links||[],setLinks:e=>{y(t=>({...t,links:e}))},configParams:b.configParams||{},setConfigParams:e=>{y(t=>({...t,configParams:e}))},availableStates:(function e(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(null===t||"object"!=typeof t)return r?[r]:[];let o=[];if(n&&r&&o.push(r),Array.isArray(t)){if(0===t.length)return n&&r?[r]:[];for(let l=0;l<t.length;l++){let a=r?"".concat(r,"[").concat(l,"]"):"[".concat(l,"]");o=o.concat(e(t[l],a,n))}return o}let l=Object.keys(t);if(0===l.length)return n&&r?[r]:[];for(let a of l){let l=r?"".concat(r,".").concat(a):a;o=o.concat(e(t[a],l,n))}return o})(null!==(l=null==c?void 0:null===(t=c.boards)||void 0===t?void 0:t[i.name])&&void 0!==l?l:{}).filter(e=>e!==b.name),readOnly:m})})},{id:"rules",label:"Rules",icon:(0,n.jsx)(eL.l,{size:"$1"}),content:(0,n.jsx)(tL,{px:"$4",py:"$4",children:(0,n.jsx)(eJ,{board:i,extraCompilerData:{userParams:b.params,actions:null==s?void 0:null===(r=s.boards)||void 0===r?void 0:r[i.name]},onCodeChange:()=>"rules processed",actions:s.boards||{},compiler:"value"==b.type?"getValueCode":"getActionCode",states:(null==c?void 0:c.boards)||{},cardData:b,setCardData:y,readOnly:m})})},{id:"output",label:"Output",icon:(0,n.jsx)(eE.G,{size:"$1"}),content:(0,n.jsx)(tL,{px:"$4",py:"$4",children:(0,n.jsx)(th,{card:b,setCardData:y,links:b.links||[],setLinks:e=>{y(t=>({...t,links:e}))},readOnly:m})})},...b.keepHistory?[{id:"history",label:"History",icon:(0,n.jsx)(e_.A,{size:"$1"}),content:(0,n.jsx)(tL,{px:"$4",py:"$4",children:(0,n.jsx)(tz,{boardId:i.name,cardId:b.key||b.name,cardName:b.name})})}]:[],{id:"config",label:"Settings",icon:(0,n.jsx)(a.Z,{size:"$1"}),content:(0,n.jsx)(tL,{px:"0px",py:"0px",children:(0,n.jsx)(td,{style:{width:"100%",height:"fit-content"},board:i,icons:u,card:d,cardData:b,setCardData:y,readOnly:m})})},{id:"view",label:"View",icon:(0,n.jsx)(eR.E,{size:"$1"}),content:(0,n.jsx)(tL,{px:"$4",py:"$4",children:(0,n.jsx)(tl,{cardData:b,setHTMLCode:e=>{y({...b,html:e})},readOnly:m})})},{id:"raw",label:"Raw",icon:(0,n.jsx)(ez.z,{size:"$1"}),content:(0,n.jsx)(tr,{cardData:b,setCardData:y,resolvedTheme:W,readOnly:m})}],M=D.filter(e=>tR.includes(e.id)),N=tF.some(e=>e.id===L),V=async()=>{if(!m&&!P){I(!0);try{await h()}catch(e){console.error("Error saving:",e)}finally{I(!1)}}};return(0,ei.rf)(()=>{y(d)},[d]),(0,ei.rf)(()=>{A(JSON.stringify(b)!==JSON.stringify(d))},[b,d]),D.find(e=>e.id===L),(0,n.jsxs)(w.FA,{f:1,className:m?"card-settings-readonly":void 0,children:[m&&(0,n.jsx)("style",{children:'\n          .card-settings-readonly .card-settings-content input,\n          .card-settings-readonly .card-settings-content textarea,\n          .card-settings-readonly .card-settings-content select,\n          .card-settings-readonly .card-settings-content button,\n          .card-settings-readonly .card-settings-content [role="button"],\n          .card-settings-readonly .card-settings-content [role="switch"],\n          .card-settings-readonly .card-settings-content [role="checkbox"],\n          .card-settings-readonly .card-settings-content [role="radio"],\n          .card-settings-readonly .card-settings-content [role="slider"],\n          .card-settings-readonly .card-settings-content [role="combobox"],\n          .card-settings-readonly .card-settings-content [contenteditable="true"],\n          .card-settings-readonly .card-settings-content [data-clickable="true"] {\n            pointer-events: none !important;\n          }\n        '}),(0,n.jsx)(Y.I,{children:(0,n.jsxs)(w.FA,{f:1,children:[(0,n.jsxs)(w.sL,{borderBottomColor:"$gray6",borderBottomWidth:"1px",ai:"center",px:"$3",py:"$1",position:"relative",children:[(0,n.jsx)(w.sL,{position:"absolute",left:0,right:0,top:0,bottom:0,ai:"center",jc:"center",zIndex:0,children:(0,n.jsx)(tu.n,{tabs:M.filter(e=>{var t,r;return null===(r=b.editorOptions)||void 0===r||null===(t=r.hiddenTabs)||void 0===t||!t.includes(e.id)}),selectedId:tR.includes(L)?L:null,onSelect:e=>R(e),borderBottomColor:"transparent"})}),!z&&(0,n.jsxs)(w.sL,{ai:"center",gap:"$2",zIndex:1,children:[(0,n.jsx)(w.sL,{padding:"$2",borderRadius:"$2",cursor:"pointer",backgroundColor:"info"===L?"$color5":"transparent",hoverStyle:{backgroundColor:"info"===L?"$color5":"$gray4"},onPress:()=>R("info"===L?"rules":"info"),children:(0,n.jsx)(G.k,{size:18,color:"info"===L?"var(--color)":"var(--gray9)"})}),(0,n.jsx)(O.II,{fontSize:"$5",fontWeight:"600",color:"$gray11",maxWidth:"200px",value:b.name,placeholder:"Card name",borderWidth:0,backgroundColor:"$bgPanel",focusStyle:{borderWidth:0,outlineWidth:0},hoverStyle:{backgroundColor:"$gray3"},paddingHorizontal:"$2",paddingVertical:"$1",height:"30px",autoFocus:!1,tabIndex:-1,borderRadius:"$2",disabled:m,onChangeText:e=>{/^[a-zA-Z0-9-_ ]*$/.test(e)&&y({...b,name:e})}})]}),(0,n.jsx)(w.sL,{flex:1}),!z&&(0,n.jsxs)(w.sL,{ai:"center",gap:"$2",zIndex:1,children:[m&&(0,n.jsx)(w.sL,{ai:"center",px:"$2",py:"$1",br:"$3",backgroundColor:"$gray3",children:(0,n.jsx)(S.x,{color:"$gray11",fontSize:"$3",fontWeight:"600",children:"Read-only"})}),(0,n.jsxs)(E.J2,{placement:"bottom-end",open:T,onOpenChange:_,children:[(0,n.jsx)(E.J2.Trigger,{asChild:!0,children:(0,n.jsx)(w.sL,{padding:"$2",borderRadius:"$2",cursor:"pointer",backgroundColor:N?"$color5":"transparent",hoverStyle:{backgroundColor:N?"$color5":"$gray4"},children:(0,n.jsx)(a.Z,{size:18,color:N?"var(--color)":"var(--gray9)"})})}),(0,n.jsx)(E.J2.Content,{backgroundColor:"var(--bgPanel)",borderColor:"$gray6",borderWidth:1,borderRadius:"$3",padding:"$2",elevate:!0,animation:"quick",enterStyle:{opacity:0,scale:.95},exitStyle:{opacity:0,scale:.95},children:(0,n.jsx)(w.FA,{gap:"$1",minWidth:150,children:tF.map((e,t)=>{let r=e.icon;return(0,n.jsx)(w.FA,{children:(0,n.jsxs)(w.sL,{padding:"$2",paddingHorizontal:"$3",borderRadius:"$2",cursor:"pointer",hoverStyle:{opacity:.8},backgroundColor:L===e.id?"$bgContent":"transparent",onPress:()=>{R(e.id),_(!1)},ai:"center",gap:"$2",children:[(0,n.jsx)(r,{size:16,color:"var(--gray11)"}),(0,n.jsx)(S.x,{color:"$gray11",fontSize:"$4",children:e.label})]})},e.id)})})})]}),(0,n.jsx)(w.sL,{ai:"center",gap:"$2",p:"$1",children:(0,n.jsx)(w.sL,{cursor:m||!k||P?"default":"pointer",padding:"$2",borderRadius:"$2",width:"32px",height:"32px",hoverStyle:m||!k||P?{}:{backgroundColor:"$gray4"},onPress:m||!k||P?void 0:V,pressStyle:{opacity:.8},children:P?(0,n.jsx)($.$,{size:"small",color:"var(--color8)"}):(0,n.jsx)(eF.v,{size:18,color:!m&&k?"var(--color8)":"var(--gray7)"})})})]})]}),(0,n.jsx)(Y.I,{children:D.map(e=>(0,n.jsx)(w.FA,{className:"card-settings-content",display:e.id===L?"flex":"none",f:1,gap:"$4",children:e.content||(0,n.jsx)(w.FA,{f:1,ai:"center",jc:"center",children:(0,n.jsx)(S.x,{color:"$gray11",children:"No content available for this tab"})})},e.id))})]})}),(null==x?void 0:x.length)>0?(0,n.jsx)(w.FA,{children:x.map((e,t)=>(0,n.jsx)(C.n,{color:"$red9",fontSize:"$4",children:e},"err"+t))}):(0,n.jsx)(n.Fragment,{})]})};var tE=r(33944),t_=r(36265),tW=r(33943),tO=r(68491),tD=r(53601),tM=r(43850),tN=r(25237),tV=r.n(tN),tH=r(80998),tB=r(75434),tG=r(87349),tU=r(55951),tq=r(60627),tJ=r(4852),tZ=r(46475),tK=r(26605);let tY=e=>{let{visible:t,onChangeTab:r,selectedTab:o,tabs:l,side:a="right",onToggleSide:s,leftAnchorSelector:c,leftAnchorGap:d}=e,u=(0,F.useRef)(null),p=(0,F.useRef)(null),{resolvedTheme:h}=(0,ex.P)(),[g,x]=(0,F.useState)(1010),[v,f]=(0,F.useState)(!1),m=1010===g,b="left"===a,[y,j]=(0,F.useState)(null),[$,C]=(0,F.useState)(!1);(0,F.useLayoutEffect)(()=>{if(!b){C(!0);return}let e=c?document.querySelector(c):null;p.current=e||null,p.current?j(p.current.getBoundingClientRect().width):j(0),C(!0)},[b,c]),(0,F.useEffect)(()=>{if(!b||!p.current)return;let e=p.current,t=new ResizeObserver(e=>{for(let t of e){let e=t.contentRect;requestAnimationFrame(()=>j(e.width))}});return t.observe(e),()=>t.disconnect()},[b]),(0,F.useEffect)(()=>{if(!b)return;let e=()=>{let e=p.current;e&&j(e.getBoundingClientRect().width)},t=()=>requestAnimationFrame(e);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[b]);let S={pointerEvents:"none",width:"100vw",height:"120vh",position:"fixed",...b?{left:t?0:"-100vw"}:{right:t?0:"-100vw"}},[k]=(0,X.KO)(tK.Ux),A=window.innerWidth-64-k,P=v?{...b?{left:t?64:"-100vw"}:{right:t?k:"-100vw"},top:"0px",width:A,height:"calc(100vh)"}:{...b?{left:t?(null!=y?y:0)+d:-g}:{right:t?25+k:-g},top:"25px",width:g,height:"calc(100vh - 100px)"};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{ref:u,onClick:()=>{},style:S}),(0,n.jsxs)(w.FA,{pointerEvents:"auto",position:"fixed",animation:"quick",...P,backgroundColor:"var(--bgContent)",borderWidth:2,br:"$5",elevation:60,shadowOpacity:.2,shadowColor:"black",bw:1,boc:"$gray6",overflow:"hidden",gap:"2px",children:[(0,n.jsxs)(w.sL,{borderBottomColor:"$gray6",borderBottomWidth:"1px",children:[(0,n.jsxs)(w.sL,{ai:"center",gap:"$3",p:"$2.5",px:"$3",children:[(0,n.jsx)(w.sL,{cursor:"pointer",onPress:()=>{r(""),f(!1)},pressStyle:{opacity:.8},hoverStyle:{scale:1.05},children:(0,n.jsx)(i.X,{size:18,color:"var(--color)"})}),(0,n.jsx)(e3.w,{label:"right"===a?"Move panel to left":"Move panel to right",delay:{open:200,close:0},restMs:0,children:(0,n.jsx)(w.sL,{cursor:"pointer",onPress:()=>null==s?void 0:s(),pressStyle:{opacity:.8},hoverStyle:{scale:1.05},children:"right"===a?(0,n.jsx)(tJ.a,{size:18,color:"var(--color)"}):(0,n.jsx)(tZ.X,{size:18,color:"var(--color)"})})}),!v&&(0,n.jsx)(w.sL,{cursor:"pointer",onPress:()=>{x(e=>{let t=window.innerWidth-330-k;return 1010===e?t:1010})},pressStyle:{opacity:.8},hoverStyle:{scale:1.05},children:m?(0,n.jsx)(eX.U,{size:18,color:"var(--color)"}):(0,n.jsx)(tG.G,{size:18,color:"var(--color)"})}),(0,n.jsx)(w.sL,{cursor:"pointer",onPress:()=>f(!v),pressStyle:{opacity:.8},hoverStyle:{scale:1.05},children:v?(0,n.jsx)(tq.h,{size:18,color:"var(--color)"}):(0,n.jsx)(tU.M,{size:18,color:"var(--color)"})})]}),(0,n.jsx)(w.FA,{borderRightWidth:"1px",borderRightColor:"$gray6"}),(0,n.jsx)(tu.n,{tabs:l,selectedId:o,onSelect:r})]}),(0,n.jsx)(w.sL,{flex:1,children:l&&Object.keys(l).map(e=>{let t=l[e];return(0,n.jsx)(w.FA,{f:1,display:o===e?"flex":"none",children:t.content},e)})})]})]})};var tX=r(62186),tQ=r(57494),t0=r(12094),t1=r(45297),t2=r(72948),t3=r(39097),t4=r.n(t3),t5=F.forwardRef((e,t)=>{let{href:r,children:o,color:l=2,...a}=e;return(0,n.jsx)(w.sL,{als:"center",ref:t,...a,children:(0,n.jsx)(t4(),{prefetch:!1,href:r,children:(0,n.jsx)(N.P0,{children:(0,n.jsx)(k.zx,{bw:l,boc:"$color5",size:"$3",br:"$10",elevation:"$1",fontFamily:"$silkscreen",children:o})})})})}),t8=r(26396);let t6=F.forwardRef((e,t)=>{let{height:r=521,o=.08,direction:l="up",...a}=e;return(0,n.jsx)(w.FA,{ref:t,className:"bg-grid mask-gradient-"+l,fullscreen:!0,top:"auto",height:r,left:-1e3,right:-1e3,flex:1,pe:"none",o:o,...a})}),t7=F.forwardRef((e,t)=>{let{data:r,large:o,unit:l="ms",animateEnter:a=!1,selectedElement:i=""}=e,s=Math.max(...r.map(e=>e.value));return(0,n.jsx)(w.FA,{space:"$2",my:"$4",ref:t,children:r.map((e,t)=>{let r="".concat(Math.round(e.value/s*100),"%");return(0,n.jsxs)(w.sL,{space:"$3",children:[(0,n.jsx)(w.FA,{w:o?120:70,children:(0,n.jsx)(C.n,{size:"$2",whiteSpace:"nowrap",ta:"right",my:-3,fontWeight:e.name===i?"700":"400",children:e.name},e.name)}),(0,n.jsx)(w.sL,{marginRight:65,flex:1,alignItems:"center",children:(0,n.jsx)(w.FA,{bc:e.color,o:1,width:r,height:20,br:"$2",position:"relative",jc:"center",scaleX:1,...a&&{animation:"lazy",enterStyle:{opacity:0,scaleX:0}},children:(0,n.jsxs)(C.n,{size:"$1",whiteSpace:"nowrap",position:"absolute",right:"$-2",x:"100%",children:[e.value,l]})})})]},t)})})}),t9=F.forwardRef((e,t)=>{let{children:r,...o}=e;return(0,n.jsx)(z.H1,{ref:t,ta:"left",size:"$10",maw:500,$gtSm:{mx:0,maxWidth:800,size:"$13",ta:"center",als:"center"},$gtMd:{maxWidth:900,size:"$14"},$gtLg:{size:"$16",lh:"$15",maxWidth:1200},...o,children:r})});var re=r(92552);let rt=(0,re.z)(z.H2,{className:"word-break-keep-all",name:"HomeH2",ta:"center",als:"center",size:"$10",maw:720,mt:"$-2",$sm:{size:"$10"},$xs:{size:"$9"}}),rr=F.forwardRef((e,t)=>(0,n.jsx)(rt,{ref:t,...e,children:e.children})),rn=(0,re.z)(z.H3,{className:"word-break-keep-all",fontFamily:"$body",name:"HomeH3",theme:"alt1",ta:"center",als:"center",px:20,size:"$8",fow:"400",o:.9,ls:-.15,maw:690,$sm:{size:"$6",fow:"400",color:"$color",textTransform:"none"}}),ro=F.forwardRef((e,t)=>(0,n.jsx)(rn,{ref:t,...e,children:e.children})),rl=F.forwardRef((e,t)=>{let{title:r="",subtitle:o="",titleColor:l,subtitleColor:a,...i}=e;return(0,n.jsxs)(w.FA,{ai:"center",space:"$3",...i,ref:t,children:[(0,n.jsx)(rr,{color:l,children:r}),o?(0,n.jsx)(ro,{ai:"center",color:a,jc:"center",children:o}):null]})});var ra=r(6673),ri=r(38017);let rs=F.forwardRef((e,t)=>(0,n.jsx)(w.FA,{mt:2,bc:"$backgroundHover",w:25,h:25,ai:"center",jc:"center",br:100,mr:"$2.5",ref:t,children:(0,n.jsx)(K.J,{size:12,color:"var(--colorHover)"})})),rc=(0,re.z)(C.n,{name:"Code",tag:"code",fontFamily:"$mono",size:"$3",lineHeight:18,cursor:"inherit",whiteSpace:"pre",padding:"$1",borderRadius:"$4",variants:{colored:{true:{color:"$color",backgroundColor:"$background"}}}}),rd=(0,re.z)(C.n,{name:"CodeInline",tag:"code",fontFamily:"$mono",color:"$colorHover",backgroundColor:"$background",cursor:"inherit",br:"$3",fontSize:"85%",p:"$1.5"}),ru=F.forwardRef((e,t)=>(0,n.jsx)(rc,{ref:t,...e,children:e.children?e.children:null})),rp=F.forwardRef((e,t)=>(0,n.jsx)(rd,{ref:t,...e,children:e.children?e.children:null}));var rh=r(39635),rg=r(35827),rx=r(52944),rv=r(11788),rf=r(92247);let rm=F.forwardRef((e,t)=>{let{onRowPress:r=()=>{},dataStyles:o=[],firstRowIsHeader:l,title:a="",rows:i,"aria-label":s,"aria-labelledby":c}=e,d=!!(s||c),{tint:u}=(0,N.d5)();return(0,n.jsxs)(w.FA,{ref:t,borderWidth:1,borderColor:"$borderColor",f:1,"aria-label":d?s:"Component Props","aria-labelledby":c,my:"$4",br:"$4",ov:"hidden",$sm:{mx:0},children:[!!a&&(0,n.jsx)(w.sL,{ai:"center",py:"$2",px:"$4",backgroundColor:"$borderColor",children:(0,n.jsx)(z.H3,{size:"$3",children:a})}),i.map((e,t)=>(0,n.jsx)(rf.HC,{p:0,children:(0,n.jsx)(w.sL,{f:1,ai:"center",pos:"relative",py:"$3",px:"$4",jc:"space-around",$sm:{flexDirection:"column"},bc:t%2?"$backgroundHover":"$background",cursor:"pointer",borderColor:"$borderColor",borderBottomWidth:0===t?1:0,hoverStyle:0===t?{}:{bc:"$"+u+"3"},onPress:()=>0!==t?r(e):null,children:e.map((e,r)=>(0,n.jsx)(z.H4,{color:"$color",fow:"700",maw:100,fontFamily:"$mono",textTransform:"none",ai:"center",jc:"center",textAlign:"center",size:"$4",f:1,fontWeight:0==t&&l?"bold":"normal",...o&&o[r]?o[r]:{},children:e},e))})},t))]})});var rb=r(22958),ry=r(75900),rj=r(41979);let r$=F.forwardRef((e,t)=>{let{text:r="",placeHolder:o=""}=e,[l,a]=(0,F.useState)(!1),[i,s]=(0,F.useState)(r),c=(0,F.useRef)(null),d=(0,F.useRef)(null),u=c.current,p=d.current,h=()=>{u&&p&&(console.log("scroll height: ",u.scrollHeight,"height: ",u.style.height),u.style.height="auto",u.style.height=u.scrollHeight+"px")};return(0,n.jsxs)(w.sL,{flex:1,width:"100%",ref:t,children:[(0,n.jsx)(C.n,{color:"$color",ref:d,opacity:l?0:1,position:l?"absolute":"relative",cursor:"default",size:"$4",fow:"500",children:i}),(0,n.jsx)(eZ.K,{spellCheck:!1,placeholderTextColor:"$color",placeholder:o,ref:c,overflow:"hidden",opacity:l?1:0,position:l?"relative":"absolute",onLayout:e=>{u&&p&&(h(),p.style.position="absolute",p.style.opacity=0,u.style.position="relative",u.style.opacity=1,a(!0))},onChangeText:e=>{h(),s(e)},onContentSizeChange:h,width:"100%",size:"$4",p:0,space:0,borderWidth:0,value:i})]})});var rw=r(31933),rC=r(76988),rS=r(59213);let rk=F.forwardRef((e,t)=>{let{label:r,children:o}=e;return(0,n.jsx)(rC.Zb,{p:"$6",elevation:"$1",$sm:{p:"$4"},ref:t,children:(0,n.jsxs)(w.sL,{tag:"li",children:[(0,n.jsx)(S.x,{color:"$green9",children:(0,n.jsx)(rs,{})}),(0,n.jsx)(C.n,{color:"$gray11",children:(0,n.jsxs)(rS.J,{children:[(0,n.jsx)(rS.J,{size:"$5",fow:"800",children:r}),"\xa0\xa0-\xa0\xa0",(0,n.jsx)(rS.J,{size:"$5",tag:"span",theme:"alt2",children:o})]})})]})})}),rA=(0,re.z)(w.FA,{name:"Card",f:1,className:"transition all ease-in ms100",borderRadius:"$6",flexShrink:1,hoverStyle:{borderColor:"rgba(150,150,150,0.4)",elevation:"$6",y:"$-1"}});(0,re.z)(w.FA,{className:"transition all ease-in ms100",borderWidth:5,flex:1,borderColor:"rgba(150,150,150,0.05)",borderRadius:"$7"});let rP=F.forwardRef((e,t)=>(0,n.jsx)(rA,{ref:t,...e,children:e.children?e.children:null}));var rI=r(72374),rz=r(40895);let rL=F.forwardRef((e,t)=>{let{title:r,children:o,titleProps:l={},...a}=e;return(0,n.jsxs)(w.FA,{space:"$2",p:"$4",ref:t,...a,children:[(0,n.jsx)(z.H4,{ls:0,fontFamily:"$silkscreen",ta:"center",...l,children:r}),(0,n.jsxs)(C.n,{theme:"alt2",children:[(0,n.jsx)(rz.g,{}),o]})]})}),rR=(0,re.z)(z.H1,{className:"word-break-keep-all",size:"$12",mb:"$2",$gtSm:{size:"$11",maxWidth:"90%"}}),rF=F.forwardRef((e,t)=>(0,n.jsx)(rR,{ref:t,...e,children:e.children})),rT=(0,re.z)(S.x,{className:"word-break-keep-all",size:"$9",mb:"$2",$gtSm:{size:"$10",maxWidth:"90%"}}),rE=F.forwardRef((e,t)=>(0,n.jsx)(rT,{ref:t,...e,children:e.children}));var r_=r(68890),rW=r(7173),rO=r(70155);let rD=F.forwardRef((e,t)=>{var r,o,l;let{device:a,sensor:i,monitor:s,noValueText:c,...d}=e,[u,p]=(0,F.useState)([]),h=null!==(o=new r_.i(u).getSubsystemByName(a,i).getMonitorByName(s))&&void 0!==o?o:{},g=new rW.zm(a,i,h),x=(0,rO.gn)({path:""!=g.getEventPath()?g.getEventPath():null});return(0,F.useEffect)(()=>{(async()=>{var e;p(null===(e=(await f.API.get("/api/core/v1/devices")).data)||void 0===e?void 0:e.items)})()},[]),(0,n.jsx)(S.x,{ref:t,...d,children:null!==(l=x&&(null==x?void 0:null===(r=x.payload)||void 0===r?void 0:r.message))&&void 0!==l?l:null!=c?c:"n/a"})}),rM=F.forwardRef((e,t)=>{var r,o;let{object:l,elementId:a,field:i,noValueText:s,...c}=e,d=(0,rO.gn)({path:l+"/update/"+a});return(0,n.jsx)(S.x,{ref:t,...c,children:null!==(o=d&&(null==d?void 0:null===(r=d.payload)||void 0===r?void 0:r.data[i]))&&void 0!==o?o:null!=s?s:"n/a"})});var rN=r(38917),rV=r(14503);let rH=F.forwardRef((e,t)=>{var r;let{mode:o="edit",elementId:l,model:a,...i}=e,s=(0,rV.Py)();if("string"==typeof a||!a||!(null==a?void 0:a.getApiOptions())||!l&&"add"!=o)return(0,n.jsxs)(w.FA,{ref:t,padding:"$4",gap:"$2",children:[(0,n.jsx)(S.x,{fontWeight:"bold",children:"ObjectForm:"}),(0,n.jsx)(S.x,{children:"Model or Element ID is empty."})]});let{name:c,prefix:d}=null!==(r=null==a?void 0:a.getApiOptions())&&void 0!==r?r:{},u=d+c;return(0,n.jsx)(w.FA,{ref:t,children:(0,n.jsx)(rN.EditableObject,{objectId:l,name:c,title:"",sourceUrl:u+"/"+l,numColumns:2,mode:o,disableAutoChangeMode:!0,onSave:async(e,t)=>{try{if("add"==o){let e=a.load(t),r=await f.API.post(u,e.create().getData());if(r.isError)throw r.error;s.show(c+" created",{message:e.getId()})}else if("edit"==o){let r=a.load(t).getId(),n=await f.API.post(u+"/"+r,a.load(e).update(a.load(t)).getData());if(n.isError)throw n.error;s.show(c+" updated",{message:"Saved new settings for: "+r})}}catch(e){throw(0,f.getPendingResult)("error",null,e instanceof f.z.ZodError?e.flatten():e)}},model:a})})});var rB=r(71439);let rG=(0,re.z)(C.n,{px:"$3",py:"$2",size:"$5",w:"100%",cursor:"pointer",fontFamily:"$heading",fontWeight:"600",opacity:.8,color:"$color",hoverStyle:{opacity:1,color:"$color8"},pressStyle:{opacity:.25},tabIndex:-1}),rU=F.forwardRef((e,t)=>{let{children:r,...o}=e;return(0,n.jsx)(rB.p,{prefetch:!1,ref:t,...o,children:(0,n.jsx)(rG,{children:r})})});var rq=r(96082),rJ=r(50128);let rZ=new Set,rK=()=>{let{tintIndex:e,setTintIndex:t}=(0,N.d5)(),r=(0,rJ.N)();return(0,F.useEffect)(()=>(rZ.add(r),()=>{rZ.delete(r)}),[r]),[e-2,(0,F.useCallback)(e=>{t(e+2)},[])]},rY=(0,F.createContext)({hovered:0,setHovered:e=>{}});var rX=e=>{let{children:t}=e,[r,o]=rK();return(0,n.jsx)(rY.Provider,{value:{hovered:r,setHovered:o},children:t})};let rQ=F.forwardRef((e,t)=>{let{lineColor:r="$borderColor",lineHeight:o=1,...l}=e;return(0,n.jsxs)(w.FA,{my:"$10",mx:"auto",maxWidth:"50%",ref:t,...l,children:[(0,n.jsx)(rz.g,{}),(0,n.jsx)(w.FA,{borderBottomColor:r,borderBottomWidth:o,flex:1})]})}),r0=(0,re.z)(w.FA,{br:100,bc:"$background",p:"$2",als:"flex-start"}),r1=F.forwardRef((e,t)=>(0,n.jsx)(r0,{ref:t,...e,children:e.children?e.children:null}));var r2=r(75049),r3=r(19653);let r4=F.forwardRef((e,t)=>{let{width:r=200,height:o,url:l="/images/patterns/pattern-1.png",...a}=e;return(0,n.jsx)(r3.E,{ref:t,source:{width:r,height:null!=o?o:r,uri:l},...a})});var r5=r(89324),r8=r(20003);let r6=(0,re.z)(C.n,{color:"$gray10",size:"$6",ta:"left",ls:-1,fontFamily:"$silkscreen",$gtSm:{ta:"center",size:"$7",ls:-1},$gtMd:{size:"$8",ls:-1},$gtLg:{size:"$9",lh:50,ls:-1}}),r7=(0,re.z)(S.x,{className:"hero-tag text-decoration-none",fontFamily:"inherit",fontSize:"inherit",borderRadius:"$2",px:"$1",mx:"$-1",cursor:"pointer",color:"$color",bc:"$color2",hoverStyle:{color:"$color",bc:"$color3"},variants:{active:{true:{color:"$color10",bc:"$color5",hoverStyle:{color:"$color12",bc:"$color5"}}}}}),r9=F.forwardRef((e,t)=>{let{id:r,themeColor:o,children:l,href:a,...i}=e,{hovered:s,setHovered:c}=(0,F.useContext)(rY);return(0,n.jsx)(rB.p,{prefetch:!1,href:a,children:(0,n.jsx)(r7,{theme:o,onHoverIn:()=>c(r),active:s===r,...i,children:l})})}),ne=F.forwardRef((e,t)=>{let{children:r}=e;return(0,n.jsx)(r6,{children:(0,n.jsx)(rX,{children:r})})});var nt=r(12397);let nr=F.forwardRef((e,t)=>{let{text:r="",downscale:o=1,animated:l,...a}=e,i=(0,N.d5)(),{tintIndex:s,tint:c}=i,d=i.tints.map(e=>"var(--".concat(e,"9)")),[u,p]=(0,F.useState)(!1),[h,g]=(0,F.useState)("start");(0,F.useEffect)(()=>{(window.requestIdleCallback||setTimeout)(()=>{setTimeout(()=>{g("animate")},50),setTimeout(()=>{g("done")},1500)})},[]);let x=e=>{let t="start"!==h&&e===s;return"done"!==h||u?t?"var(--color)":d[s]:u&&t?"var(--color)":d[e]},v=Math.round(15*s+s/d.length*9+3+(6===s?-3:0));return(0,n.jsxs)(w.sL,{ref:t,onHoverIn:()=>p(!0),onHoverOut:()=>p(!1),paddingVertical:"$2",marginVertical:"$-2",position:"relative",...a,children:[l&&(0,n.jsx)(nt.C,{animation:"quick",position:"absolute",top:0,left:0,y:"start"===h?-30:-3,x:v,size:4,backgroundColor:"$color9"}),(0,n.jsx)(C.n,{fontWeight:"bold",fontFamily:"$silkscreen",fontSize:"$8",children:r.split("").map((e,t)=>(0,n.jsx)(S.x,{onMouseEnter:()=>i.setTintIndex(t%7),color:x(t%7),children:e},t))})]})});var nn=r(50666);let no=F.forwardRef((e,t)=>{let{buttonProps:r={},buttonTextProps:o={},color:l,textColor:a,children:i}=e;return(0,n.jsx)(k.zx,{ref:t,accessibilityLabel:"Get started (docs)",fontFamily:"$silkscreen",size:"$5",borderRadius:1e3,bordered:!0,bw:2,mx:"$2",tabIndex:"0",elevation:"$1",letterSpacing:-2,pressStyle:{elevation:"$0"},backgroundColor:l,...r,children:(0,n.jsx)(k.oD,{color:a,fontFamily:"$silkscreen",size:"$7",letterSpacing:1,...o,children:i})})});var nl=r(88480);let na=F.forwardRef((e,t)=>(0,n.jsx)(rC.Zb,{ref:t,bw:1,boc:"$borderColor",br:"$6",elevation:"$6",shadowRadius:60,children:(0,n.jsx)(w.FA,{jc:"center",p:"$6",space:"$5",maw:"calc(min(90vw, 400px))",$sm:{p:"$5"},...e,children:e.children})})),ni=F.forwardRef((e,t)=>{let{containerProps:r={},title:o="",subtitle:l="",href:a="",caption:i="",...s}=e;return(0,n.jsx)(w.sL,{ref:t,...r,children:(0,n.jsxs)(na,{children:[o?(0,n.jsx)(C.n,{ta:"left",size:"$8",fow:"400",ls:-1,children:o}):null,l?(0,n.jsx)(C.n,{ta:"left",size:"$6",theme:"alt2",fow:"400",children:l}):null,a&&i?(0,n.jsx)(rB.p,{prefetch:!1,href:a,children:(0,n.jsx)(k.zx,{accessibilityLabel:"Fonts docs",fontFamily:"$silkscreen",als:"flex-end",children:i})}):null,s.children]})})});var ns=r(62858),nc=r(95211),nd=r(99810),nu=r(41678);let np=(0,N.j$)().tints.map(e=>0),nh=F.forwardRef((e,t)=>{let{containerProps:r,children:o,index:l,themed:a,zIndex:i,...s}=e,c=(0,F.useRef)(null),d=(0,F.useRef)(null),u=(0,F.useRef)(null),{tint:p,tints:h,setTintIndex:g}=(0,N.d5)();return!function(e,t){let{threshold:r=0,root:n,rootMargin:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=(0,nu.z)(t);(0,F.useEffect)(()=>{let t=Array.isArray(e)?e:[e];if(!t.length)return;let l=null,i=[],s=new IntersectionObserver(e=>{i=t.map((t,r)=>{var n,o;return null!==(o=null!==(n=e.find(e=>e.target===t.current))&&void 0!==n?n:i[r])&&void 0!==o?o:null}),null==l||l(),l=a(i)||null},{threshold:r,root:n,rootMargin:o});for(let e of t)e.current&&s.observe(e.current);return()=>{null==l||l(),s.disconnect()}},[a,e,n,o,r,...l])}((0,F.useMemo)(()=>[c,u,d],[]),e=>{let t=e.reduce((e,t)=>e+((null==t?void 0:t.isIntersecting)?1:0),0);if(t<2)return;np[l]=t;let r=-1,n=-1;np.forEach((e,t)=>{e>=n&&(r=t,n=e)}),r===l&&r!==ng&&(g(r<=1?3:r%h.length),ng=l,nx.forEach(e=>e(r,t)))},{threshold:.1}),(0,n.jsxs)(w.FA,{...r,zIndex:i,pos:"relative",ref:t,children:[(0,F.useMemo)(()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(w.sL,{ref:c,pos:"absolute",t:"10%",l:0,r:0,h:10,o:0,pe:"none"}),(0,n.jsx)(w.sL,{ref:u,pos:"absolute",t:"50%",l:0,r:0,h:10,o:0,pe:"none"}),(0,n.jsx)(w.sL,{ref:d,pos:"absolute",b:"10%",l:0,r:0,h:10,o:0,pe:"none"})]}),[c,u,d]),(0,n.jsx)(nm,{...r,theme:a?p:null,...s,children:(0,F.useMemo)(()=>o,[o])})]})}),ng=0,nx=new Set,nv=e=>{(0,F.useEffect)(()=>(nx.add(e),()=>{nx.delete(e)}),[])},nf=(0,re.z)(w.FA,{name:"Section",pos:"relative",py:"$14",zi:2,variants:{below:{true:{zi:1}}}}),nm=F.forwardRef((e,t)=>(0,n.jsx)(nf,{ref:t,...e,children:e.children})),nb=(0,F.memo)(F.forwardRef((e,t)=>{let{tints:r,tint:o,name:l,tintIndex:a}=(0,N.d5)(),i="blue"===o||"green"===o||"purple"===o,[s,c]=(0,F.useState)(0),d=s<=1&&i,[u,p]=(0,F.useState)(0),h=(0,nc.Nr)(p,200),g=d?.5:1;nd.C5&&nv(e=>{var t,r;c(e),h((null!==(r=null===(t=document.documentElement)||void 0===t?void 0:t.scrollTop)&&void 0!==r?r:0)+100)});let x=(0,F.useMemo)(()=>(0,n.jsx)(A.Kq,{children:r.map((e,t)=>{let r="xmas"===l||"easter"===l,a=r?0==t||1==t:e===o,i=r&&"green"===e&&o!==e;return(0,n.jsx)(w.FA,{overflow:"hidden",h:"100vh",w:1e3,theme:e,o:a?.3:0,fullscreen:!0,left:"calc(50vw - 500px)",x:d?0:r?i?-500:500:0,scale:g,className:"hero-blur"},"".concat(e).concat(t))})}),[g,o,r]);return(0,n.jsx)(w.FA,{ref:t,pos:"absolute",t:0,l:0,contain:"layout",pe:"none",animation:"quick",zi:-1,x:0,y:u,...d&&{animation:"quick",x:2===a?-400:4===a?400:0,y:300},children:x},0)}));var ny=r(73794);let nj=(0,re.z)(w.FA,{overflow:"visible",tag:"pre",padding:"$4",borderRadius:"$4",bc:"$background"}),n$=F.forwardRef((e,t)=>(0,n.jsx)(nj,{ref:t,...e,children:e.children})),nw=F.forwardRef((e,t)=>{let{rainbowType:r,...o}=e;return(0,n.jsx)(S.x,{fontSize:"$14",lineHeight:"$14",ref:t,...o,children:(0,n.jsx)("div",{className:(null!=r?r:"rainbowSoft")+" clip-text",style:{display:"inline-block"},children:o.children})})});var nC=r(56662);let nS=(0,F.forwardRef)((e,t)=>{let{alwaysOpen:r=!0,automatic:o=!1,defaultOpened:l,initialState:a,onCancel:i=()=>{},onSearch:s=()=>{},placeholder:c="Search...",...d}=e,[u,p]=(0,F.useState)(!!l),[h,g]=(0,F.useState)(!1),x=(0,F.useRef)(),[v,f]=(0,F.useState)(a);(0,ei.rf)(()=>{if(u){var e;null===(e=x.current)||void 0===e||e.focus()}else i()},[u]);let m=(0,nC.GS)();return(0,F.useEffect)(()=>{m.xs&&!v?p(!1):m.xs||p(!0)},[m.xs]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(w.sL,{width:u?"500px":50,$gtLg:{width:u?600:50},$gtMd:{width:u?500:50},$gtSm:{width:u?300:50},$sm:{width:u?200:50},onPress:()=>{m.xs?g(!0):p(!0)},ref:t,elevation:m.xs?0:1,br:20,...d,children:[!m.xs&&(0,n.jsx)(O.II,{o:1,br:20,focusStyle:{bw:1,outlineWidth:0},backgroundColor:m.xs?"transparent":"$bgContent",value:v,disabled:!u,ref:x,paddingLeft:50,width:"100%",placeholderTextColor:"$gray9",placeholder:u?c:"",onBlur:()=>(!r||!!m.xs)&&!v&&p(!1),onChangeText:e=>{f(e),o?s(e):e||s("")},bw:0,onSubmitEditing:e=>{s(v)}}),(0,n.jsx)(w.sL,{position:"absolute",left:0,top:0,$xs:{pos:"unset",top:-20},cursor:"pointer",children:(0,n.jsx)(Y.I,{children:(0,n.jsx)(k.zx,{disabled:u,o:.5,circular:!0,chromeless:!0,children:(0,n.jsx)(eh.o,{fillOpacity:0,color:"var(--color)"})})})})]}),m.xs&&(0,n.jsx)(I.Vq,{open:h,onOpenChange:g,children:(0,n.jsxs)(I.Vq.Portal,{children:[(0,n.jsx)(I.Vq.Overlay,{opacity:.5,enterStyle:{opacity:0},exitStyle:{opacity:0}}),(0,n.jsxs)(I.Vq.Content,{w:"90%",flexDirection:"row",gap:"$4",themeInverse:!0,children:[(0,n.jsx)(O.II,{value:v,fos:18,placeholder:c,enterKeyHint:"search",onChangeText:e=>{f(e),o?s(e):e||s("")},onSubmitEditing:e=>{g(!1),s(v)}}),(0,n.jsx)(Y.I,{children:(0,n.jsx)(k.zx,{backgroundColor:"$color7",icon:eh.o,scaleIcon:1.5,onPress:()=>{g(!1),s(v)}})})]}),(0,n.jsx)(I.Vq.Close,{})]})})]})});var nk=r(24551);let nA=(0,F.forwardRef)((e,t)=>{let{children:r,gradient:o,extraPad:l,bubble:a,noBorderTop:i,...s}=e,{tint:c}=(0,N.d5)(),d=(0,F.useMemo)(()=>r,[r]);return(0,n.jsxs)(w.FA,{ref:t,zi:2,contain:"paint",pos:"relative",py:"$14",elevation:"$2",...a&&{maw:1400,br:"$6",bw:1,boc:"$".concat(c,"4"),als:"center",width:"100%"},...s,children:[(0,n.jsx)(w.FA,{fullscreen:!0,className:"all ease-in ms1000",zIndex:-1,opacity:.4,backgroundColor:o?"$".concat(c,"2"):null,...!a&&{btw:i?0:1,bbw:1,boc:"$".concat(c,"3")}}),d]})}),nP=e=>(0,n.jsx)(w.FA,{$sm:{width:"auto",maxWidth:500,marginHorizontal:"auto"},flexShrink:1,...e}),nI=F.forwardRef((e,t)=>{let{href:r,children:o,...l}=e;return(0,n.jsx)(rB.p,{prefetch:!1,href:r,ref:t,children:(0,n.jsx)(z.H3,{cursor:"pointer",color:"$color",marginVertical:"$2",children:(0,n.jsx)(rp,{cursor:"pointer",fontFamily:"$silkscreen",bc:"$color2",hoverStyle:{backgroundColor:"$color3"},size:"$9",fontSize:"$7",ls:0,...l,children:o})})})}),nz=F.forwardRef((e,t)=>{let{id:r,title:o,icon:l,children:a,href:i,hoveredTheme:s,nonHoveredTheme:c,...d}=e,{hovered:u,setHovered:p}=(0,F.useContext)(rY);return(0,n.jsx)(A.Kq,{flex:1,ref:t,children:(0,n.jsxs)(nP,{theme:u==r?s:c,onHoverIn:void 0!==r?()=>p(r):()=>{},...d,children:[l?(0,n.jsx)(r1,{children:l}):null,o?(0,n.jsx)(nI,{href:i,children:o}):null,(0,n.jsx)(C.n,{opacity:.7,size:"$4",children:a})]})})}),nL=F.forwardRef((e,t)=>{let{children:r}=e,o=F.Children.toArray(r);return o.length<3?(0,n.jsx)("h1",{children:"Error: SideBySide expectes 3 children"}):(0,n.jsxs)(w.sL,{ref:t,position:"relative",justifyContent:"space-between",$sm:{flexDirection:"column"},children:[(0,n.jsx)(w.FA,{flex:1,maxWidth:"50%",$sm:{maxWidth:"100%"},paddingHorizontal:"$2",space:!0,children:o[0]}),(0,n.jsx)(w.FA,{$sm:{display:"none"},position:"absolute",left:0,right:0,alignItems:"center",justifyContent:"center",top:"55%",theme:"alt2",zIndex:1e3,pe:"none",children:o[1]}),(0,n.jsx)(w.FA,{flex:1,maxWidth:"50%",$sm:{maxWidth:"100%",marginTop:"$6"},paddingHorizontal:"$2",space:!0,children:o[2]})]})});var nR=r(1627),nF=r(16505);let nT=(0,F.memo)(F.forwardRef((e,t)=>{let{tabs:r,children:o,containerProps:l={}}=e,[a,i]=(0,F.useState)(0),{tint:s}=(0,N.d5)(),c=F.Children.toArray(o),{resolvedTheme:d}=(0,ex.P)();return(0,n.jsxs)(w.FA,{ref:t,overflow:"hidden",flex:1,children:[(0,n.jsx)(w.sL,{f:1,borderBottomColor:"$gray5",borderBottomWidth:2,paddingHorizontal:"$4",flexShrink:0,space:!0,children:(0,n.jsx)(nF.E4,{size:"$2",f:1,br:0,position:"relative",top:2,children:r?r.map((e,t)=>(0,n.jsx)(nF.E4.Item,{children:(0,n.jsx)(w.sL,{paddingTop:"$3",paddingBottom:"$3",borderWidth:0,borderBottomWidth:4,borderBottomColor:t===a?"$color7":"transparent",hoverStyle:{backgroundColor:"dark"==d?"$gray1":"$gray4"},borderTopRightRadius:"$3",borderTopLeftRadius:"$3",br:"$3",theme:s,cursor:"pointer",onPress:()=>i(t),f:1,children:(0,n.jsx)(rS.J,{userSelect:"none",textAlign:"center",accessibilityLabel:e,o:t===a?1:.7,color:t===a?"$color8":"$color",theme:t===a?s:"alt1",size:"$2",f:1,fontWeight:"600",children:e})})},t)):null})}),(0,n.jsx)(w.sL,{maxWidth:"100%",flex:1,children:(0,n.jsx)(w.FA,{flex:1,maxWidth:"100%",opacity:.9,hoverStyle:{opacity:1},children:(0,n.jsx)(w.FA,{backgroundColor:"$backgroundHover",borderColor:"$borderColor",overflow:"hidden",borderWidth:1,flex:1,...l,children:c[a]})})})]})})),nE=F.forwardRef((e,t)=>{let{title:r,icon:o,subtitlePre:l,subtitlePost:a,footer:i,children:s,grow:c,width:d="auto"}=e;return(0,n.jsx)(w.FA,{ref:t,width:d,className:"transition all ease-in ms100",position:"relative",$sm:{width:"auto",minWidth:"100%"},padding:"$3",hoverStyle:{zIndex:1e3},flex:c?1:0,children:(0,n.jsx)(rP,{overflow:"hidden",y:0,children:(0,n.jsxs)(w.sL,{bc:"$backgroundStrong",f:1,p:"$5",m:1,br:"$6",space:!0,children:[(0,n.jsxs)(w.FA,{flex:1,space:"$2",children:[(0,n.jsx)(z.H3,{alignSelf:"flex-start",fontFamily:"$silkscreen",size:"$7",fow:"200",color:"$color",cursor:"default",letterSpacing:1,children:r}),!!(l||a)&&(0,n.jsxs)(w.sL,{children:[!!l&&(0,n.jsx)(C.n,{cursor:"default",tag:"time",size:"$7",theme:"alt2",children:l}),!!a&&(0,n.jsx)(C.n,{cursor:"default",fow:"700",theme:"alt2",size:"$7",children:a})]}),s,(0,n.jsx)(C.n,{opacity:.65,cursor:"default",theme:"alt2",size:"$4",fow:"500",children:i})]}),(0,n.jsx)(rS.J,{children:o})]})})})});var n_=r(59149),nW=r(17860);let nO=F.forwardRef((e,t)=>{let{children:r,tooltipText:o=""}=e;return(0,n.jsx)(A.Kq,{ref:t,children:(0,n.jsx)(e3.w,{placement:"top",delay:0,restMs:25,label:o,children:(0,n.jsxs)(w.FA,{p:"$5",$sm:{p:"$3"},opacity:.65,hoverStyle:{opacity:1},children:[(0,n.jsx)(nW.T,{children:(0,n.jsx)(S.x,{children:o})}),r]})})})}),nD=(0,F.forwardRef)((e,t)=>{let{color:r,...o}=e;return(0,n.jsxs)("svg",{ref:t,width:"30",height:"31",viewBox:"0 0 30 31",fill:"none",xmlns:"http://www.w3.org/2000/svg",...o,children:[(0,n.jsx)("g",{clipPath:"url(#clip0)",children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M28.9993 6.50637C27.9673 6.9667 26.8601 7.27923 25.6985 7.4186C26.8851 6.70064 27.796 5.56035 28.2222 4.20468C27.1108 4.87196 25.8823 5.35341 24.5745 5.61525C23.5258 4.48764 22.0341 3.78235 20.3795 3.78235C17.2082 3.78235 14.6343 6.38389 14.6343 9.58936C14.6343 10.0455 14.6845 10.4889 14.7848 10.9113C10.009 10.6705 5.77634 8.35616 2.94345 4.84239C2.45041 5.69972 2.16629 6.69641 2.16629 7.76068C2.16629 9.77519 3.18162 11.5532 4.72341 12.5921C3.78329 12.5626 2.89749 12.3007 2.12033 11.8657C2.12033 11.8911 2.12033 11.9122 2.12033 11.9375C2.12033 14.7502 4.10084 17.0984 6.729 17.6305C6.24849 17.7614 5.73874 17.8332 5.21645 17.8332C4.84458 17.8332 4.48525 17.7952 4.13427 17.7276C4.86547 20.0335 6.98805 21.7144 9.49921 21.7609C7.53123 23.3193 5.05768 24.2484 2.36267 24.2484C1.89888 24.2484 1.44344 24.2188 0.992188 24.1681C3.5326 25.8152 6.55351 26.7781 9.80005 26.7781C20.367 26.7781 26.1456 17.9303 26.1456 10.2566C26.1456 10.0032 26.1414 9.75407 26.1289 9.5049C27.2528 8.68558 28.2264 7.66355 28.9952 6.49792L28.9993 6.50637Z",fill:null!=r?r:"var(--color)"})}),(0,n.jsx)("defs",{children:(0,n.jsx)("clipPath",{id:"clip0",children:(0,n.jsx)("rect",{width:"28",height:"23",fill:"white",transform:"translate(1 3.78235)"})})})]})}),nM=(0,re.z)(w.FA,{tag:"ul",my:"$1",ml:"$4",mr:"$2",display:"inline"}),nN=F.forwardRef((e,t)=>(0,n.jsx)(nM,{ref:t,...e,children:e.children})),nV=F.forwardRef((e,t)=>{let{width:r="800",url:o="/videos/visual-ui-dark.mp4",...l}=e;return(0,n.jsx)(A.Kq,{ref:t,...l,children:(0,n.jsx)("video",{controls:!1,muted:!0,width:r,autoPlay:!0,loop:!0,children:(0,n.jsx)("source",{src:o,type:"video/mp4"})})})}),nH=F.forwardRef((e,t)=>(0,n.jsx)(w.sL,{ref:t,ai:"center",jc:"center",...e,children:e.children}));var nB=r(34649);let nG={craft:{custom:{hidden:!0}}},nU={text:{craft:{custom:{hidden:!1,kinds:{children:"string"}},props:{children:"hello world!"}}},container:{craft:{custom:{hidden:!1}},visualUIOnlyFallbackProps:{children:(0,n.jsx)(nB.MY,{})}}};var nq=Object.entries({text:["a","abbr","b","bdi","bdo","cite","code","data","dfn","em","h1","h2","h3","h4","h5","h6","i","ins","kbd","mark","q","rp","rt","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr"],container:["address","article","aside","blockquote","body","caption","colgroup","div","dl","dt","dd","fieldset","figcaption","figure","footer","form","head","header","hgroup","html","li","main","nav","ol","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul"],miscellany:["area","audio","base","br","button","canvas","col","datalist","del","details","dialog","embed","hr","iframe","img","input","label","legend","link","map","meta","meter","object","optgroup","option","output","param","picture","progress","script","select","source","style","summary","svg","template","textarea","title","track","video"]}).reduce((e,t)=>{let[r,n]=t;return n.forEach(t=>{e={...e,...(0,nB.LX)(t,{...nG,...nU[r]})}}),e},{});let nJ=F.forwardRef((e,t)=>(0,n.jsx)(w.FA,{ref:t,...e,children:e.children})),nZ=F.forwardRef((e,t)=>(0,n.jsx)(w.sL,{ref:t,...e,children:e.children})),nK=F.forwardRef((e,t)=>(0,n.jsx)(w.FA,{ref:t,ai:"center",jc:"center",...e,children:e.children})),nY=F.forwardRef((e,t)=>(0,n.jsx)(T.LZ,{ref:t,pointerEvents:"auto",width:"100%",flexBasis:"46px",alignSelf:"center",...e})),nX={icon:e=>{var t;return null!==(t=e.alignSelf)&&void 0!==t?t:"center"},menu:[{action:e=>{let{setProp:t}=e;return t(e=>e.alignSelf="start")},name:"Align Self Start",selected:e=>"start"==e.alignSelf},{action:e=>{let{setProp:t}=e;return t(e=>e.alignSelf="center")},name:"Align Self Center",selected:e=>"center"==e.alignSelf},{action:e=>{let{setProp:t}=e;return t(e=>e.alignSelf="end")},name:"Align Self End",selected:e=>"end"==e.alignSelf},{action:e=>{let{setProp:t}=e;return t(e=>e.alignSelf="stretch")},name:"Align Self Stretch",selected:e=>"stretch"==e.alignSelf}]},nQ={icon:e=>"italic",selected:e=>"italic"==e.fontStyle,action:e=>{let{setProp:t}=e;return t(e=>("italic"==e.fontStyle?e.fontStyle="normal":e.fontStyle="italic",e))}},n0=F.forwardRef((e,t)=>{let{currentView:r="default",viewId:o="default",placeholder:l=(0,n.jsx)(n.Fragment,{}),...a}=e;return(0,n.jsxs)("div",{ref:t,style:{display:"inline"},...a,children:[r==o&&a.children,!a.children&&l]})});var n1=r(8293);let n2=e=>(0,n.jsxs)(n1.W_,{canvas:!0,is:e.layout.VStack,alignItems:"center",justifyContent:"center",gap:"$4",margin:"$4",children:[(0,n.jsx)(n1.W_,{canvas:!0,is:e.text.Text,fontSize:"40px",children:"Discover Our Featured Services"}),(0,n.jsxs)(n1.W_,{canvas:!0,is:e.layout.HStack,gap:"$6",flexWrap:"wrap",children:[(0,n.jsxs)(n1.W_,{canvas:!0,is:e.layout.VStack,gap:"$4",width:300,justifyContent:"flex-start",children:[(0,n.jsx)(n1.W_,{canvas:!0,is:e.basic.Image,width:300,height:350,url:"/images/patterns/pattern-1.png"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.text.Text,fontWeight:"bold",padding:"$0",alignSelf:"flex-start",children:"Custom Web Design"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.text.Text,children:"Make Your Online Presence Shine with a Unique Website"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.basic.ButtonSimple,children:"Learn More"})]}),(0,n.jsxs)(n1.W_,{canvas:!0,is:e.layout.VStack,gap:"$4",width:300,justifyContent:"flex-start",children:[(0,n.jsx)(n1.W_,{canvas:!0,is:e.basic.Image,width:300,height:350,url:"/images/patterns/pattern-2.png"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.text.Text,fontWeight:"bold",padding:"$0",alignSelf:"flex-start",children:"Custom Web Design"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.text.Text,children:"Make Your Online Presence Shine with a Unique Website"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.basic.ButtonSimple,children:"Learn More"})]}),(0,n.jsxs)(n1.W_,{canvas:!0,is:e.layout.VStack,gap:"$4",width:300,justifyContent:"flex-start",children:[(0,n.jsx)(n1.W_,{canvas:!0,is:e.basic.Image,width:300,height:350,url:"/images/patterns/pattern-3.png"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.text.Text,fontWeight:"bold",padding:"$0",alignSelf:"flex-start",children:"Custom Web Design"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.text.Text,children:"Make Your Online Presence Shine with a Unique Website"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.basic.ButtonSimple,children:"Learn More"})]})]})]});n2.craft={custom:{light:"/images/molecules/product-columns-light.png",dark:"/images/molecules/product-columns-dark.png"},displayName:"ProductColumns"};let n3=e=>(0,n.jsxs)(n1.W_,{canvas:!0,is:e.layout.HStack,flexDirection:"row",flexWrap:"wrap-reverse",alignItems:"center",justifyContent:"center",gap:"$8",children:[(0,n.jsxs)(n1.W_,{canvas:!0,is:e.layout.VStack,alignItems:"center",gap:"$4",width:400,children:[(0,n.jsx)(n1.W_,{canvas:!0,is:e.text.Text,children:"Discover Our Featured Category"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.text.Head1,textAlign:"center",children:"Find What You Need Here!"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.text.Text,textAlign:"center",children:"Discover Our Featured Category"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.basic.ButtonSimple,children:"Start the Adventure!"})]}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.basic.Image,width:400,height:400,url:"/images/patterns/pattern-1.png"})]});n3.craft={custom:{light:"/images/molecules/featured-category-light.png",dark:"/images/molecules/featured-category-dark.png"},displayName:"FeaturedCategory"};let n4=e=>(0,n.jsxs)(n1.W_,{canvas:!0,is:e.basic.Container,alignItems:"start",gap:"$5",padding:"$0",children:[(0,n.jsx)(n1.W_,{is:e.text.Head3,textAlign:"left",margin:"$0",padding:"$0",alignSelf:"start",children:"Protofy is a Full-Stack, batteries included Low-Code enabled web/app and IoT system with an API system and real time messaging."}),(0,n.jsx)(n1.W_,{is:e.basic.ButtonSimple,children:"Learn More"})]});n4.craft={custom:{light:"/images/molecules/introduction-light.png",dark:"/images/molecules/introduction-dark.png"},displayName:"Introduction"};let n5=e=>(0,n.jsxs)(n1.W_,{canvas:!0,is:e.basic.Container,alignItems:"center",justifyContent:"center",gap:"$8",padding:"$6",children:[(0,n.jsx)(n1.W_,{canvas:!0,is:e.text.Head3,fontSize:"50px",children:"Subscribe"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.text.Text,textAlign:"center",children:"Enter your email and be the first to recieve latest news"}),(0,n.jsxs)(n1.W_,{canvas:!0,is:e.layout.HStack,alignItems:"center",gap:"$2",children:[(0,n.jsx)(n1.W_,{canvas:!0,is:e.basic.Input,state:"cs.email",placeholder:"Type your email",minWidth:350,f:3}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.basic.ButtonSimple,f:1,size:"$4",children:"subscribe"})]})]});n5.craft={custom:{light:"/images/molecules/subscribe-light.png",dark:"/images/molecules/subscribe-dark.png"},displayName:"Subscribe"};let n8=e=>(0,n.jsx)(n1.W_,{is:e.layout.Center,canvas:!0,height:"90vh",width:"100%",paddingHorizontal:"20px",children:(0,n.jsxs)(n1.W_,{is:e.layout.VStack,canvas:!0,height:"100%",gap:"20px",width:"100%",maxWidth:"900px",ai:"center",jc:"center",children:[(0,n.jsx)(n1.W_,{is:e.basic.Image,canvas:!0,height:120,width:150,resizeMode:"cover",url:"/logo.png"}),(0,n.jsx)(n1.W_,{is:e.text.Text,canvas:!0,fontFamily:"$heading",fontSize:"$12",fontWeight:"700",children:"About Us"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.text.Text,fontFamily:"$body",fontSize:"$6",textAlign:"center",fontWeight:"200",children:"Protofy is a Full-Stack, batteries included Low-Code enabled web/app and IoT system with an API system and real time messaging."}),(0,n.jsxs)(n1.W_,{canvas:!0,is:e.miscellany.HCenterStack,gap:"20px",marginTop:"40px",children:[(0,n.jsx)(n1.W_,{canvas:!0,is:e.miscellany.GithubIcon,height:"35px",width:"35px"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.miscellany.DiscordIcon,height:"35px",width:"35px"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.miscellany.TwitterIcon,height:"35px",width:"35px"})]})]})});n8.craft={custom:{light:"/images/molecules/aboutus-light.png",dark:"/images/molecules/aboutus-dark.png"},displayName:"AboutUs"};let n6=e=>(0,n.jsxs)(n1.W_,{canvas:!0,is:e.layout.HStack,gap:"$5",justifyContent:"center",padding:"$4",children:[(0,n.jsx)(n1.W_,{canvas:!0,is:e.basic.ButtonSimple,size:"$6",children:"Cancel"}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.basic.ButtonSimple,size:"$6",themeInverse:!0,children:"Accept"})]});n6.craft={custom:{light:"/images/molecules/buttons-light.png",dark:"/images/molecules/buttons-dark.png"},displayName:"Buttons"};let n7=e=>(0,n.jsxs)(n1.W_,{canvas:!0,is:e.layout.HStack,justifyContent:"center",padding:"$4",children:[(0,n.jsx)(n1.W_,{canvas:!0,is:e.layout.ProtoView,children:(0,n.jsx)(n1.W_,{canvas:!0,is:e.text.Head1,children:"Default view"})}),(0,n.jsx)(n1.W_,{canvas:!0,is:e.layout.ProtoView,viewId:"view1",children:(0,n.jsx)(n1.W_,{canvas:!0,is:e.text.Head1,children:"Custom view 1"})})]});n7.craft={custom:{light:"/images/molecules/statetext-light.png",dark:"/images/molecules/statetext-dark.png"},displayName:"StateText"};let n9=e=>(0,n.jsxs)(n1.W_,{canvas:!0,is:e.layout.VStack,minWidth:"400px",borderWidth:"$0.25",borderColor:"$color9",children:[(0,n.jsxs)(n1.W_,{is:e.layout.VStack,padding:"$3",minWidth:"200px",flex:1,borderWidth:"$0.25",justifyContent:"center",borderColor:"$color9",children:[(0,n.jsx)(n1.W_,{is:e.text.Text,fontSize:18,color:"$color8",fontStyle:"italic",children:"First"}),(0,n.jsx)(n1.W_,{is:e.external.ObjectPropValue,fontSize:18,fontWeight:"600"})]}),(0,n.jsxs)(n1.W_,{is:e.layout.HStack,children:[(0,n.jsxs)(n1.W_,{is:e.layout.VStack,padding:"$3",minWidth:"200px",flex:1,borderWidth:"$0.25",justifyContent:"center",borderColor:"$color9",children:[(0,n.jsx)(n1.W_,{is:e.text.Text,fontSize:18,color:"$color8",fontStyle:"italic",children:"Second"}),(0,n.jsx)(n1.W_,{is:e.external.ObjectPropValue,fontSize:18,fontWeight:"600"})]}),(0,n.jsxs)(n1.W_,{is:e.layout.VStack,padding:"$3",minWidth:"200px",flex:1,borderWidth:"$0.25",justifyContent:"center",borderColor:"$color9",children:[(0,n.jsx)(n1.W_,{is:e.text.Text,fontSize:18,color:"$color8",fontStyle:"italic",children:"Third"}),(0,n.jsx)(n1.W_,{is:e.external.ObjectPropValue,fontSize:18,fontWeight:"600",object:"assemblyline"})]}),(0,n.jsxs)(n1.W_,{is:e.layout.VStack,padding:"$3",minWidth:"200px",flex:1,borderWidth:"$0.25",justifyContent:"center",borderColor:"$color9",children:[(0,n.jsx)(n1.W_,{is:e.text.Text,fontSize:18,color:"$color8",fontStyle:"italic",children:"Fourth"}),(0,n.jsx)(n1.W_,{is:e.external.ObjectPropValue,fontSize:18,fontWeight:"600",object:"assemblyline"})]})]})]});n9.craft={custom:{light:"/images/molecules/object-props-table-light.png",dark:"/images/molecules/object-props-table-dark.png"},displayName:"ObjectPropsTable"};let oe=F.forwardRef((e,t)=>(0,n.jsx)(A.Kq,{ref:t,backgroundColor:"$color4",padding:"$2",borderRadius:"$4",shadowRadius:"$3",shadowColor:"$shadowColor",shadowOffset:{width:0,height:8},cursor:"pointer",...e,hoverStyle:{backgroundColor:"$color5",...e.hoverStyle}}));var ot=r(46988);let or=(0,nB.A0)("protolib/components"),on={custom:{hidden:!0}},oo={custom:{shortcuts:[nX,{icon:e=>"text",menu:[{action:e=>{let{setProp:t}=e;return t(e=>e.textAlign="left")},name:"Align Text Left",selected:e=>"left"==e.textAlign},{action:e=>{let{setProp:t}=e;return t(e=>e.textAlign="center")},name:"Align Text Center",selected:e=>"center"==e.textAlign},{action:e=>{let{setProp:t}=e;return t(e=>e.textAlign="end")},name:"Align Text Right",selected:e=>"end"==e.textAlign},{action:e=>{let{setProp:t}=e;return t(e=>e.textAlign="stretch")},name:"Justify Text",selected:e=>"stretch"==e.textAlign}]},nQ,{icon:e=>"bold",selected:e=>"bold"==e.fontWeight,action:e=>{let{setProp:t}=e;return t(e=>("bold"==e.fontWeight?e.fontWeight="normal":e.fontWeight="bold",e))}}]}},ol={...or(rF,"type","Head1",{children:"hello"},oo,{},!0),...or(rr,"type","Head2",{children:"hello"},oo,{},!0),...or(ro,"type","Head3",{children:"hello"},oo,{},!0),...or(rE,"type","Text",{children:"hello"},oo,{},!0),...or(rl,"type","BlockTitle",{title:"hello",subtitle:"world"},{rules:{canMoveIn:()=>!1}}),...or(nw,"type","RainbowText",{children:"hello world",fontWeight:"bold",fontSize:"$16",lineHeight:"$16"},{},{},!0)},oa={...or(rD,"type","SensorValue",{},oo,{}),...or(rM,"type","ObjectPropValue",{},oo,{}),...or(rH,"type","ObjectForm",{model:{value:"Objects.",kind:"PropertyAccessExpression"}})},oi={...or(nJ,"layout","VStack",{},{},{children:(0,n.jsx)(nB.MY,{})}),...or(nZ,"layout","HStack",{},{},{children:(0,n.jsx)(nB.MY,{})}),...or(tM.Z,"layout","Center",{},{},{children:(0,n.jsx)(nB.MY,{})}),...or(nY,"Maximize2","Spacer",{size:"$8"}),...or(n0,"layout","ProtoView",{viewId:"default",currentView:{value:"currentView",kind:"Identifier"}},{},{placeholder:(0,n.jsx)(nB.MY,{})}),...or(nk.Z,"layout","Section",{},{},{children:(0,n.jsx)(nB.MY,{})}),...or(oe,"pressable","Pressable",{},{},{children:(0,n.jsx)(nB.MY,{})})};var os={basic:{...or(t9,"type","BigTitle",{children:"hello"},{custom:{shortcuts:[nQ]}},{},!0),...or(ri.Z,"pressable","ButtonSimple",{children:"Press Me"},{custom:{shortcuts:[nX],options:[{action:e=>{let{dom:t}=e;t.focus()},name:"Focus element"},{action:e=>{var t,r;let{dom:n,metadata:o,props:l}=e,a=Function(...Object.keys(o.context),"return "+(null!==(r=null===(t=l.onPress)||void 0===t?void 0:t.slice(1,-1))&&void 0!==r?r:""));l.onPress&&a(...Object.values(o.context))()},name:"Click element"}]}},{},!0),...or(rg.W2,"layout","Container",{},{custom:{shortcuts:[{icon:e=>{var t;return null!==(t=e.flexDirection)&&void 0!==t?t:"column"},menu:[{action:e=>{let{setProp:t}=e;return t(e=>e.flexDirection="row")},name:"Row",selected:e=>"row"==e.flexDirection},{action:e=>{let{setProp:t}=e;return t(e=>e.flexDirection="row-reverse")},name:"Row Reverse",selected:e=>"row-reverse"==e.flexDirection},{action:e=>{let{setProp:t}=e;return t(e=>e.flexDirection="column")},name:"Column",selected:e=>"column"==e.flexDirection},{action:e=>{let{setProp:t}=e;return t(e=>e.flexDirection="column-reverse")},name:"Column Reverse",selected:e=>"column-reverse"==e.flexDirection}]},{icon:e=>{var t;return null!==(t=e.justifyContent)&&void 0!==t?t:"center"},menu:[{action:e=>{let{setProp:t}=e;return t(e=>e.justifyContent="start")},name:"Justify Start",selected:e=>"start"==e.justifyContent},{action:e=>{let{setProp:t}=e;return t(e=>e.justifyContent="center")},name:"Justify Center",selected:e=>"center"==e.justifyContent},{action:e=>{let{setProp:t}=e;return t(e=>e.justifyContent="end")},name:"Justify End",selected:e=>"end"==e.justifyContent},{action:e=>{let{setProp:t}=e;return t(e=>e.justifyContent="space-between")},name:"Justify Space Between",selected:e=>"space-between"==e.justifyContent},{action:e=>{let{setProp:t}=e;return t(e=>e.justifyContent="space-around")},name:"Justify Space Around",selected:e=>"space-around"==e.justifyContent}]}]}},{children:(0,n.jsx)(nB.MY,{})}),...or(r4,"media","Image",{url:"/images/patterns/pattern-1.png"},{custom:{shortcuts:[nX,{icon:e=>"wallpaper",menu:[{action:e=>{let{setProp:t}=e;return t(e=>e.resizeMode="center")},name:"Center",selected:e=>"center"==e.resizeMode},{action:e=>{let{setProp:t}=e;return t(e=>e.resizeMode="contain")},name:"Contain",selected:e=>"contain"==e.resizeMode},{action:e=>{let{setProp:t}=e;return t(e=>e.resizeMode="cover")},name:"Cover",selected:e=>"cover"==e.resizeMode},{action:e=>{let{setProp:t}=e;return t(e=>e.resizeMode="repeat")},name:"Repeat",selected:e=>"repeat"==e.resizeMode},{action:e=>{let{setProp:t}=e;return t(e=>e.resizeMode="stretch")},name:"Stretch",selected:e=>"stretch"==e.resizeMode}]}]}},{},!0),...or(r2.II,"TextCursorInput","Input",{state:{value:"cs.inputValue",kind:"PropertyAccessExpression"}})},text:ol,layout:oi,external:oa,miscellany:{...or(t0.ZP,"EyeOff","ActiveGroup",{},on,{children:(0,n.jsx)(nB.MY,{})}),...or(t1.Z,"EyeOff","ActiveGroupButton",{},on),...or(t2.Z,"EyeOff","ActiveRender",{},on),...or(t5,"Tv2","AnounceBubble",{href:"/hello",children:"hello"}),...or(t8.Z,"CreditCard","AppBar"),...or(tD.Z,"EyeOff","AsyncView",{},on),...or(t6,"Scroll","BackgroundGradient"),...or(t7,"BarChartHorizontalBig","SimpleBarChart",{data:[{color:"$pink9",name:"one",value:.12},{color:"$purple9",name:"two",value:.063},{color:"$blue9",name:"three",value:.108},{color:"$orange9",name:"four",value:.73}],large:!0,animatedEnter:!1,selectedElement:"two"}),...or(ra.Z,"EyeOff","ButtonGroup",{},on,{children:(0,n.jsx)(nB.MY,{})}),...or(r8.ZP,"ExternalLink","ButtonLink",{href:"/hello",children:"hello"}),...or(rs,"Check","CheckCircle"),...or(ru,"Code","Code",{children:"helloworld"},{},{},!0),...or(rp,"Terminal","CodeInline",{children:"helloworld"},{},{},!0),...or(rg._k,"Package","ContainerLarge",{},{},{children:(0,n.jsx)(nB.MY,{})}),...or(rg.$o,"layout","ContainerXL",{},{},{children:(0,n.jsx)(nB.MY,{})}),...or(rh.L,"ToggleRight","ColorToggleButton"),...or(rx.f,"Copy","CopyBubble",{text:"copy"}),...or(rq.Z,"RectangleHorizontal","HorizontalBox",{},{},{children:(0,n.jsx)(nB.MY,{})}),...or(rv.I,"CreditCard","DataCard",{name:"hello title",maxWidth:"300px",json:{name:"hello",surname:"world"}},{rules:{canMoveIn:()=>!1}}),...or(rm,"Table2","DataTable",{title:"hello",rows:[["hello","world"],["world","hello"]]}),...or(rb.V,"EyeOff","DataView",{},{custom:{hidden:!0,options:[{action:e=>{let{dom:t}=e;t.querySelector("#tableView-list").click()},name:"Change to List View"},{action:e=>{var t;let{dom:r}=e;null===(t=r.querySelector("#tableView-grid"))||void 0===t||t.click()},name:"Change to Grid View"},{action:e=>{var t;let{dom:r}=e;null===(t=r.querySelector("#tableView-raw"))||void 0===t||t.click()},name:"Change to Raw View"}]}}),...or(ry.D,"LogoIcon","DiscordIcon",{width:23,plain:!0}),...or(r$,"PencilLine","EditableText",{description:"hello",text:"world"},{rules:{canMoveIn:()=>!1}}),...or(rw.Z,"GalleryThumbnails","ElevatedArea"),...or(j.Z,"AlertTriangle","ErrorMessage"),...or(rk,"CheckCircle2","FeatureItem",{label:"hello",children:"world"}),...or(rP,"SquareAsterisk","FancyCard"),...or(rj.E,"LogoIcon","GithubIcon",{width:23,plain:!0}),...or(rI.rj,"layout","Grid"),...or(rL,"layout","GridElement",{title:"hello",children:"world"}),...or(rU,"Link2","HeaderLink",{href:"/hello",children:"hello"}),...or(rX,"RectangleHorizontal","HoveredGroup",{},{},{children:(0,n.jsx)(nB.MY,{})}),...or(rQ,"MinusSquare","HR"),...or(ot.J,"LogoIcon","Icon",{name:"Bird"}),...or(r1,"SquareStack","IconStack"),...or(r5.q,"CreditCard","ItemCard",{children:"hello world!"},{},{},!0),...or(r8.rU,"Link","Link",{href:"/hello",children:"hello"}),...or(ne,"Group","LinkGroup",{href:"/hello",children:"hello"}),...or(r9,"Puzzle","LinkGroupItem",{href:"/hello",children:"hello"}),...or(r8.gs,"Link","ParagraphLink",{href:"/hello",children:"hello"}),...or(nr,"Cherry","Logo",{text:"protofy"}),...or(nn.K,"Hexagon","LogoIcon",{children:"hello world!"},{},{},!0),...or(no,"MousePointerSquare","MainButton",{children:"hello world!"},{},{},!0),...or(rB.p,"EyeOff","NextLink",{href:"/hello",children:"hello"},on),...or(nl.q,"Globe2","Notice",{children:"Hello world!"},{},{},!0),...or(na,"CreditCard","OverlayCard",{},{},{children:(0,n.jsx)(nB.MY,{})}),...or(ni,"CreditCard","OverlayCardBasic",{title:"Hello",subtitle:"Hello World!",caption:"go",href:"http://google.com"}),...or(ns.Z,"EyeOff","Page",{},on,{children:(0,n.jsx)(nB.MY,{})}),...or(m.D,"EyeOff","AdminPage",{},on),...or(nb,"EyeOff","PageGlow"),...or(ny.k,"Puzzle","PanelMenuItem",{text:"hello world"}),...or(n$,"EyeOff","Pre",{},on),...or(nS,"Search","Search"),...or(nA,"RectangleHorizontal","SectionBox",{},{},{children:(0,n.jsx)(nB.MY,{})}),...or(nz,"BoxSelect","SectionBlock"),...or(nI,"Link","TitleLink",{href:"/hello",children:"hello"}),...or(nL,"PanelLeftInactive","SideBySide"),...or(nR.Z,"Sun","SpotLight"),...or(nT,"Group","TabGroup",{title:"hello"}),...or(nE,"CreditCard","TamaCard",{title:"hello title",description:"description",children:"Lorem ipsum dolor sit amet"}),...or(N.eL,"Palette","ThemeTint"),...or(n_.T,"Palette","ThemeToggle",{chromeless:!0}),...or(nh,"BoxSelect","TintSection"),...or(nm,"BoxSelect","HomeSection"),...or(nO,"BoxSelect","TooltipContainer",{tooltipText:"Hello"}),...or(nD,"LogoIcon","TwitterIcon",{width:23}),...or(nN,"MessageCircle","UL",{children:"hello world"},{},{},!0),...or(nV,"Video","Video",{},{},{},!0),...or(nH,"AlignVerticalSpaceAround","HCenterStack"),...or(nK,"AlignVerticalSpaceAround","VCenterStack"),...or(el.a,"Group","AlertDialog",{},on)},html:nq};let oc={atoms:{basic:{...os.basic},text:{...os.text},layout:{...os.layout},external:{...os.external},html:{...os.html},miscellany:{...os.miscellany}},molecules:{basic:{Introduction:n4,Buttons:n6,FeaturedCategory:n3,ProductColumns:n2,Subscribe:n5,ObjectPropsTable:n9,StateText:n7},pages:{AboutUs:n8}}};var od=r(32248);let ou=tV()(()=>Promise.all([r.e(7788),r.e(7980),r.e(8328)]).then(r.bind(r,58328)),{loadableGenerated:{webpack:()=>[58328]},ssr:!1}),op=e=>{let{boardID:t,onDismiss:r,onAfterSave:o}=e,[l,a]=(0,F.useState)(!1),[i,s]=(0,F.useState)(),[c,d]=(0,F.useState)(""),[u,p]=(0,F.useState)(),h=(0,rV.Py)(),g={tamagui:(0,od.lz)(),context:{}},x=async e=>{let r=e;c&&!e.startsWith(c)&&(r="".concat(c,"\n").concat(e));let n=await f.API.post("/api/core/v1/boards/".concat(t,"/uicode"),{code:r});n&&n.data?(h.show("UI saved successfully"),o&&o({code:r})):n&&n.error&&h.show("Error saving UI",{tint:"red"})},v=async()=>{d(""),a(!0);let e=await f.API.get("/api/core/v1/boards/".concat(t,"/uicode"));if(e&&e.data){let t=e.data.code;s(t),(t.startsWith("//@")||t.startsWith("// @"))&&d(t.split("\n")[0])}a(!1)},m=e=>Object.entries(e).reduce((e,t)=>{var r;let[n,o]=t,l=null===(r=o.metadata)||void 0===r?void 0:r.visualui;return l&&(l.palette?(e[l.palette]||(e[l.palette]={}),e[l.palette]={...e[l.palette],...(0,nB.b)(o.component,n,o.metadata.visualui)}):(e.app||(e.app={}),e.app={...e.app,...(0,nB.b)(o.component,n,o.metadata.visualui)})),e},{});return(0,F.useEffect)(()=>{v()},[t]),(0,F.useEffect)(()=>{window&&window.ProtoComponents&&p(m(window.ProtoComponents))},[]),(0,n.jsx)(n.Fragment,{children:u&&!l?(0,n.jsx)(ou,{metadata:g,userPalettes:{atoms:{...u,hmtl:oc.atoms.html}},_sourceCode:i,onSave:x,onDismiss:r,contextAtom:void 0,settings:{editor:{getMainContent:e=>{let{ast:t,SyntaxKind:r}=e,n=t.getFunction("Widget");if(n){let e=n.getFirstDescendantByKind(r.JsxElement);if(e)return e}}}}}):(0,n.jsx)(w.FA,{jc:"center",ai:"center",f:1,children:(0,n.jsx)($.$,{})})})};var oh=r(65058);let og=(0,oh.cn)(null),ox=(0,oh.cn)(null),ov=(0,oh.cn)(null),of=async(e,t,r,n,o)=>{let l=await f.API.get("/api/core/v1/boards/".concat(e)),a=await f.API.get("/api/core/v1/boards/".concat(e,"/automation")),i=await f.API.get("/api/core/v1/boards/".concat(e,"/uicode"));if(n(a.data),o(i.data),"loaded"==l.status){var s;let e=((null===(s=l.data)||void 0===s?void 0:s.cards)||[]).filter(e=>e);e&&0!=e.length||(e=[]),t(e),r(l.data.version||1)}};var om=r(13742),ob=r(10281),oy=r(94595),oj=r(43158),o$=r(68918),ow=r(73147),oC=r(57909),oS=r(84549),ok=r(92613);let oA=tV()(()=>r.e(5373).then(r.bind(r,55373)).then(e=>e.ActionRunner),{loadableGenerated:{webpack:()=>[55373]},ssr:!1}),oP=e=>{let{Icon:t,onPress:r,...o}=e;return(0,n.jsx)(Y.I,{children:(0,n.jsx)(w.sL,{...o,right:-10,hoverStyle:{backgroundColor:"$backgroundFocus"},pressStyle:{backgroundColor:"$backgroundPress"},borderRadius:"$5",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:"$2",onPress:r,children:(0,n.jsx)(t,{size:20,onPress:r})})})},oI=e=>{var t,r;let{id:c,data:d,onEdit:u,onDelete:p,onEditCode:h,onCopy:g,onDetails:x,states:v,onMoveLayer:m,readOnly:b,executions:y=[],cancelExecution:j}=e,[$,C]=(0,F.useState)(!1),[A,P]=(0,F.useState)(!1),I=(0,F.useRef)(null),z=(null===(t=I.current)||void 0===t?void 0:t.offsetWidth)>200,[L,R]=(0,Q.jU)(),[T,_]=(0,F.useState)(!1),[W,D]=(0,F.useState)(!1),[N,V]=(0,F.useState)(""),H=(0,F.useRef)(null),[B,U]=(0,F.useState)(!1),[,q]=(0,F.useState)(0),J=y.length>0;(0,F.useEffect)(()=>{if(!J)return;let e=setInterval(()=>q(e=>e+1),1e3);return()=>clearInterval(e)},[J]);let Z=e=>{let t=Math.floor((Date.now()-e)/1e3);return t<60?"".concat(t,"s"):"".concat(Math.floor(t/60),"m ").concat(t%60,"s")},[X,ee]=(0,F.useState)(!1),[et,er]=(0,F.useState)(null!==(r=null==d?void 0:d.name)&&void 0!==r?r:""),[en,eo]=(0,F.useState)("boards"),[ea,ei]=(0,F.useState)("copytemplates"),[es,ec]=(0,F.useState)(""),ed=()=>{D(!0),setTimeout(()=>{var e;return null===(e=H.current)||void 0===e?void 0:e.focus()},0)},eu=e=>e.trim().replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-_]/g,"").slice(0,60)||"layer",ep=()=>{let e=eu(N);if(e){if(L.includes(e)){m(e),D(!1),V(""),_(!1),C(!1);return}R(t=>[...t,e]),m(e),D(!1),V(""),_(!1),C(!1)}},eh=e=>{let{text:t,Icon:r,onPress:o}=e;return(0,n.jsxs)(w.sL,{width:"100%",id:c,opacity:1,borderRadius:"$3",padding:"$2",paddingHorizontal:"$2.5",alignSelf:"flex-start",cursor:"pointer",pressStyle:{opacity:.7},hoverStyle:{backgroundColor:"$color5"},onPress:e=>{o(e),C(!1)},children:[(0,n.jsx)(r,{size:14,color:"var(--color9)",strokeWidth:2}),(0,n.jsx)(S.x,{marginLeft:"$2",fontSize:13,children:t})]})},ex=[{id:"params",text:b?"View Inputs":"Edit Inputs",icon:oj.S},{id:"output",text:b?"View Output":"Edit Output",icon:e=>(0,n.jsx)(oS.G,{...e,style:{transform:"scaleX(-1)"}})},{id:"rules",text:b?"View Rules":"Edit Rules",icon:eL.l},{id:"config",text:b?"View Settings":"Edit Settings",icon:a.Z},{id:"view",text:b?"View UI":"Edit UI",icon:eR.E},{id:"info",text:b?"View Description":"Edit Description",icon:G.k}].filter(e=>{var t,r;return!(null!==(r=null==d?void 0:null===(t=d.editorOptions)||void 0===t?void 0:t.hiddenTabs)&&void 0!==r?r:[]).includes(e.id)}),ev=v&&"string"!=typeof v&&"number"!=typeof v&&"boolean"!=typeof v,ef=window.location.origin,em=window.protoBoardName,eb=e=>{if(e)return/^https?:\/\//i.test(e)?e:"".concat(ef).concat(e.startsWith("/")?"":"/").concat(e)},ey=()=>(null==d?void 0:d.enableCustomPath)&&(null==d?void 0:d.customPath)?eb(d.customPath):"".concat(ef,"/api/core/v1/boards/").concat(em,"/cards/").concat(null==d?void 0:d.name),ej=()=>(null==d?void 0:d.enableCustomRunPath)&&(null==d?void 0:d.customRunPath)?eb(d.customRunPath):"".concat(ef,"/api/core/v1/boards/").concat(em,"/cards/").concat(null==d?void 0:d.name,"/run");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Y.I,{children:(0,n.jsxs)(w.sL,{ref:I,paddingTop:"$1",flex:1,paddingRight:"$4",justifyContent:z?"space-between":"flex-end",alignItems:"center",children:[(0,n.jsxs)(E.J2,{onOpenChange:P,open:A,allowFlip:!0,stayInFrame:!0,placement:"bottom-start",children:[(0,n.jsx)(E.J2.Trigger,{display:z?"block":"none",children:(0,n.jsx)(oP,{className:"no-drag",Icon:s.f,onPress:e=>{e.stopPropagation(),P(!0)}})}),(0,n.jsxs)(E.J2.Content,{gap:"$2",padding:0,ai:"flex-start",minWidth:"300px",maxWidth:"400px",minHeight:"100px",maxHeight:"500px",overflow:"auto",space:0,l:"$2",p:"$2",bw:1,boc:"$gray6",bc:"$gray1",children:[(0,n.jsxs)(w.sL,{justifyContent:"center",alignItems:"center",width:"100%",gap:"$2",flexWrap:"wrap-reverse",children:[(0,n.jsx)(S.x,{color:"$gray10",textAlign:"center",children:d.name}),(null==d?void 0:d.icon)&&(0,n.jsx)(eg.N1,{name:d.icon,color:"var(--gray10)",size:18})]}),(null==d?void 0:d.configParams)&&Object.keys(d.configParams).length>0&&(0,n.jsxs)(w.FA,{paddingLeft:"$2",gap:"$2",children:[(0,n.jsx)(S.x,{color:"$color",fontSize:"$3",children:"Inputs"}),(0,n.jsx)(w.sL,{flexWrap:"wrap",width:"100%",gap:"$2",children:Object.keys(d.configParams).map((e,t)=>{var r;return(0,n.jsx)(e3.w,{label:(null===(r=d.configParams[e])||void 0===r?void 0:r.defaultValue)||"No default value",delay:{open:200,close:0},restMs:0,children:(0,n.jsx)(w.FA,{cursor:"help",hoverStyle:{backgroundColor:"$gray5"},paddingHorizontal:"$3",paddingVertical:"$1",borderRadius:"$3",borderWidth:1,borderColor:"$gray4",backgroundColor:"$gray3",children:(0,n.jsx)(S.x,{fontWeight:"500",children:e})})},t)})})]}),(0,n.jsxs)(w.FA,{padding:"$2",gap:"$2",width:"100%",borderRadius:"$2",children:[(0,n.jsx)(S.x,{color:"$color",fontSize:"$3",children:"State"}),ev?(0,n.jsx)(M.W,{src:null!=v?v:{}}):(0,n.jsx)(S.x,{color:v?"$color":"$gray10",children:null!=v?v:"N/A"})]})]})]},"card-states"),(0,n.jsxs)(w.sL,{className:"no-drag",children:[(null==d?void 0:d.sourceFile)&&(0,n.jsx)(oP,{Icon:eQ.s,onPress:h}),y.length>0&&(0,n.jsxs)(E.J2,{open:B,onOpenChange:U,allowFlip:!0,stayInFrame:!0,placement:"bottom-end",children:[(0,n.jsx)(E.J2.Trigger,{children:(0,n.jsx)(oP,{Icon:ok.P,onPress:e=>{e.stopPropagation(),U(e=>!e)}})}),(0,n.jsx)(E.J2.Content,{padding:"$3",borderWidth:1,borderColor:"$gray6",backgroundColor:"$gray1",minWidth:220,children:(0,n.jsxs)(w.FA,{gap:"$2",children:[(0,n.jsxs)(S.x,{fontWeight:"600",fontSize:"$3",children:[y.length," execution",1!==y.length?"s":""," running"]}),y.map(e=>(0,n.jsxs)(w.sL,{gap:"$2",ai:"center",py:"$1",borderTopWidth:1,borderColor:"$gray4",children:[(0,n.jsxs)(w.FA,{flex:1,gap:"$1",children:[(0,n.jsxs)(S.x,{fontSize:"$2",color:"$gray11",children:["Elapsed: ",Z(e.startedAt)]}),e.contextId&&(0,n.jsxs)(S.x,{fontSize:"$1",color:"$gray9",children:["ctx: ",e.contextId.slice(0,8),"..."]})]}),(0,n.jsx)(w.sL,{cursor:"pointer",padding:"$1",borderRadius:"$3",hoverStyle:{backgroundColor:"$red4"},pressStyle:{backgroundColor:"$red5"},onPress:t=>{t.stopPropagation(),null==j||j(e.executionId)},children:(0,n.jsx)(i.X,{size:16,color:"$red10"})})]},e.executionId)),y.length>1&&(0,n.jsxs)(w.sL,{ai:"center",jc:"center",gap:"$2",py:"$2",mt:"$1",borderTopWidth:1,borderColor:"$gray4",cursor:"pointer",borderRadius:"$3",hoverStyle:{backgroundColor:"$red4"},pressStyle:{backgroundColor:"$red5"},onPress:e=>{e.stopPropagation(),y.forEach(e=>null==j?void 0:j(e.executionId))},children:[(0,n.jsx)(ok.P,{size:14,color:"$red10"}),(0,n.jsx)(S.x,{fontSize:"$2",color:"$red10",fontWeight:"600",children:"Stop all"})]})]})})]}),(0,n.jsxs)(E.J2,{onOpenChange:e=>{C(e),e||(_(!1),D(!1),V(""))},open:$,allowFlip:!0,stayInFrame:!0,placement:"bottom-end",children:[(0,n.jsx)(E.J2.Trigger,{children:(0,n.jsx)(oP,{Icon:ob.h,onPress:e=>{e.stopPropagation(),C(!0)}})}),(0,n.jsx)(E.J2.Content,{padding:0,space:0,left:"$7",top:"$2",borderWidth:1,borderColor:"$gray6",backgroundColor:"$gray1",children:(0,n.jsx)(Y.I,{children:(0,n.jsx)(w.FA,{alignItems:"center",justifyContent:"center",padding:"$2",onPress:e=>e.stopPropagation(),children:(0,n.jsxs)(w.FA,{children:[ex.map((e,t)=>(0,n.jsx)(eh,{text:e.text,Icon:e.icon,onPress:()=>u(e.id)},t)),!b&&(0,n.jsx)(w.sL,{width:"100%",height:1,backgroundColor:"$gray5",marginVertical:"$1.5"}),!b&&(0,n.jsx)(eh,{text:"Duplicate",Icon:o.C,onPress:()=>g()}),!b&&(0,n.jsxs)(E.J2,{open:T,onOpenChange:_,placement:"right-start",allowFlip:!0,stayInFrame:!0,children:[(0,n.jsx)(E.J2.Trigger,{children:(0,n.jsxs)(w.sL,{width:"100%",borderRadius:"$3",padding:"$2",paddingHorizontal:"$2.5",cursor:"pointer",pressStyle:{opacity:.7},hoverStyle:{backgroundColor:"$color5"},onPress:e=>{e.stopPropagation(),_(e=>!e)},children:[(0,n.jsx)(oC.S,{size:14,color:"var(--color9)",strokeWidth:2}),(0,n.jsx)(S.x,{marginLeft:"$2",fontSize:13,children:"Move to layer"})]})}),(0,n.jsx)(E.J2.Content,{padding:"$1.5",gap:"$1",borderWidth:1,borderColor:"$gray6",backgroundColor:"$gray1",children:(0,n.jsxs)(w.FA,{gap:"$0.5",children:[null==L?void 0:L.map(e=>{var t;let r=(null!==(t=null==d?void 0:d.layer)&&void 0!==t?t:"base")===e;return(0,n.jsxs)(w.sL,{ai:"center",jc:"space-between",padding:"$1.5",paddingHorizontal:"$2",br:"$3",f:1,w:"100%",cursor:"pointer",hoverStyle:{backgroundColor:"$color5"},pressStyle:{opacity:.7},onPress:()=>{m(e),_(!1),C(!1),D(!1),V("")},children:[(0,n.jsx)(S.x,{fontSize:13,children:e}),r&&(0,n.jsx)(K.J,{size:14,color:"var(--color10)"})]},e)}),W?(0,n.jsxs)(w.sL,{ai:"center",gap:"$2",padding:"$1.5",paddingHorizontal:"$2",br:"$3",backgroundColor:"$gray2",children:[(0,n.jsx)(l.v,{size:14}),(0,n.jsx)(O.II,{ref:H,value:N,onChangeText:V,placeholder:"New layer name…",flex:1,fontSize:13,onKeyPress:e=>{"Enter"===e.key&&ep()}}),(0,n.jsx)(k.zx,{size:"$2",onPress:ep,bc:"$color7",color:"white",hoverStyle:{bc:"$color9"},children:"Add"})]}):(0,n.jsxs)(w.sL,{ai:"center",gap:"$2",padding:"$1.5",paddingHorizontal:"$2",br:"$3",cursor:"pointer",hoverStyle:{backgroundColor:"$color5"},pressStyle:{opacity:.7},onPress:e=>{e.stopPropagation(),ed()},children:[(0,n.jsx)(l.v,{size:14}),(0,n.jsx)(S.x,{fontSize:13,children:"Create new layer"})]})]})})]}),!b&&(0,n.jsx)(eh,{text:"Add card to palette",Icon:l.v,onPress:()=>{var e,t,r,n;er(null!==(e=null==d?void 0:d.name)&&void 0!==e?e:""),eo(null!==(t=null==d?void 0:d.group)&&void 0!==t?t:"boards"),ei(null!==(n=null!==(r=null==d?void 0:d.tag)&&void 0!==r?r:em)&&void 0!==n?n:"tag"),ec(""),ee(!0)}}),(0,n.jsx)(w.sL,{width:"100%",height:1,backgroundColor:"$gray5",marginVertical:"$1.5"}),(0,n.jsx)(eh,{text:"Api Details",Icon:oy.p,onPress:()=>x()}),(null==d?void 0:d.publicRead)&&(0,n.jsx)(eh,{text:"Visit public Read",Icon:ow.T,onPress:()=>window.open(ey(),"_blank","noopener,noreferrer")}),(null==d?void 0:d.publicRun)&&(0,n.jsx)(eh,{text:"Visit public Run",Icon:o$.d,onPress:()=>window.open(ej(),"_blank","noopener,noreferrer")}),!b&&(0,n.jsx)(w.sL,{width:"100%",height:1,backgroundColor:"$gray5",marginVertical:"$1.5"}),!b&&(0,n.jsx)(eh,{text:"Delete",Icon:om.V,onPress:()=>p()})]})})})})]},"card-menu")]})]})}),(0,n.jsx)(el.a,{open:X,setOpen:ee,title:"Add card to palette",acceptCaption:"Create",showCancel:!0,hideAccept:!1,style:{backgroundColor:"var(--bgContent)"},overlayProps:{onMouseDown:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation()},onMouseDown:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),onAccept:async()=>{var e,t,r,n,o,l;ec("");let a=(et||"card").trim(),i=(en||"boards").trim(),s=(ea||"copytemplates").trim();if(!a)return ec("Please enter a template name"),!0;if(!i)return ec("Please enter a group"),!0;if(!s)return ec("Please enter a tag"),!0;let c="".concat(i,".").concat(s,".").concat(a),u={defaults:{type:null!==(e=null==d?void 0:d.type)&&void 0!==e?e:"action",icon:null==d?void 0:d.icon,rulesCode:null==d?void 0:d.rulesCode,params:null!==(t=null==d?void 0:d.params)&&void 0!==t?t:{},configParams:null!==(r=null==d?void 0:d.configParams)&&void 0!==r?r:{},html:null==d?void 0:d.html,description:null!==(n=null==d?void 0:d.description)&&void 0!==n?n:"",displayResponse:null==d?void 0:d.displayResponse,width:null==d?void 0:d.width,height:null==d?void 0:d.height,presets:null==d?void 0:d.presets,tokens:null==d?void 0:d.tokens,displayButton:null==d?void 0:d.displayButton,editorOptions:null==d?void 0:d.editorOptions,name:a},readme:null!==(o=null==d?void 0:d.readme)&&void 0!==o?o:void 0,name:a,id:c,group:i,tag:s,templateName:a},p=await f.API.post("/api/core/v1/cards",u);if((null==p?void 0:p.isError)||(null==p?void 0:p.error)){let e=(null===(l=p.error)||void 0===l?void 0:l.error)||p.error||"Unknown error";return"Already exists"===e?ec("A template with this name already exists"):ec("string"==typeof e?e:JSON.stringify(e)),!0}return C(!1),!1},children:(0,n.jsxs)(w.FA,{gap:"$4",width:350,children:[(0,n.jsxs)(w.FA,{gap:"$2",children:[(0,n.jsx)(S.x,{fontSize:"$2",color:"$gray10",children:"Group"}),(0,n.jsx)(O.II,{value:en,onChangeText:eo,placeholder:"Group (e.g. boards)"})]}),(0,n.jsxs)(w.FA,{gap:"$2",children:[(0,n.jsx)(S.x,{fontSize:"$2",color:"$gray10",children:"Tag"}),(0,n.jsx)(O.II,{value:ea,onChangeText:ei,placeholder:"Tag (e.g. copytemplates)"})]}),(0,n.jsxs)(w.FA,{gap:"$2",children:[(0,n.jsx)(S.x,{fontSize:"$2",color:"$gray10",children:"Name"}),(0,n.jsx)(O.II,{value:et,onChangeText:er,placeholder:"Template name"})]}),es&&(0,n.jsx)(S.x,{color:"$red10",fontSize:"$3",children:es})]})})]})};var oz=r(71531);r(47687);var oL=r(69668),oR=r(65503),oF=r(64335),oT=r(89560),oE=r(93793),o_=r(73992),oW=r(10584),oO=r(83298);function oD(e){var t,r,o,l,a,i;let{boardId:s}=e,{goToVersion:c,versions:d,refresh:u}=(0,oO.lV)(s);(0,eO.Fg)();let[p]=(0,Q.Dz)(),[h,g]=(0,F.useState)(!1),[x,v]=(0,F.useState)(null),[f,m]=(0,F.useState)(""),[b,y]=(0,F.useState)(""),j=e=>{let t=new Date(Number(e));return isNaN(t.getTime())?"Fecha no v\xe1lida":t.toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})},$=e=>{var t,r;v(e),m(null!==(t=e.tag)&&void 0!==t?t:""),y(null!==(r=e.comment)&&void 0!==r?r:""),g(!0)},k=async()=>{x&&(await (0,oO.Un)(s,x.version,{tag:f,comment:b}),await u())},A=e=>{switch(e){case"Adds":return{Icon:oE.F,color:"var(--green9)"};case"Removes":return{Icon:o_.S,color:"var(--red9)"};case"Edits":return{Icon:oW.Y,color:"var(--yellow9)"};default:return{Icon:oF.S,color:"var(--gray8)"}}};return(0,n.jsxs)(D.p,{flex:1,width:"100%",height:"100%",overflow:"auto",children:[(0,n.jsx)(Y.I,{children:(0,n.jsx)(oz.VerticalTimeline,{animate:!1,lineColor:"var(--gray6)",children:[...d].reverse().map(e=>{let t=p===e.version;return(0,n.jsxs)(oz.VerticalTimelineElement,{date:j(e.savedAt),icon:t?(0,n.jsx)(oR.f,{}):(0,n.jsx)(oF.S,{}),iconStyle:{background:t?"var(--color6)":"var(--gray6)",color:"var(--color8)",boxShadow:"none"},contentStyle:{background:"var(--bgContent)",color:t?"var(--color8)":"var(--color)",borderRadius:12,padding:"14px 16px",border:t?"1px solid color-mix(in oklab, var(--color6) 35%, transparent)":"1px solid var(--gray5)",boxShadow:t?"0 0 0 1px color-mix(in oklab, var(--color6) 25%, transparent), 0 6px 20px rgba(0,0,0,.18)":"0 4px 18px rgba(0,0,0,.15)",backgroundImage:t?"linear-gradient(0deg, color-mix(in oklab, var(--color6) 5%, transparent), transparent)":"none",transition:"all 0.2s ease"},contentArrowStyle:{borderRightColor:"var(--bgContent)"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsxs)(w.sL,{ai:"center",space:"$2",children:[(0,n.jsxs)("h3",{style:{margin:0,fontWeight:700},children:["Version ",e.version]}),(0,n.jsx)(V.z,{Icon:oT.z,size:20,onPress:()=>$(e)})]}),!t&&(0,n.jsx)(V.z,{Icon:oL.V,size:24,onPress:async()=>{try{await c(e.version)}catch(e){console.error(e)}}})]}),e.tag&&(0,n.jsx)(w.sL,{ai:"center",mt:"$2",children:(0,n.jsx)(Y.I,{tint:"yellow",br:"$10",px:"$2",py:"$1",children:(0,n.jsxs)(S.x,{fontSize:12,color:"var(--color9)",children:["\uD83C\uDFF7️ ",e.tag]})})}),(0,n.jsx)("hr",{style:{border:"none",borderTop:"1px solid var(--gray5)",margin:"6px 0"}}),(0,n.jsxs)(C.n,{size:"$3",mt:8,mb:0,color:t?"var(--color8)":"var(--color)",children:[(0,n.jsx)(w.sL,{children:(0,n.jsxs)(S.x,{children:["Total cards: ",e.cards.length]})}),(0,n.jsxs)(w.sL,{ai:"center",space:"$2",mt:"$1",children:[(()=>{let{Icon:t,color:r}=A(e.change.type);return(0,n.jsx)(t,{size:16,color:r})})(),(0,n.jsx)(S.x,{children:"".concat(e.change.type," card ").concat(e.change.card)})]}),e.comment&&(0,n.jsx)(w.sL,{mt:"$2",bg:"var(--gray4)",br:"$6",px:"$3",py:"$2",children:(0,n.jsxs)(S.x,{fontSize:13,color:"var(--color8)",children:["\uD83D\uDCAC ",e.comment]})})]})]},e.version)})})}),(0,n.jsx)(el.a,{open:h,setOpen:g,showCancel:!0,acceptCaption:"Save",acceptTint:"green",cancelTint:"gray",title:"Version ".concat(null==x?void 0:x.version),description:"Cards: ".concat(null!==(l=null==x?void 0:null===(t=x.cards)||void 0===t?void 0:t.length)&&void 0!==l?l:0," | Change: ").concat(null!==(a=null==x?void 0:null===(r=x.change)||void 0===r?void 0:r.type)&&void 0!==a?a:"N/A"," ").concat(null!==(i=null==x?void 0:null===(o=x.change)||void 0===o?void 0:o.card)&&void 0!==i?i:""),onAccept:async()=>(await k(),!1),children:(0,n.jsxs)(w.FA,{space:"$3",width:"100%",children:[(0,n.jsx)(eu.__,{children:"Tag"}),(0,n.jsx)(O.II,{value:f,onChangeText:m,placeholder:"e.g. stable, milestone, beta"}),(0,n.jsx)(eu.__,{children:"Comment"}),(0,n.jsx)(O.II,{multiline:!0,value:b,onChangeText:y,placeholder:"Describe what changed or why this version matters"})]})})]})}let oM=e=>{if(!(null==e?void 0:e.length))return 0;let t=[...e].sort((e,t)=>e-t),r=Math.floor(t.length/2);return t.length%2?t[r]:(t[r-1]+t[r])/2},oN=e=>{let{cards:t,edges:r,hPixelRatio:n,vPixelRatio:o,marginX:l=120,marginY:a=60}=e,i=(t||[]).filter(e=>null==e?void 0:e.name),s=i.map(e=>e.name),c=new Set(s),d=new Map(i.map(e=>{var t;return[e.name,null!==(t=e.graphOrder)&&void 0!==t?t:0]})),u=new Map(i.map(e=>{var t,r;return[e.name,{width:(null!==(t=e.width)&&void 0!==t?t:2)*n,height:(null!==(r=e.height)&&void 0!==r?r:7)*o}]})),p=(r||[]).filter(e=>c.has(e.source)&&c.has(e.target)),{order:h,forward:g}=function(e,t,r,n){let o=new Map(e.map(e=>[e,0])),l=new Map(e.map(e=>[e,0])),a=new Map(e.map(e=>[e,new Set])),i=new Map(e.map(e=>[e,new Set]));for(let e of t)r.has(e.source)&&r.has(e.target)&&(a.get(e.source).add(e.target),i.get(e.target).add(e.source),l.set(e.source,(l.get(e.source)||0)+1),o.set(e.target,(o.get(e.target)||0)+1));let s=new Set(e),c=[],d=[],u=e=>{for(let t of(s.delete(e),a.get(e)))o.set(t,(o.get(t)||0)-1),i.get(t).delete(e);for(let t of i.get(e))l.set(t,(l.get(t)||0)-1),a.get(t).delete(e)};for(;s.size;){let e=!1,t=[...s].filter(e=>0===(l.get(e)||0));if(t.length){for(let e of(t.sort((e,t)=>{var r,a;let i=null!==(r=null==n?void 0:n.get(e))&&void 0!==r?r:0,s=null!==(a=null==n?void 0:n.get(t))&&void 0!==a?a:0;return i!==s?i-s:(l.get(e)||0)-(o.get(e)||0)-((l.get(t)||0)-(o.get(t)||0))||(e<t?-1:e>t?1:0)}),t))u(e),d.push(e);e=!0}let r=[...s].filter(e=>0===(o.get(e)||0));if(r.length){for(let e of(r.sort((e,t)=>{var r,a;let i=null!==(r=null==n?void 0:n.get(e))&&void 0!==r?r:0,s=null!==(a=null==n?void 0:n.get(t))&&void 0!==a?a:0;if(i!==s)return s-i;let c=(l.get(e)||0)-(o.get(e)||0);return(l.get(t)||0)-(o.get(t)||0)-c||(e<t?-1:e>t?1:0)}),r))u(e),c.push(e);e=!0}if(e)continue;let a=null,i=-1/0,h=-1/0;for(let e of s){var p;let t=null!==(p=null==n?void 0:n.get(e))&&void 0!==p?p:0,r=(l.get(e)||0)-(o.get(e)||0);(t>i||t===i&&r>h)&&(i=t,h=r,a=e)}null!=a&&(u(a),c.push(a))}let h=c.concat(d.reverse()),g=new Map(h.map((e,t)=>[e,t])),x=[],v=[];for(let e of t)r.has(e.source)&&r.has(e.target)&&(g.get(e.source)<=g.get(e.target)?x.push(e):v.push(e));return{order:h,index:g,forward:x,back:v}}(s,p,c,d),x=new Map(s.map(e=>[e,[]])),v=new Map(s.map(e=>[e,[]]));for(let e of g)x.get(e.target).push(e.source),v.get(e.source).push(e.target);let f=new Map(s.map(e=>[e,0]));for(let e of h){let t=x.get(e);t.length?f.set(e,Math.max(...t.map(e=>{var t;return(null!==(t=f.get(e))&&void 0!==t?t:0)+1}))):f.set(e,0)}let m=Array.from({length:Math.max(0,...f.values())+1},()=>[]);for(let e of s)m[f.get(e)].push(e);let b=new Map(s.map(e=>[e,0]));for(let e of p)b.set(e.source,(b.get(e.source)||0)+1),b.set(e.target,(b.get(e.target)||0)+1);let y=s.filter(e=>0===(b.get(e)||0));if(y.length){for(let e of y){let t=m[f.get(e)],r=t.indexOf(e);r>=0&&t.splice(r,1)}for(let e=m.length-1;e>=0;e--)m[e].length||m.splice(e,1);y.sort((e,t)=>{var r,n;return(null!==(r=d.get(e))&&void 0!==r?r:1/0)-(null!==(n=d.get(t))&&void 0!==n?n:1/0)});let e=Math.ceil(y.length/6);for(let t=0;t<6;t++){let r=[];for(let n=0;n<e;n++){let e=6*n+t;e<y.length&&r.push(y[e])}if(r.length)for(let e of(m.push(r),r))f.set(e,m.length-1)}}for(let e of(!function(e,t,r,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:8;for(let l=0;l<o;l++){let o=l%2==0,a=o?t:r;for(let t=o?1:e.length-2;o?t<e.length:t>=0;o?t++:t--){let r=new Map((o?e[t-1]:e[t+1]).map((e,t)=>[e,t])),l=e[t].map(e=>{var t;let o=(a.get(e)||[]).filter(e=>r.has(e)).map(e=>r.get(e)),l=o.length?oM(o):null!==(t=n.get(e))&&void 0!==t?t:0;return{id:e,score:l,has:o.length>0}});l.sort((e,t)=>e.has!==t.has?e.has?-1:1:e.score!==t.score?e.score-t.score:n.get(e.id)-n.get(t.id)),e[t]=l.map(e=>e.id)}}}(m,x,v,new Map([...s].sort((e,t)=>{var r,n;return(null!==(r=d.get(t))&&void 0!==r?r:0)-(null!==(n=d.get(e))&&void 0!==n?n:0)}).map((e,t)=>[e,t])),8),m))e.sort((e,t)=>{var r,n;return(null!==(r=d.get(t))&&void 0!==r?r:0)-(null!==(n=d.get(e))&&void 0!==n?n:0)});let j=function(e,t,r,n,o){var l,a;let i=new Map;for(let t=0;t<e.length;t++){let r=e[t],a=0;for(let e of r){i.set(e,a);let t=n.get(e);a+=(null!==(l=null==t?void 0:t.height)&&void 0!==l?l:300)+o}}for(let r=0;r<2;r++)for(let r=1;r<e.length;r++)for(let n of e[r]){let e=(t.get(n)||[]).filter(e=>i.has(e)).map(e=>i.get(e));if(!e.length)continue;let r=e.reduce((e,t)=>e+t,0)/e.length,o=null!==(a=i.get(n))&&void 0!==a?a:0;i.set(n,.8*o+.2*r)}return i}(m,x,0,u,a),$=new Map,w=0;for(let e of m){let t=0;for(let r of e){var C;$.set(r,w);let e=u.get(r);t=Math.max(t,null!==(C=null==e?void 0:e.width)&&void 0!==C?C:400)}w+=t+l}let S={};for(let e of s){let t=$.get(e),r=j.get(e);if(void 0===t||void 0===r){let t=w,r=Object.keys(S).length*(200+a);S[e]={x:t,y:r},w+=400+l}else S[e]={x:t,y:r}}return{positions:S,sizes:u}};var oV=r(91477),oH=r(66270);r(76977);let oB={GROUP_PADDING:100,GROUP_HEADER_HEIGHT:60,GROUP_BG:"rgba(0,0,0,0.04)",LAYER_VERTICAL_GAP:200,BASE_LAYER_IN_GROUP:!0,RIGHT_MARGIN_EXTRA:60,GROUP_EXTRA_BOTTOM:20,VIEWPORT:{x:-150,y:0,zoom:.35},FITVIEW_PADDING:.2,NODE_DEFAULT_SIZE:{width:300,height:210},LAYOUT:{hPixelRatio:200,vPixelRatio:50,marginX:120,marginY:60}},oG=oB.GROUP_PADDING+oB.GROUP_HEADER_HEIGHT,oU={width:"100%",height:"100%",borderRadius:8,display:"flex",backgroundColor:"var(--bgPanel)",textAlign:"left",alignItems:"flex-start",color:"var(--color)",position:"relative",transition:"border 0.2s ease, box-shadow 0.2s ease"},oq={...oU,border:"2px solid var(--color9)",boxShadow:"0 8px 24px rgba(0,0,0,0.25), 0 0 0 2px var(--color9)",zIndex:1e3},oJ={...oU,border:"1px solid var(--gray6)",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",zIndex:1},oZ={width:"100%",height:"100%",borderRadius:12,background:oB.GROUP_BG,position:"relative",zIndex:0,pointerEvents:"none"},oK={position:"absolute",top:0,left:0,right:0,height:oB.GROUP_HEADER_HEIGHT,display:"flex",padding:"0 12px",fontSize:.4*oB.GROUP_HEADER_HEIGHT,fontWeight:600,color:"var(--gray11)",background:"var(--bgPanel)",borderTopLeftRadius:12,borderTopRightRadius:12,borderBottom:"1px solid rgba(0,0,0,0.08)",pointerEvents:"auto",alignItems:"center",cursor:"auto"},oY="purple",oX="color",oQ=e=>{var t,r,n,o,l,a,i,s;return{width:null!==(a=null!==(l=null==e?void 0:null===(t=e.measured)||void 0===t?void 0:t.width)&&void 0!==l?l:parseFloat(null==e?void 0:null===(r=e.style)||void 0===r?void 0:r.width))&&void 0!==a?a:oB.NODE_DEFAULT_SIZE.width,height:null!==(s=null!==(i=null==e?void 0:null===(n=e.measured)||void 0===n?void 0:n.height)&&void 0!==i?i:parseFloat(null==e?void 0:null===(o=e.style)||void 0===o?void 0:o.height))&&void 0!==s?s:oB.NODE_DEFAULT_SIZE.height}},o0=e=>{let t=new Map;for(let n of e){var r;let e=n.layer||"base";(null!==(r=t.get(e))&&void 0!==r?r:t.set(e,[]).get(e)).push(n)}return t},o1=(e,t,r)=>{let n=t.filter(t=>{var r;return t.source===e&&(null===(r=t.data)||void 0===r?void 0:r.linkType)==="pre"}).length>0,o=t.filter(t=>{var r;return t.target===e&&(null===(r=t.data)||void 0===r?void 0:r.linkType)==="pre"}).length>0,l=t.filter(t=>{var r,n;return t.source===e&&((null===(r=t.data)||void 0===r?void 0:r.linkType)==="post"||(null===(n=t.data)||void 0===n?void 0:n.linkType)==="code")}).length>0,a=t.filter(t=>{var r,n;return t.target===e&&((null===(r=t.data)||void 0===r?void 0:r.linkType)==="post"||(null===(n=t.data)||void 0===n?void 0:n.linkType)==="code")}).length>0,i="action"===r;return{hasPreOut:n,hasPreIn:o,hasPostOut:i||l,hasPostIn:i||a}},o2=e=>{let t=new Set(e.map(e=>e.name)),r=[],n=new Map;for(let a of e){var o,l;let e;let i=[...a.links||[]],s=/executeAction\(\s*\{\s*name:\s*["']([\w-]+)["']/g;for(;null!==(e=s.exec(null!==(o=a.rulesCode)&&void 0!==o?o:""));)e[1]&&t.has(e[1])&&i.push({name:e[1],type:"code"});for(let e of i){if(!(null==e?void 0:e.name)||!t.has(e.name))continue;let o="".concat(a.name,"->").concat(e.name),i=null!==(l=n.get(o))&&void 0!==l?l:0;n.set(o,i+1);let s="pre"===e.type,c="code"===e.type,d=s?"var(--".concat(oY,"9)"):"var(--".concat(oX,"9)"),u=s?"pre-out":"post-out",p=s?"pre-in":"post-in";r.push({id:i?"".concat(o,"#").concat(i):o,source:a.name,target:e.name,sourceHandle:u,targetHandle:p,type:"curvy",data:{linkType:e.type||"pre"},selectable:!c,focusable:!c,...s?{markerEnd:"arrow-pre-backward"}:{markerEnd:{type:oV.QZ.ArrowClosed,width:12,height:12,color:d}},style:{stroke:d,strokeWidth:2,strokeDasharray:s?"6 3":void 0,opacity:c?.4:1}})}}return r},o3=()=>{try{let e=new URLSearchParams(window.location.search);if(!e.has("x")||!e.has("y")||!e.has("zoom"))return null;let t=Number(e.get("x")),r=Number(e.get("y")),n=Number(e.get("zoom"));return Number.isFinite(t)&&Number.isFinite(r)&&Number.isFinite(n)?{x:t,y:r,zoom:n}:null}catch(e){return null}},o4=e=>{try{let t=new URL(window.location.href);t.searchParams.set("x",(Math.round(100*e.x)/100).toString()),t.searchParams.set("y",(Math.round(100*e.y)/100).toString()),t.searchParams.set("zoom",(Math.round(1e3*e.zoom)/1e3).toString()),window.history.replaceState({},"",t.toString())}catch(e){}},o5=(e,t)=>{if(e===t)return!0;if(!e||!t)return!1;let r=Object.keys(e);return r.length===Object.keys(t).length&&r.every(r=>{let n=e[r],o=t[r];return o&&n.x===o.x&&n.y===o.y&&n.width===o.width&&n.height===o.height&&n.layer===o.layer&&n.parent===o.parent&&n.type===o.type})},o8=(e,t)=>({width:10,height:10,backgroundColor:"var(--".concat(e).concat(t?7:4,")"),border:"2px solid var(--".concat(e).concat(t?9:7,")"),borderRadius:t?2:"50%"}),o6=o8(oY,!0),o7=o8(oY,!1),o9=o8(oX,!0),le=o8(oX,!1),lt=(0,F.memo)(e=>{var t,r,o,l;let{data:a,selected:i}=e,s=null==a?void 0:a.ports,c=null!==(t=null==s?void 0:s.hasPreOut)&&void 0!==t&&t,d=null!==(r=null==s?void 0:s.hasPostIn)&&void 0!==r&&r,u=null!==(o=null==s?void 0:s.hasPreIn)&&void 0!==o&&o,p=null!==(l=null==s?void 0:s.hasPostOut)&&void 0!==l&&l,h=(c?1:0)+(d?1:0),g=(u?1:0)+(p?1:0),x=(0,F.useCallback)(e=>{let t=e.tagName.toLowerCase();return!!("input"===t||"button"===t||"select"===t||"textarea"===t||"a"===t||e.closest('button, a, input, select, textarea, [role="button"], [role="checkbox"], [role="radio"], [role="switch"], [role="slider"], [role="combobox"], [role="menuitem"], [role="tab"]')||e.hasAttribute("data-clickable")||e.closest('[data-clickable="true"]'))||!!e.isContentEditable},[]),v=(0,F.useCallback)(e=>{x(e.target)&&e.stopPropagation()},[x]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(oH.pM,{minWidth:180,minHeight:120,isVisible:!(null==a?void 0:a.readOnly),color:"transparent",handleStyle:{width:30,height:30,borderRadius:3,backgroundColor:"transparent",opacity:0}}),(0,n.jsxs)("div",{style:i?oq:oJ,onMouseDown:v,onPointerDown:v,onClick:v,children:[a.content,c&&(0,n.jsx)(oH.HH,{id:"pre-out",type:"source",position:oV.Ly.Left,style:{...o6,top:2===h?"30%":"50%"}}),d&&(0,n.jsx)(oH.HH,{id:"post-in",type:"target",position:oV.Ly.Left,style:{...le,top:2===h?"70%":"50%"}}),u&&(0,n.jsx)(oH.HH,{id:"pre-in",type:"target",position:oV.Ly.Right,style:{...o7,top:2===g?"30%":"50%"}}),p&&(0,n.jsx)(oH.HH,{id:"post-out",type:"source",position:oV.Ly.Right,style:{...o9,top:2===g?"70%":"50%"}})]})]})}),lr=(0,F.memo)(e=>{let{data:t}=e,[r,o]=(0,F.useState)(!1),l=r?"color8":(null==t?void 0:t.isActiveLayer)?"gray8":"gray6";return(0,n.jsx)("div",{className:"layer-group",style:{...oZ,border:"3px solid var(--".concat(l,")")},children:(0,n.jsx)("div",{style:oK,className:"layer-group-header",onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:null==t?void 0:t.label})})}),ln=(0,F.memo)(e=>{var t,r,o,l,a,i,s,c;let[d]=(0,oV.OQ)({...e,curvature:.4}),u=e.selected,p=(null===(t=e.data)||void 0===t?void 0:t.linkType)==="code",h=(null===(r=e.style)||void 0===r?void 0:r.stroke)||"var(--edgeDefault, var(--color5))",g=(null===(o=e.style)||void 0===o?void 0:o.strokeWidth)||2;return p?(0,n.jsx)("path",{id:e.id,className:"react-flow__edge-path",d:d,markerEnd:e.markerEnd,markerStart:e.markerStart,style:{stroke:h,strokeWidth:g,strokeDasharray:null===(a=e.style)||void 0===a?void 0:a.strokeDasharray,opacity:null!==(s=null===(i=e.style)||void 0===i?void 0:i.opacity)&&void 0!==s?s:1,fill:"none",pointerEvents:"none"}}):(0,n.jsx)(oH.u5,{id:e.id,path:d,markerEnd:e.markerEnd,markerStart:e.markerStart,interactionWidth:20,style:{stroke:h,strokeWidth:g,strokeDasharray:u?void 0:"6 4",opacity:null!==(c=null===(l=e.style)||void 0===l?void 0:l.opacity)&&void 0!==c?c:1,transition:"stroke-dasharray 0.15s ease"}})}),lo={default:lt,layerGroup:lr},ll={curvy:ln},la=(e,t)=>oN({cards:e,edges:t,...oB.LAYOUT}),li=(e,t,r)=>{let n=1/0,o=1/0,l=-1/0,a=-1/0;for(let i of e){let e=r.get(i.name),s=t[i.name];n=Math.min(n,s.x),o=Math.min(o,s.y),l=Math.max(l,s.x+e.width),a=Math.max(a,s.y+e.height)}return{minX:n,minY:o,width:Math.max(0,l-n),height:Math.max(0,a-o)}},ls=function(e,t,r,n,o,l,a){let i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{x:0,y:0},s=arguments.length>8?arguments[8]:void 0,c=e.reduce((e,t)=>{let n=null==o?void 0:o[t.name];if(!n||n.layer&&l&&n.layer!==l)return e;let a=r.get(t.name);return{maxX:Math.max(e.maxX,n.x+a.width),valid:!0}},{maxX:-1/0,valid:!1}),d=c.valid?c.maxX:null;return e.map(e=>{var c,u;let p,h;let g=r.get(e.name),x=t[e.name],v=null==o?void 0:o[e.name];!v||v.layer&&l&&v.layer!==l?(p=null!==d?d+.6*oB.LAYOUT.marginX:a?x.x-i.x+oB.GROUP_PADDING:x.x,h=a?x.y-i.y+oG:x.y+i.y):(p=v.x,h=v.y);let f=null!==(c=null==v?void 0:v.width)&&void 0!==c?c:g.width,m=null!==(u=null==v?void 0:v.height)&&void 0!==u?u:g.height;return{id:e.name,type:"default",parentId:a,position:{x:p,y:h},data:{...e,ports:o1(e.name,n,e.type),readOnly:s},style:{width:"".concat(f,"px"),height:"".concat(m,"px"),background:"transparent"}}})},lc=(e,t,r,n,o,l)=>{let{positions:a,sizes:i}=la(t,r),{minX:s,minY:c,width:d,height:u}=li(t,a,i);if(!oB.BASE_LAYER_IN_GROUP&&"base"===e)return{contentNodes:ls(t,a,i,r,o,e,void 0,{x:0,y:n},l),yIncrement:u+oB.LAYER_VERTICAL_GAP};let p=d+2*oB.GROUP_PADDING+oB.RIGHT_MARGIN_EXTRA,h=u+oB.GROUP_HEADER_HEIGHT+2*oB.GROUP_PADDING+oB.GROUP_EXTRA_BOTTOM,g=null==o?void 0:o["group-".concat(e)],x={id:"group-".concat(e),type:"layerGroup",position:g?{x:g.x,y:g.y}:{x:0,y:n},data:{label:e,layer:e},style:{width:p,height:h},draggable:!l,dragHandle:".layer-group-header",selectable:!1};return{groupNode:x,contentNodes:ls(t,a,i,r,o,e,x.id,{x:s,y:c},l),yIncrement:h+oB.LAYER_VERTICAL_GAP}},ld=e=>{let t=e.map(e=>({...e,style:{...e.style}}));for(let e of t.filter(e=>"layerGroup"===e.type)){let o=t.filter(t=>t.parentId===e.id);if(!o.length)continue;let l=1/0,a=1/0,i=-1/0,s=-1/0;for(let e of o){let{width:t,height:r}=oQ(e);l=Math.min(l,e.position.x),a=Math.min(a,e.position.y),i=Math.max(i,e.position.x+t),s=Math.max(s,e.position.y+r)}let c=l-oB.GROUP_PADDING,d=a-oG;if(0!==c||0!==d){var r,n;for(let t of(e.position={x:((null===(r=e.position)||void 0===r?void 0:r.x)||0)+c,y:((null===(n=e.position)||void 0===n?void 0:n.y)||0)+d},o))t.position={x:t.position.x-c,y:t.position.y-d};i-=c,s-=d}e.style.width=i-oB.GROUP_PADDING+2*oB.GROUP_PADDING+oB.RIGHT_MARGIN_EXTRA,e.style.height=s-oG+oB.GROUP_HEADER_HEIGHT+2*oB.GROUP_PADDING+oB.GROUP_EXTRA_BOTTOM}return t},lu=(0,F.memo)(e=>{let{initialNodes:t,initialEdges:r,initialLayout:o,onLayoutChange:l,activeLayer:a,onSelectLayer:i,onDeleteNodes:s,onSelectionChange:c,selectedIds:d,onDeleteEdges:u,onCreateEdge:p,linksKey:h,readOnly:g}=e,x=(0,F.useRef)(o),v=(0,F.useRef)([]),f=(0,F.useRef)(""),[m,b]=(0,F.useState)(!1),{resolvedTheme:y}=(0,ex.P)(),j=(0,F.useMemo)(()=>ld(t).map(e=>{var t;return{...e,data:{...e.data,isActiveLayer:"layerGroup"===e.type?!a||e.data.layer===a:null===(t=e.data)||void 0===t?void 0:t.isActiveLayer}}}),[t,a]),[$,w]=(0,oH.Rr)(j),[C,S,k]=(0,oH.ll)(r),A=(0,F.useMemo)(()=>{let e=o3();if(e)return e;let t=new Map($.map(e=>[e.id,e])),r=1/0,n=1/0,o=-1/0,l=-1/0;for(let e of $){var a,i;let{width:s,height:c}=oQ(e),d=e.parentId?t.get(e.parentId):null,u=((null==d?void 0:null===(a=d.position)||void 0===a?void 0:a.x)||0)+e.position.x,p=((null==d?void 0:null===(i=d.position)||void 0===i?void 0:i.y)||0)+e.position.y;r=Math.min(r,u),n=Math.min(n,p),o=Math.max(o,u+s),l=Math.max(l,p+c)}let s=Number.isFinite(r),c=s?(r+o)/2:0,d=s?(n+l)/2:0,u=oB.VIEWPORT.zoom;return{x:window.innerWidth/2-c*u+oB.VIEWPORT.x,y:window.innerHeight/2-d*u+oB.VIEWPORT.y,zoom:u}},[]),P=(0,F.useCallback)(e=>{let t={};for(let p of e){var r,n,o,l,a,i,s,c,d,u;let e=null!==(s=null!==(i=null!==(a=null===(r=p.measured)||void 0===r?void 0:r.width)&&void 0!==a?a:p.width)&&void 0!==i?i:parseFloat(null===(n=p.style)||void 0===n?void 0:n.width))&&void 0!==s?s:void 0,h=null!==(u=null!==(d=null!==(c=null===(o=p.measured)||void 0===o?void 0:o.height)&&void 0!==c?c:p.height)&&void 0!==d?d:parseFloat(null===(l=p.style)||void 0===l?void 0:l.height))&&void 0!==u?u:void 0;t[p.id]={x:p.position.x,y:p.position.y,...e?{width:e}:{},...h?{height:h}:{},layer:p.data.layer,parent:p.parentId,type:"layerGroup"===p.type?"group":"node"}}return t},[]),I=(0,F.useCallback)(e=>{let t=e.filter(e=>"remove"===e.type).map(e=>e.id);t.length&&S(e=>e.filter(e=>!t.includes(e.source)&&!t.includes(e.target)));let r=e.some(e=>"position"===e.type&&!1===e.dragging||"dimensions"===e.type&&!1===e.resizing)||t.length>0;w(n=>{let o=ld((0,oH.Fb)(e,n));if(t.length&&s){let e=t.filter(e=>{var t;return(null===(t=n.find(t=>t.id===e))||void 0===t?void 0:t.type)!=="layerGroup"});e.length&&s(e)}if(r&&l){let e=P(o);o5(e,x.current)||(x.current=e,l(e))}return o})},[w,S,l,P,s]),z=(0,F.useCallback)((e,t)=>o4(t),[]),L=(0,F.useCallback)((e,t)=>{i&&t.data.layer&&i(t.data.layer)},[i]),R=(0,F.useCallback)(e=>{let t=((null==e?void 0:e.nodes)||[]).filter(e=>"layerGroup"!==e.type).map(e=>e.id).sort();v.current.join()!==t.join()&&(v.current=t,null==c||c(t))},[c]),T=(0,F.useCallback)(()=>{v.current=[],null==c||c([])},[c]),E=(0,F.useCallback)(e=>{var t,r;if(!p||g||!e.source||!e.target||e.source===e.target)return;let n=null===(t=e.sourceHandle)||void 0===t?void 0:t.endsWith("-out"),o=null===(r=e.targetHandle)||void 0===r?void 0:r.endsWith("-in");if(!n||!o)return;let l="pre-out"===e.sourceHandle,a=l?"pre":"post";if(C.some(t=>{var r;return t.source===e.source&&t.target===e.target&&(null===(r=t.data)||void 0===r?void 0:r.linkType)===a}))return;let i=l?"var(--".concat(oY,"9)"):"var(--".concat(oX,"9)"),s={id:"".concat(e.source,"->").concat(e.target),source:e.source,target:e.target,sourceHandle:e.sourceHandle,targetHandle:l?"pre-in":"post-in",type:"curvy",data:{linkType:a},selectable:!0,focusable:!0,...l?{markerEnd:"arrow-pre-backward"}:{markerEnd:{type:oV.QZ.ArrowClosed,width:12,height:12,color:i}},style:{stroke:i,strokeWidth:2,strokeDasharray:l?"6 3":void 0}};S(e=>(0,oV.Z_)(s,e)),p({source:e.source,target:e.target,linkType:a})},[C,S,p,g]),_=(0,F.useCallback)(e=>{let t=e.filter(e=>"remove"===e.type);if(t.length&&u){let e=[];for(let o of t){var r,n;let t=C.find(e=>e.id===o.id);t&&(null===(r=t.data)||void 0===r?void 0:r.linkType)!=="code"&&e.push({source:t.source,target:t.target,linkType:(null===(n=t.data)||void 0===n?void 0:n.linkType)||"post"})}e.length&&u(e)}k(e)},[C,u,k]);return(0,F.useEffect)(()=>{let e=e=>{if(("Delete"===e.key||"Backspace"===e.key)&&!e.repeat){let e=document.activeElement;if(e){let t=e.tagName.toLowerCase();if("input"===t||"textarea"===t||"select"===t||e.isContentEditable||e.closest('[role="dialog"]')||e.closest("[data-radix-popper-content-wrapper]")||e.closest(".floating-window"))return}let t=$.filter(e=>e.selected&&"layerGroup"!==e.type);if(t.length&&s){s(t.map(e=>e.id));return}let r=C.filter(e=>e.selected).filter(e=>{var t;return(null===(t=e.data)||void 0===t?void 0:t.linkType)!=="code"});r.length&&u&&(u(r.map(e=>{var t;return{source:e.source,target:e.target,linkType:(null===(t=e.data)||void 0===t?void 0:t.linkType)||"post"}})),S(e=>e.filter(e=>!r.find(t=>t.id===e.id))))}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[$,C,s,u,S]),(0,F.useLayoutEffect)(()=>{let e=j.map(e=>{var t,r,n,o,l;return"".concat(e.id,":").concat(e.parentId||"",":").concat((null===(t=e.data)||void 0===t?void 0:t.layer)||"",":").concat(null!==(o=null===(r=e.position)||void 0===r?void 0:r.x)&&void 0!==o?o:0,":").concat(null!==(l=null===(n=e.position)||void 0===n?void 0:n.y)&&void 0!==l?l:0)}).sort().join("|"),t="".concat(e,"::").concat(h||"");f.current!==t?(f.current=t,w(j)):w(e=>{let t=new Map(j.map(e=>[e.id,e.data])),r=!1,n=e.map(e=>{let n=t.get(e.id);return n&&n!==e.data?(r=!0,{...e,data:n}):e});return r?n:e})},[j,w,h]),(0,F.useEffect)(()=>{S(e=>{let t=new Map(e.map(e=>[e.id,e.selected]));return r.map(e=>{var r,n;return{...e,selected:null!==(n=null!==(r=t.get(e.id))&&void 0!==r?r:e.selected)&&void 0!==n&&n}})})},[r,S,h]),(0,F.useEffect)(()=>{x.current=o},[o]),(0,F.useEffect)(()=>{if(!l)return;let e=new Set(j.map(e=>e.id)),t=!o||j.some(e=>!o[e.id]),r=o&&Object.keys(o).some(t=>!e.has(t));if(t||r){let e=P(j);o5(e,x.current)||(x.current=e,l(e))}},[j,l,o,P]),(0,F.useEffect)(()=>{if(!d)return;let e=[...d].sort();v.current.join()!==e.join()&&(v.current=e,w(t=>t.map(t=>({...t,selected:e.includes(t.id)}))))},[d,w]),(0,F.useEffect)(()=>{var e,t,r,n;if("undefined"!=typeof document)return document.body.classList.toggle("rf-noselect",m),m&&(null===(r=(n=window).getSelection)||void 0===r||null===(t=r.call(n))||void 0===t||null===(e=t.removeAllRanges)||void 0===e||e.call(t)),()=>{document.body.classList.remove("rf-noselect")}},[m]),(0,n.jsx)(Y.I,{children:(0,n.jsxs)(oH.x$,{edgeTypes:ll,nodeTypes:lo,nodes:$,edges:C,onNodesChange:I,onEdgesChange:_,onConnect:E,onMoveEnd:z,fitViewOptions:{padding:oB.FITVIEW_PADDING},defaultViewport:A,minZoom:.03,maxZoom:2,selectionOnDrag:!0,selectNodesOnDrag:!0,selectionKeyCode:["Control","Meta","Shift"],multiSelectionKeyCode:["Meta","Control","Shift"],onSelectionChange:R,onSelectionStart:()=>b(!0),onSelectionEnd:()=>b(!1),onPaneClick:T,onNodeClick:L,className:m?"rf-selecting":void 0,nodesDraggable:!g,nodesConnectable:!g,elementsSelectable:!0,edgesFocusable:!0,zoomOnScroll:!0,zoomOnPinch:!0,panOnDrag:!0,proOptions:{hideAttribution:!0},elevateEdgesOnSelect:!0,elevateNodesOnSelect:!0,style:{zIndex:0},translateExtent:[[-25e3,-25e3],[25e3,25e3]],deleteKeyCode:null,children:[(0,n.jsx)("svg",{style:{position:"absolute",width:0,height:0},children:(0,n.jsx)("defs",{children:(0,n.jsx)("marker",{id:"arrow-pre-backward",markerWidth:"12",markerHeight:"12",refX:"12",refY:"6",orient:"auto",markerUnits:"userSpaceOnUse",children:(0,n.jsx)("path",{d:"M 12 0 L 0 6 L 12 12 z",fill:"var(--".concat(oY,"9)")})})})}),(0,n.jsx)("style",{children:"\n.react-flow__node { border: none !important; background: transparent !important; box-shadow: none !important; }\n.react-flow__node-layerGroup { pointer-events: none !important; }\n.react-flow__node-layerGroup .layer-group-header { pointer-events: auto; }\n.react-flow__nodesselection, .react-flow__nodesselection-rect { pointer-events: none !important; background: transparent !important; border: none !important; }\n.rf-selecting .react-flow__node, .rf-selecting .react-flow__handle, .rf-selecting .layer-group-header { pointer-events: none !important; }\nbody.rf-noselect, body.rf-noselect * { user-select: none !important; }\n.react-flow__node.selected { z-index: 1000 !important; }\n.react-flow__edge { cursor: pointer; }\n.react-flow__edge.selected { z-index: 1000 !important; }\n.react-flow__edge-interaction { pointer-events: all; }\n"}),(0,n.jsx)(oH.Aq,{gap:20}),(0,n.jsx)(oH.a9,{position:"bottom-left",maskColor:"rgba(0,0,0,".concat("dark"===y?"0.4":"0.05",")"),nodeStrokeColor:e=>{var t;return(null===(t=e.style)||void 0===t?void 0:t.borderColor)||"black"},nodeColor:e=>"layerGroup"!==e.type?"var(--bgPanel)":"var(--bgContent)",style:{backgroundColor:"rgba(255, 255, 255, 0.1)"}})]})})}),lp=(0,F.memo)(e=>{let{cards:t,layout:r,onLayoutChange:o,activeLayer:l,onSelectLayer:a,onDeleteNodes:i,onSelectionChange:s,selectedIds:c,onDeleteEdges:d,onCreateEdge:u,readOnly:p}=e,h=(0,F.useMemo)(()=>(t||[]).map(e=>"".concat(e.name,":").concat((e.links||[]).map(e=>"".concat(e.name,":").concat(e.type)).join(","))).join("|"),[t]),{initialNodes:g,initialEdges:x}=(0,F.useMemo)(()=>{let e=t||[],n=o2(e),o=o0(e),l=[],a=[],i=0;for(let[e,t]of Array.from(o.entries())){let{groupNode:o,contentNodes:s,yIncrement:c}=lc(e,t,n,i,r,p);o&&l.push(o),a.push(...s),i+=c}return{initialNodes:[...l,...a],initialEdges:n}},[t,r,h,p]);return(0,n.jsx)(lu,{initialNodes:g,initialEdges:x,initialLayout:r,onLayoutChange:o,activeLayer:l,onSelectLayer:a,onDeleteNodes:i,onSelectionChange:s,selectedIds:c,onDeleteEdges:d,onCreateEdge:u,linksKey:h,readOnly:p})});var lh=r(98442),lg=r(3443),lx=r(56337),lv=r(80609),lf=r(7655),lm=r(71727);let lb=tV()(()=>Promise.resolve().then(r.bind(r,36293)).then(e=>e.Monaco),{loadableGenerated:{webpack:()=>[36293]},ssr:!1,loading:()=>(0,n.jsx)($.$,{})});class ly extends Error{constructor(e){super(e.join("\n")),this.name="ValidationError",this.errors=e}}let lj=async function(e,t,r,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{bumpVersion:!0};if(l_!==t.version){console.error("Cannot save board, the board version has changed, please refresh the board.");return}try{if(o.bumpVersion){if(t.version){let r=await (0,oO.$o)(e);t.version=r+1}else t.version=1;t.savedAt=Date.now()}await f.API.post("/api/core/v1/boards/".concat(e),t),o.bumpVersion&&n&&n(),r&&r(t.version)}catch(e){console.error("Error saving board:",e)}},l$=async(e,t)=>{let r=[];if(e.find(e=>e.name===t.name&&e.key!==t.key)&&(console.error("A card with the same name already exists"),r.push("A card with the same name already exists")),""===t.name&&(console.error("Card name cannot be empty"),r.push("Card name cannot be empty")),/^[a-zA-Z0-9-_ ]*$/.test(t.name)||(console.error("Invalid name, only letters, numbers, spaces, - and _ are allowed."),r.push("Invalid name, only letters, numbers, spaces, - and _ are allowed.")),r.length>0)throw new ly(r)},lw=()=>Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),{useParams:lC}=(0,tO.X)(),lS=tV()(()=>r.e(2153).then(r.bind(r,12153)).then(e=>e.RulesSideMenu),{loadableGenerated:{webpack:()=>[12153]},ssr:!1}),lk=tV()(()=>r.e(7674).then(r.bind(r,17674)).then(e=>e.UISideMenu),{loadableGenerated:{webpack:()=>[17674]},ssr:!1}),lA=tV()(()=>Promise.resolve().then(r.bind(r,24866)).then(e=>e.FileWidget),{loadableGenerated:{webpack:()=>[24866]},loading:()=>(0,n.jsx)(Y.I,{children:(0,n.jsx)(tM.M,{children:(0,n.jsx)($.$,{size:"small",color:"$color7",scale:4})})})}),lP=(0,F.memo)(e=>{var t,r,o,l;let{board:a,id:i,displayResponse:s,html:c,value:d,name:u,title:p,params:h,icon:g,color:x="var(--color7)",onRun:v=(e,t)=>{},onEditCode:m=()=>{},onDelete:b=()=>{},onEdit:y=e=>{},onDetails:j=()=>{},onCopy:$=()=>{},readOnly:A=!1,data:P={},states:I,containerProps:z={},setData:L=(e,t)=>{}}=e,[R,T]=(0,F.useState)("idle"),[_,W]=(0,F.useState)([]),[O,D]=(0,F.useState)(!1),M=(0,F.useRef)(!1),N=async e=>{W(t=>{let r=t.filter(t=>t.executionId!==e);return 0===r.length&&T("idle"),r});try{await f.API.post("/api/core/v1/boards/".concat(encodeURIComponent(a.name),"/actions/").concat(encodeURIComponent(u),"/executions/").concat(encodeURIComponent(e),"/cancel"),{})}catch(e){console.error("Failed to cancel execution",e)}},V=!1===P.displayTitle,H=(0,Q.BR)(null==a?void 0:a.name,null==P?void 0:P.name),B=null===(o=window.protoActions)||void 0===o?void 0:null===(r=o.boards)||void 0===r?void 0:null===(t=r[a.name])||void 0===t?void 0:t[u],G=(0,F.useRef)(null),U=(null==P?void 0:P.autoResponsive)!==!1&&(null===(l=G.current)||void 0===l?void 0:l.offsetHeight)<200,q=void 0===d||""===d?"N/A":"string"==typeof d?d:JSON.stringify(d),[J,Z]=(0,F.useState)(!1),[K,Y]=(0,F.useState)("bottom");(0,F.useEffect)(()=>{if(!J)return;let e=()=>{if(!G.current)return;let e=G.current.getBoundingClientRect(),t=window.innerHeight-e.bottom,r=e.top;Y(t<516&&r>t?"top":"bottom")};return e(),window.addEventListener("resize",e),window.addEventListener("scroll",e,!0),()=>{window.removeEventListener("resize",e),window.removeEventListener("scroll",e,!0)}},[J]),(0,F.useEffect)(()=>{f.API.get("/api/core/v1/protomemdb/executions/boards/".concat(encodeURIComponent(a.name))).then(e=>{if(e.isError||!e.data)return;let t=Object.values(e.data).filter(e=>(null==e?void 0:e.actionName)===u&&(null==e?void 0:e.executionId));t.length>0&&(W(t),T("running"))}).catch(()=>{})},[a.name,u]),(0,rO.uF)((e,t)=>{try{let e=JSON.parse(t.message).payload,r=e.status,n=e.executionId;if("running"===r)M.current=!0,T("running"),n&&W(t=>t.some(e=>e.executionId===n)?t:[...t,{executionId:n,startedAt:e.startedAt||Date.now(),contextId:e.contextId}]),requestAnimationFrame(()=>{M.current=!1});else{let e=()=>{n?W(e=>{let t=e.filter(e=>e.executionId!==n);return 0===t.length&&("done"===r||"cancelled"===r?T("idle"):("error"===r||"code_error"===r)&&T("error")),t}):"done"===r||"cancelled"===r?T("idle"):("error"===r||"code_error"===r)&&T("error")};M.current?requestAnimationFrame(()=>{requestAnimationFrame(e)}):e()}}catch(e){console.error(e)}},{path:"actions/boards/"+a.name+"/"+u+"/#"}),(0,F.useEffect)(()=>{if(0===_.length)return;let e=setInterval(()=>{let e=Date.now();W(t=>{let r=t.filter(t=>e-t.startedAt<6e5);return 0===r.length&&t.length>0&&T("idle"),r})},3e4);return()=>clearInterval(e)},[_.length]),(0,F.useEffect)(()=>{B&&B.status&&T(B.status)},[null==B?void 0:B.status]);let X=(0,F.useMemo)(()=>(0,n.jsx)(oA,{setData:L,id:i,data:P,displayResponse:s,name:u,description:"Run action",actionParams:h,onRun:v,icon:g,color:x,html:c,value:d}),[L,i,P,s,u,h,v,g,x,c,d]),ee=e=>{var t,r,n,o;let l=null===(r=e.target)||void 0===r?void 0:null===(t=r.tagName)||void 0===t?void 0:t.toLowerCase();"input"!==l&&"textarea"!==l&&"select"!==l&&"button"!==l&&(e.stopPropagation(),y(null!==(o=null==P?void 0:null===(n=P.editorOptions)||void 0===n?void 0:n.defaultTab)&&void 0!==o?o:"params"))};return(0,n.jsxs)(ea.B5,{ref:G,highlighted:H,onDoubleClick:ee,containerProps:{onHoverIn:()=>D(!0),onHoverOut:()=>D(!1),onDoubleClick:ee,backgroundColor:P.bgColor,cursor:"pointer",...z},status:R,hideFrame:!1===P.displayFrame,id:i,header:(0,n.jsxs)(n.Fragment,{children:[p&&!V&&(0,n.jsx)(w.sL,{width:"100%",btrr:9,btlr:9,mt:"$3",h:20,ai:"center",zIndex:1,children:(0,n.jsx)(C.n,{flex:1,fontWeight:"500",textOverflow:"ellipsis",textAlign:"center",overflow:"hidden",whiteSpace:"nowrap",fontSize:"$4",children:p})}),(0,n.jsx)(w.sL,{width:"100%",marginTop:"$3",height:20,alignItems:"center",position:"absolute",opacity:O?.75:0,zIndex:999,onDoubleClick:ee,children:(0,n.jsx)(oI,{id:i,data:P,states:I,onDelete:b,onDetails:j,onEdit:y,onEditCode:m,onCopy:$,onMoveLayer:e=>{L({layer:e},i)},readOnly:A,executions:_,cancelExecution:N})})]}),children:[(0,n.jsxs)(E.J2,{open:J,onOpenChange:Z,placement:"".concat(K,"-start"),allowFlip:!1,stayInFrame:!0,children:[(0,n.jsx)(E.J2.Trigger,{cursor:"pointer",display:U?"flex":"none",className:"no-drag",flex:1,width:"100%",padding:"$3",justifyContent:"center",alignItems:"center",children:(0,n.jsxs)(w.sL,{gap:"$2",flex:1,width:"100%",height:"100%",alignItems:"center",justifyContent:"center",children:[(0,n.jsx)(e3.w,{disabled:!d,label:q,delay:{open:1e3,close:0},restMs:0,children:(0,n.jsx)(S.x,{opacity:O?.7:1,flex:1,fontSize:q.length<10?"$8":"$6",textAlign:"center",fontWeight:"600",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:q})}),"action"==P.type&&O&&(0,n.jsx)(k.zx,{pressStyle:{filter:"brightness(0.95)",backgroundColor:x},hoverStyle:{backgroundColor:x,filter:"brightness(1.1)"},backgroundColor:x,position:"absolute",right:"$1",bottom:"$1",size:"$4",borderRadius:"$5",aspectRatio:1,padding:"$1",enterStyle:{opacity:.4},animation:"bouncy",scaleIcon:1.4,icon:(0,n.jsx)(eg.N1,{name:null!=g?g:"play"}),onPress:e=>{e.stopPropagation(),(0,Q.jo)(u,{})}})]})}),(0,n.jsx)(E.J2.Content,{backgroundColor:"$bgPanel",borderWidth:1,borderColor:"$gray6",maxHeight:500,minWidth:300,overflow:"auto",alignItems:"stretch",children:(0,n.jsx)("div",{children:X})})]}),!U&&X]})},(e,t)=>e.data===t.data&&e.value===t.value&&e.states===t.states&&e.html===t.html&&e.displayResponse===t.displayResponse&&e.name===t.name&&e.color===t.color&&e.icon===t.icon&&e.readOnly===t.readOnly),lI=(e,t)=>{let r=[],n=(e,t)=>{if(e&&"object"==typeof e){if(e.url)r.push({...e,path:t});else for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&n(e[r],t+"/"+r)}};return n(t,""),async function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("Executing action: ",t,n);let o=r.find(r=>r.url===t||r.name===t&&r.path=="/boards/"+e+"/"+r.name);if(!o){console.error("Action not found: ",t);return}if(console.log("Action: ",o),o.receiveBoard&&(n.board=e.name),o.configParams)for(let e in o.configParams){var l,a;(null===(l=o.configParams[e])||void 0===l?void 0:l.visible)===!1&&(null===(a=o.configParams[e])||void 0===a?void 0:a.defaultValue)!=""&&(n[e]=o.configParams[e].defaultValue)}if("post"===o.method){let{token:e,...t}=n,r=await f.API.post(o.url,t);if(r.isError)throw Error(JSON.stringify(r.error||"Error executing action"));return r.data}{let e=Object.keys(n).map(e=>e+"="+n[e]).join("&"),t=await f.API.get(o.url+"?"+e);if(t.isError)throw Error(JSON.stringify(t.error||"Error executing action"));return t.data}}},lz=e=>{var t;let{board:r}=e,o=ec({},"states/boards/"+r.name+"/#","states"),l=null==o?void 0:null===(t=o.boards)||void 0===t?void 0:t[r.name];return(0,n.jsxs)(w.sL,{p:"$4",flex:1,flexDirection:"column",gap:"$4",overflow:"auto",children:[l&&(0,n.jsx)(M.W,{src:null!=l?l:{}}),!l&&(0,n.jsx)(tM.M,{children:(0,n.jsx)(C.n,{size:"$8",o:.4,children:"No states found for this board"})})]})},lL=e=>{var t,r,o,l,a,i,s,c,d;let{device:u,actions:p,onSelect:f,templateEditor:m}=e,[b,j]=(0,F.useState)({open:!1,device:null}),$=!!(null===(t=u.data)||void 0===t?void 0:t.deviceDefinition),C=(null===(r=u.data)||void 0===r?void 0:r.platform)==="esphome",k=(0,y.Tg)("devices.update"),A=[{text:"Edit subsystems",icon:g.Y,action:e=>j({open:!0,device:e}),isVisible:()=>k},{text:"Upload definition",icon:x.W,action:async e=>{await p.flashDevice(e)},isVisible:e=>{var t;return!!(null===(t=e.data)||void 0===t?void 0:t.deviceDefinition)}},{text:"Upload config file",icon:x.W,action:async e=>{await p.uploadConfigFile(e)},isVisible:e=>{var t;return!!e.getConfigFile()&&!(null===(t=e.data)||void 0===t?void 0:t.deviceDefinition)}},{text:"View logs",icon:v.t,action:async e=>{await p.viewLogs(e)},isVisible:e=>!!e.getLogs()}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Y.I,{children:(0,n.jsxs)(w.sL,{ai:"center",px:"$3",py:"$2",bg:"$bgContent",br:"$3",gap:"$3",bw:1,boc:"$gray5",jc:"space-between",children:[(0,n.jsxs)(w.sL,{ai:"center",gap:"$3",onPress:()=>f(u),cursor:"pointer",flex:1,children:[(0,n.jsx)(h.F,{size:16}),(0,n.jsx)(S.x,{children:null!==(c=null==u?void 0:null===(o=u.data)||void 0===o?void 0:o.name)&&void 0!==c?c:"Unknown device"})]}),(0,n.jsxs)(w.sL,{ai:"center",gap:"$2",children:[C&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ri.w,{onPress:async e=>{if(e.stopPropagation(),!$){await p.uploadConfigFile(u);return}await p.flashDevice(u)},children:"Upload"}),(0,n.jsx)(ri.w,{onPress:e=>{e.stopPropagation(),m.openDevice(u.data.name)},children:"Edit"})]}),(0,n.jsx)(lg.o,{type:"item",sourceUrl:"/api/core/v1/devices",element:u,deleteable:()=>!1,hideDeleteButton:!0,extraMenuActions:A})]})]})}),(0,n.jsx)(lv.C,{open:b.open,deviceName:null===(a=b.device)||void 0===a?void 0:null===(l=a.data)||void 0===l?void 0:l.name,subsystems:null!==(d=null===(s=b.device)||void 0===s?void 0:null===(i=s.data)||void 0===i?void 0:i.subsystem)&&void 0!==d?d:[],onClose:()=>j({open:!1,device:null})})]})},lR=e=>{var t,r,o,l;let{devices:a,actions:i}=e,s=Array.isArray(a)?a.filter(Boolean):[],[c,d]=(0,F.useState)(!1),[u,p]=(0,F.useState)({}),[x,m]=(0,F.useState)(null),b=(0,lm.lM)(),j=(0,y.Tg)("devices.update");return(0,F.useEffect)(()=>{let e=!1,t=async()=>{d(!0);try{let t=await Promise.all(s.map(async e=>{try{let t=await f.API.get("/api/core/v1/devices/".concat(encodeURIComponent(e)));if(!(null==t?void 0:t.isError)&&(null==t?void 0:t.data))return[e,rW.O7.load(t.data)]}catch(e){}return[e,null]}));e||p(Object.fromEntries(t))}finally{e||d(!1)}};return s.length?t():p({}),()=>{e=!0}},[JSON.stringify(s)]),(0,n.jsxs)(w.FA,{f:1,padding:"$4",gap:"$3",children:[(0,n.jsxs)(w.sL,{ai:"center",jc:"space-between",children:[(0,n.jsx)(C.n,{size:"$5",fow:"600",children:"Linked devices"}),(0,n.jsx)(k.zx,{size:"$2",onPress:()=>{window.location.href="/workspace/devices"},children:"Go to devices page"})]}),x?(0,n.jsxs)(w.FA,{gap:"$3",children:[(0,n.jsxs)(w.sL,{ai:"center",jc:"space-between",children:[(0,n.jsxs)(w.sL,{ai:"center",gap:"$3",children:[(0,n.jsx)(k.zx,{size:"$2",onPress:()=>m(null),children:"Back"}),(0,n.jsx)(S.x,{fontWeight:"700",children:null===(t=x.data)||void 0===t?void 0:t.name})]}),(0,n.jsx)(lg.o,{type:"item",sourceUrl:"/api/core/v1/devices",element:x,deleteable:()=>!1,hideDeleteButton:!0,extraMenuActions:[{text:"Edit subsystems",icon:g.Y,action:e=>m(e),isVisible:()=>j},{text:"View logs",icon:v.t,action:async e=>{await i.viewLogs(e)},isVisible:e=>!!e.getLogs()}]})]}),(0,n.jsx)(Y.I,{children:(0,n.jsx)(lf.i,{subsystems:null!==(l=null===(r=x.data)||void 0===r?void 0:r.subsystem)&&void 0!==l?l:[],deviceName:null===(o=x.data)||void 0===o?void 0:o.name})})]}):0===s.length?(0,n.jsx)(C.n,{color:"$gray9",children:"No devices linked to this board yet."}):c?(0,n.jsx)(C.n,{color:"$gray9",children:"Loading devices…"}):(0,n.jsx)(w.FA,{gap:"$2",children:s.map(e=>{let t=u[e];return t?(0,n.jsx)(lL,{device:t,actions:i,onSelect:e=>m(e),templateEditor:b},e):(0,n.jsx)(Y.I,{children:(0,n.jsxs)(w.sL,{ai:"center",px:"$3",py:"$2",bg:"$bgContent",br:"$3",gap:"$3",bw:1,boc:"$gray5",children:[(0,n.jsx)(h.F,{size:16}),(0,n.jsxs)(S.x,{children:[e," (not found)"]})]})},e)})}),(0,n.jsx)(lm.u,{...b.editorProps})]})},lF=e=>{var t;let{tabVisible:r,setTabVisible:o,board:l,automationInfo:i,boardRef:g,actions:x,states:v,uicodeInfo:f,setUICodeInfo:m,onEditBoard:b,deviceActions:y,readOnly:j}=e,{panelSide:$,setPanelSide:C}=(0,tH.dQ)()||{},[S,k]=(0,F.useState)([]);(0,tQ._)(e=>{k(t=>{let r=[e,...t];return r.length>1e3?r.slice(0,1e3):r})});let A={states:{label:"States",icon:s.f,content:(0,n.jsx)(lz,{board:l})},rules:{label:"Automation",icon:d.r,content:(0,n.jsx)(w.sL,{flex:1,padding:"$3",children:i&&(0,n.jsx)(lS,{automationInfo:i,boardRef:g,board:l,actions:x,states:v,readOnly:j})})},uicode:{label:"Presentation",icon:u.A,content:(0,n.jsx)(n.Fragment,{children:f&&(0,n.jsx)(lk,{onChange:e=>{m({code:e})},uiCode:f,boardRef:g,board:l,actions:x,states:v,readOnly:j})})},logs:{label:"Logs ("+S.length+")",icon:c.c,content:(0,n.jsx)(eo,{AppState:tK.aB,logs:S,setLogs:k})},history:{label:"History",icon:p.w,content:(0,n.jsx)(oD,{boardId:l.name})},devices:{label:"Devices",icon:h.F,content:(0,n.jsx)(lR,{devices:null!==(t=l.devices)&&void 0!==t?t:[],actions:y})},"board-settings":{label:"Settings",icon:a.Z,content:(0,n.jsx)(tB.m,{board:l,readOnly:j,onSave:e=>{g.current=e,b()}})}};return(0,n.jsx)(tY,{visible:Object.keys(A).includes(r),selectedTab:r,onChangeTab:o,tabs:A,side:$,onToggleSide:()=>C("right"===$?"left":"right"),leftAnchorSelector:"#app-sidemenu",leftAnchorGap:40},"fw-".concat($))},lT=e=>{var t,r,a,s,c,d,u,p,h,g,x,v,m,b;let{board:j,icons:$,forceViewMode:T}=e,{addOpened:E,setAddOpened:_,tabVisible:W,setTabVisible:O,viewMode:D}=null!==(h=(0,tH.dQ)())&&void 0!==h?h:{},M=null!==(g=null!=T?T:D)&&void 0!==g?g:"ui",N="string"==typeof(null==j?void 0:j.userPermissions)?j.userPermissions.toLowerCase():"rw",V=(0,y.Tg)("boards.update"),H="rw"===("w"===N?"rw":N)&&V,B=!H&&("board"===M||"graph"===M);window.board=j;let G=(0,F.useRef)(null),U=(0,F.useRef)(),q=(0,F.useRef)(!1),[J,Z]=(0,F.useState)(j.cards&&j.cards.length?j.cards:[]),[K,ee]=(0,F.useState)(JSON.stringify(j)),[et,er]=(0,F.useState)(null!==(x=null==j?void 0:j.graphLayout)&&void 0!==x?x:{}),en=(0,F.useRef)(et),eo=(0,F.useRef)(null!==(v=null==j?void 0:j.name)&&void 0!==v?v:null),es=(0,F.useCallback)((e,t)=>{if(e===t)return!0;if(!e||!t)return!1;let r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let n of r){let r=e[n],o=t[n];if(!o||r.x!==o.x||r.y!==o.y||r.layer!==o.layer||r.parent!==o.parent||r.type!==o.type)return!1}return!0},[]);(0,F.useEffect)(()=>{var e,t;Z(j.cards&&j.cards.length?j.cards:[]),ee(JSON.stringify(j));let r=null!==(e=null==j?void 0:j.graphLayout)&&void 0!==e?e:{},n=eo.current!==(null==j?void 0:j.name),o=Object.keys(en.current||{}).length>0;!n&&o||es(en.current,r)||(er(r),en.current=r),eo.current=null!==(t=null==j?void 0:j.name)&&void 0!==t?t:null,window.board=j},[j,es]);let[ed,eu]=(0,Q.jU)(),[ep,eh]=(0,Q.cY)(),eg=(0,F.useRef)(null),ev=(0,F.useRef)(ep);ev.current=ep,(0,F.useEffect)(()=>{var e;let t=new Set(["base"]);for(let r of J)t.add(null!==(e=r.layer)&&void 0!==e?e:"base");eu(Array.from(t).sort((e,t)=>"base"===e?-1:"base"===t?1:e.localeCompare(t,void 0,{sensitivity:"base"})))},[J,eu]);let[ef,em]=(0,X.KO)(og),[eb,ey]=(0,X.KO)(ox),[ej,e$]=(0,X.KO)(ov);q.current||(Z(j.cards&&j.cards.length?j.cards:[]),ey(null),e$(null),q.current=!0);let[ew,eC]=(0,F.useState)(!1),[eS,ek]=(0,F.useState)(!1),[eA,eP]=(0,F.useState)(!1),[ez,eL]=(0,F.useState)(!1),[eR,eF]=(0,F.useState)(!1),[eT,eE]=(0,F.useState)(null),[e_,eW]=(0,F.useState)([]),[eO,eD]=(0,F.useState)(null),[eM,eN]=(0,F.useState)(""),[eV,eH]=(0,F.useState)(null),[eB,eG]=(0,F.useState)(!1),[eU,eq]=(0,F.useState)([]),[eJ,eZ]=(0,F.useState)([]),eK=(0,F.useRef)([]);eK.current=eJ;let eY=(0,F.useRef)(""),{query:eX,removeReplace:eQ,push:e0}=(0,t_.N)({}),e1="true"==eX.json,[e2,e3]=(0,tX.K)(tK.aB),[e4,e5]=(0,F.useState)("config"),[e8,e6]=(0,F.useState)(0),{resolvedTheme:e7}=(0,ex.P)(),e9=op({boardID:"visualui"==W?j.name:null,onDismiss:()=>O(""),onAfterSave:e=>{let{code:t}=e;e$({code:t}),O("")}}),te=ec({},"states/boards/"+j.name+"/#","states"),tt=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),tr=(e,t)=>{let r=t.replace(/(?:\s*_)?\d+$/,""),n=new RegExp("^".concat(tt(r),"(?:_(\\d+))?$")),o=e.reduce((e,t)=>{let r=t.match(n);return r?Math.max(e,r[1]?parseInt(r[1],10):1):e},0);return"".concat(r,"_").concat(o+1)};(0,F.useEffect)(()=>{ef&&ef.length&&Z(ef)},[ef]),(0,F.useEffect)(()=>{eK.current=eJ},[eJ]),(0,ei.rf)(()=>{E&&eq([])},[E]),(0,ei.rf)(()=>{eA&&eq([])},[eA]);let[tn,to]=(0,Q.Dz)(),{refresh:tl}=(0,oO.lV)(j.name),ta=(0,F.useRef)(j),{uploadConfigFile:ti,flashDevice:ts,viewLogs:tc,ui:td}=(0,lx.z)();window.protoStates=te,window.protoBoardName=j.name,window.dispatchEvent(new CustomEvent("protoStates:update",{detail:{board:j.name}}));let tu=ec({},"actions/boards/"+j.name+"/#","actions");window.protoActions=tu,(0,F.useEffect)(()=>{window.executeAction=async(e,t)=>await window.onRunListeners[e](e,t),window.executeActionForm=async(e,t)=>{e.preventDefault();let r=Object.fromEntries(new FormData(e.target).entries()),n={};for(let e in r)(r[e]||"0"===r[e])&&(n[e]=r[e]);return await window.onRunListeners[t](t,n)}},[]),(0,F.useEffect)(()=>{let e=()=>{eF(!0)};return window.addEventListener("board:relayout",e),()=>window.removeEventListener("board:relayout",e)},[]);let tp=()=>{er({}),en.current={},ta.current.graphLayout={},f.API.post("/api/core/v1/boards/".concat(j.name,"/graphlayout"),{graphLayout:{}}).catch(e=>{console.error("Error clearing graph layout:",e)})};(0,F.useEffect)(()=>{window.execute_action=lI(j.name,tu),window.setCardData=(e,t,r)=>{Z(n=>{if(!n.some(t=>t.key===e))return console.error("Card not found:",e),n;{let o=n.map(n=>n.key===e?{...n,[t]:r}:n);return j.cards=o,lj(j.name,j,to,tl),o}})}},[tu]),(0,ei.qR)(()=>{of(j.name,Z,to,ey,e$)}),(0,F.useEffect)(()=>{ta.current.cards=J},[J]),(0,F.useEffect)(()=>{ta.current.graphLayout=et,en.current=et},[et]);let th=(0,F.useCallback)(e=>{var t;let r=e||{};if(!es(r,en.current)){if(l_!==(null===(t=ta.current)||void 0===t?void 0:t.version)){console.error("Cannot save graph layout, the board version has changed, please refresh the board.");return}en.current=r,er(r),ta.current.graphLayout=r,f.API.post("/api/core/v1/boards/".concat(j.name,"/graphlayout"),{graphLayout:r}).catch(e=>{console.error("Error saving graph layout:",e)})}},[j.name,es]);(0,F.useEffect)(()=>{ta.current=j},[j]),(0,F.useEffect)(()=>{if(!(null==j?void 0:j.name))return;let e=(0,lh.WQ)(j.name).layer,t=e&&ed.includes(e)?e:"base",r=ev.current;t&&t!==r&&eh(t)},[null==j?void 0:j.name,ed,eh]),(0,F.useEffect)(()=>{var e;if(!(null==j?void 0:j.name)||!ep)return;let t=eg.current!==j.name;eg.current=j.name,t||(null!==(e=(0,lh.WQ)(j.name).layer)&&void 0!==e?e:"base")===ep||(0,lh.QU)(j.name,{layer:ep})},[null==j?void 0:j.name,ep]);let tg=(0,F.useCallback)(async e=>{if(!H||!e.length)return;let t=new Set(e),r=J.filter(e=>!t.has(e.name)).map(e=>{var r;if(null===(r=e.links)||void 0===r?void 0:r.length){let r=e.links.filter(e=>!t.has(e.name));if(r.length!==e.links.length)return{...e,links:r}}return e});if(r.length===J.length&&!J.some(e=>{var r;return null===(r=e.links)||void 0===r?void 0:r.some(e=>t.has(e.name))}))return;Z(r),ta.current.cards=r;let n={...en.current||{}},o=!1;e.forEach(e=>{n[e]&&(delete n[e],o=!0)}),o&&(er(n),en.current=n,ta.current.graphLayout=n),eZ([]),eK.current=[],eW([]),eE(null),await lj(j.name,ta.current,to,tl)},[J,j.name,to,tl,H]),tx=(0,F.useCallback)(async e=>{if(!H||!e.length)return;let t=!1,r=J.map(r=>{var n;let o=e.filter(e=>e.source===r.name);if(!o.length||!(null===(n=r.links)||void 0===n?void 0:n.length))return r;let l=r.links.filter(e=>{let r=o.some(t=>t.target===e.name&&t.linkType===e.type);return r&&(t=!0),!r});return l.length===r.links.length?r:{...r,links:l}});t&&(Z(r),ta.current.cards=r,await lj(j.name,ta.current,to,tl))},[J,j.name,to,tl,H]),tv=(0,F.useCallback)(async e=>{if(!H)return;let{source:t,target:r,linkType:n}=e,o=J.map(e=>{if(e.name!==t)return e;let o=e.links||[];return o.some(e=>e.name===r&&e.type===n)?e:{...e,links:[...o,{name:r,type:n}]}});Z(o),ta.current.cards=o,await lj(j.name,ta.current,to,tl)},[J,j.name,to,tl,H]),tf=(0,F.useCallback)(async e=>{var t,r;if(!H||!e.length)return;let n=new Map(((null===(t=ta.current)||void 0===t?void 0:t.cards)||[]).map(e=>[e.name,e])),o=new Set(((null===(r=ta.current)||void 0===r?void 0:r.cards)||[]).map(e=>e.name)),l=[...ta.current.cards],a={...en.current||{}},i=!1,s=[];e.forEach(e=>{var t,r,c,d;let u=n.get(e);if(!u)return;let p=tr(Array.from(o),u.name);o.add(p);let h=(u.key||u.name||"card").replace(/_vento_copy_.+$/,""),g={...u,name:p,key:"".concat(h,"_vento_copy_").concat(lw())};l.push(g),s.push(p),Object.keys(ta.current.layouts||{}).forEach(e=>{var t;let r=null===(t=ta.current.layouts[e])||void 0===t?void 0:t.find(e=>e.i===u.key);r&&ta.current.layouts[e].push({...r,i:g.key})});let x=null===(t=en.current)||void 0===t?void 0:t[e];x&&(a[p]={...x,x:(null!==(r=x.x)&&void 0!==r?r:0)+60,y:(null!==(c=x.y)&&void 0!==c?c:0)+40,layer:null!==(d=g.layer)&&void 0!==d?d:x.layer,parent:x.parent,type:x.type},i=!0)}),ta.current.cards=l,Z(l),s.length&&(eZ(s),eK.current=s),i&&th(a),await lj(j.name,ta.current,to,tl)},[th,j.name,to,tl,H]),tm=(0,F.useMemo)(()=>{let e={};return Object.keys(f.gridSizes).forEach(t=>{var r,n;e[t]=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{doubleWidgets:n=[],layout:o={}}=r,{totalCols:l,normalW:a,normalH:i,doubleW:s,doubleH:c}=t;if(L={x:-1,y:0},Array.isArray(o)){for(let e of o)if("number"==typeof e.x&&"number"==typeof e.y){var d,u,p;let t=e.x+(null!==(d=e.w)&&void 0!==d?d:1),r=e.y+(null!==(u=e.h)&&void 0!==u?u:1);L.y,e.y===L.y&&t>L.x&&(L.x=t-1),r-1>L.y&&(L.y=r-1,L.x=e.x+(null!==(p=e.w)&&void 0!==p?p:1)-1)}}let h=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[];for(let o=0;o<e;o++)n.push(Array(t).fill(r));return n}(1,l,!1),g=[];for(let t of e){let e,r;let d=o&&o.find&&o.find(e=>e.i==t.key);if(d){g.push(d);continue}if(t.width&&t.height&&!d?(e=Math.ceil(t.width*(a/4)),r=Math.ceil(t.height*(i/5.5))):n.includes(t.key)?(e=s,r=c):(e=a,r=i),e>l){console.warn("El widget '".concat(t.key,"' con w=").concat(e," no cabe en totalCols=").concat(l,". Se omite."));continue}let{x:u,y:p,w:x,h:v}=function(e,t,r){let n=e[0].length;for(;e.length<L.y+r;)e.push(Array(n).fill(!1));let o=L.y,l=L.x+1;for(let a=o;a<1e3;a++){for(;e.length<a+r;)e.push(Array(n).fill(!1));let i=a===o?l:0;for(let o=i;o<=n-t;o++){let n=!0;for(let l=0;l<r&&n;l++)for(let r=0;r<t&&n;r++)e[a+l][o+r]&&(n=!1);if(n){for(let n=0;n<r;n++)for(let r=0;r<t;r++)e[a+n][o+r]=!0;return L={x:o,y:a},{x:o,y:a,w:t,h:r}}}}throw Error("No se pudo colocar el widget")}(h,e,r);g.push({i:t.key,x:u,y:p,w:x,h:v,isResizable:!0})}return g}(J||[],f.gridSizes[t],{layout:null!==(n=null===(r=ta.current)||void 0===r?void 0:r.layouts[t])&&void 0!==n?n:null==j?void 0:j.layouts[t]})}),e},[J,null==j?void 0:j.layouts]);ta.current.layouts=tm;let tb=async e=>{var t,r,n,o,l;if(!H)return;let a=Array.isArray(e)?e:[e],i=[],s=[],c=[...null!==(r=null===(t=ta.current)||void 0===t?void 0:t.cards)&&void 0!==r?r:[]];for(let e=0;e<a.length;e++){let t=a[e];try{await l$(c,t);let r="".concat(t.type,"_").concat(Date.now(),"_").concat(e,"_").concat(Math.random().toString(36).substr(2,9)),l={...t,key:r,layer:null!==(o=null!==(n=t.layer)&&void 0!==n?n:ep)&&void 0!==o?o:"base"};i.push(l),c=[...c,l]}catch(e){e instanceof ly?s.push(...e.errors):(console.error("Error checking card:",e),s.push('Error adding card "'.concat(t.name,'": ').concat(e.message||"Unknown error")))}}if(s.length>0?eq(s):eq([]),0===i.length&&s.length>0)throw Error(s.join(", "));if(i.length>0){let e=[...null===(l=ta.current)||void 0===l?void 0:l.cards,...i].filter(e=>"addwidget"!==e.key);Z(e),ta.current.cards=e,await lj(j.name,ta.current,to,tl);let t=i[i.length-1];setTimeout(()=>{!function(e){var t,r,n;let{duration:o=1200,block:l="center",color:a="rgba(250, 204, 21, 0.5)",ring:i=10}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return;let s=null===(t=(r=window).matchMedia)||void 0===t?void 0:t.call(r,"(prefers-reduced-motion: reduce)").matches;if(e.scrollIntoView({behavior:"smooth",block:l,inline:"nearest"}),null===(n=e.getAnimations)||void 0===n||n.call(e).forEach(e=>e.cancel()),s)return;let c=e.style.willChange;e.style.willChange="transform, box-shadow, background-color";let d=getComputedStyle(e).backgroundColor||"transparent",u=e.animate([{transform:"scale(0.98)",boxShadow:"0 0 0 0 ".concat(a),offset:0},{transform:"scale(1)",boxShadow:"0 0 0 ".concat(i,"px ").concat(a),offset:.35},{transform:"scale(1)",boxShadow:"none",offset:1}],{duration:o,easing:"cubic-bezier(.22,.61,.36,1)",fill:"none"}),p=e.animate([{backgroundColor:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.25;try{let n=e=>{let t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/i);return t?{r:+t[1],g:+t[2],b:+t[3],a:t[4]?+t[4]:1}:null},o=n(e),l=n(t)||n(function(e){if(e.startsWith("#")){let t=4===e.length?"#".concat(e[1]).concat(e[1]).concat(e[2]).concat(e[2]).concat(e[3]).concat(e[3]):e,r=parseInt(t.slice(1,3),16),n=parseInt(t.slice(3,5),16),o=parseInt(t.slice(5,7),16);return"rgba(".concat(r,", ").concat(n,", ").concat(o,", 1)")}return e}(t));if(!o||!l)return t.replace(/rgba?\(/,"rgba(").replace(/\)$/,", ".concat(r,")"));let a=Math.round(l.r*r+o.r*(1-r)),i=Math.round(l.g*r+o.g*(1-r)),s=Math.round(l.b*r+o.b*(1-r));return"rgba(".concat(a,", ").concat(i,", ").concat(s,", 1)")}catch(e){return t.replace(/rgba?\(/,"rgba(").replace(/\)$/,", ".concat(r,")"))}}(d,a,.25)},{backgroundColor:d}],{duration:o,easing:"ease-out",fill:"none"}),h=()=>{e.style.willChange=c};u.addEventListener("finish",h),u.addEventListener("cancel",h),p.addEventListener("finish",h),p.addEventListener("cancel",h)}(document.getElementById(t.key),{duration:1300,color:"var(--color6)",ring:2})},500)}},ty=(e,t)=>{H&&(Z(r=>{try{let n=r.map(r=>r.key===e||r.name===e?{...r,...t}:r);return ta.current.cards=n,n}catch(e){return r}}),lj(j.name,ta.current,to,tl))},tj=async()=>{try{await lj(j.name,ta.current,to,tl)}catch(e){alert("Error editing board")}},t$=(J||[]).filter(e=>H||"addWidget"!==e.type).map(e=>{var t,r,o,a,i;return"addWidget"==e.type?{...e,content:(0,n.jsx)(ea.B5,{title:"Add new card",id:e.key,children:(0,n.jsx)(w.FA,{alignItems:"center",justifyContent:"center",f:1,width:"100%",opacity:1,children:(0,n.jsx)(w.FA,{bc:"$gray7",f:1,w:"100%",p:"$2",pressStyle:{bg:"$gray8"},borderRadius:"$5",hoverStyle:{opacity:.75},alignItems:"center",justifyContent:"center",className:"no-drag",cursor:"pointer",bw:1,onPress:()=>{H&&_(!0)},children:(0,n.jsx)(l.v,{col:"$gray10",size:60})})})})}:{...e,content:(0,n.jsx)(lP,{board:j,readOnly:!H,data:e,states:null==te?void 0:null===(r=te.boards)||void 0===r?void 0:null===(t=r[j.name])||void 0===t?void 0:t[e.name],html:e.html,displayResponse:e.displayResponse,name:e.name,color:e.color,icon:e.icon?e.html?e.icon:"/public/icons/"+e.icon+".svg":void 0,id:e.key,title:e.name,params:e.params,containerProps:e.containerProps,onCopy:async()=>{if(!H)return;let t=eK.current.includes(e.name)?eK.current:[e.name];await tf(t)},onDelete:()=>{H&&(eW(eK.current.includes(e.name)?eK.current:[e.name]),eC(!0),eE(e))},onEdit:t=>{e5(t),eP(!0),eE(e),eD(e),eH(JSON.stringify(e))},onDetails:()=>{eE(e),ek(!0),"/api/core/v1/boards/".concat(j.name,"/actions/").concat(e.name)},onEditCode:()=>{eN(e.sourceFile)},setData:(e,t)=>{ty(t,e),console.log("setData called with:",e,t)},value:null!==(i=null==te?void 0:null===(a=te.boards)||void 0===a?void 0:null===(o=a[j.name])||void 0===o?void 0:o[e.name])&&void 0!==i?i:void 0,onRun:async(e,t)=>(await f.API.post("/api/core/v1/boards/".concat(j.name,"/actions/").concat(e),t)).data})}}),tw=(null==eT?void 0:eT.params)||{},tC=(null==eT?void 0:eT.configParams)||{},tS=(null===(r=document)||void 0===r?void 0:null===(t=r.location)||void 0===t?void 0:t.origin)+"/api/core/v1/boards/".concat(j.name,"/cards/").concat(null==eT?void 0:eT.name,"/run?").concat(Object.keys(null!=tw?tw:{}).map(e=>{var t;return e+"="+encodeURIComponent((null===(t=tC[e])||void 0===t?void 0:t.defaultValue)||tw[e])}).join("&"),"&token=").concat((null==eT?void 0:null===(a=eT.tokens)||void 0===a?void 0:a.run)||""),tk=(null===(c=document)||void 0===c?void 0:null===(s=c.location)||void 0===s?void 0:s.origin)+"/api/core/v1/boards/".concat(j.name,"/cards/").concat(null==eT?void 0:eT.name,"?token=").concat((null==eT?void 0:null===(d=eT.tokens)||void 0===d?void 0:d.read)||""),tA=(null==eT?void 0:eT.tokens)&&Object.keys(eT.tokens).length>0,tP=(0,n.jsx)(A.Kq,{children:tA?(0,n.jsxs)(w.FA,{space:"$4",children:[(0,n.jsx)(C.n,{fontSize:"$4",mb:"$2",children:"To read card content, use the following API endpoint:"}),(0,n.jsxs)(w.sL,{ai:"center",jc:"space-between",p:"$3",br:"$4",backgroundColor:"$backgroundStrong",gap:"$3",children:[(0,n.jsx)(C.n,{fontFamily:"monospace",fontSize:"$2",selectable:!0,children:tk}),(0,n.jsx)(k.zx,{size:"$2",chromeless:!0,icon:o.C,onPress:()=>navigator.clipboard.writeText(tk)})]}),(0,n.jsx)(C.n,{fontSize:"$4",mt:"$4",mb:"$2",children:"To execute the card, use:"}),(0,n.jsxs)(w.sL,{ai:"center",jc:"space-between",p:"$3",br:"$4",backgroundColor:"$backgroundStrong",gap:"$3",children:[(0,n.jsx)(C.n,{fontFamily:"monospace",fontSize:"$2",selectable:!0,style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:tS}),(0,n.jsx)(k.zx,{size:"$2",chromeless:!0,icon:o.C,onPress:()=>navigator.clipboard.writeText(tS)})]})]}):(0,n.jsx)(C.n,{fontSize:"$4",mb:"$2",children:"This card does not have API access enabled."})}),tI=async()=>{if(!H)return;let e=J.map(e=>e.key===eT.key?eO:e),t=(null==eT?void 0:eT.name)&&(null==eO?void 0:eO.name)&&eT.name!==eO.name;try{var r,n;if(await l$(e,eO),eq([]),t&&(null===(r=en.current)||void 0===r?void 0:r[eT.name])){let e=en.current[eT.name],t={...en.current};delete t[eT.name],t[eO.name]={...e,layer:null!==(n=eO.layer)&&void 0!==n?n:e.layer},th(t)}Z(e),ta.current.cards=e,await lj(j.name,ta.current,to,tl),eE(eO),eD(eO),eH(JSON.stringify(eO)),eG(!1)}catch(e){e instanceof ly?eq(e.errors):(console.error("Error checking card:",e),eq(["An unexpected error occurred while checking the card."]))}},tz=()=>{eP(!1),eE(null),eD(null),eH(null),eq([]),eG(!1)},tL=(0,n.jsx)(el.a,{open:ez,setOpen:eL,title:"Unsaved changes",description:"You have unsaved changes. Do you want to save them before closing?",hideAccept:!0,children:(0,n.jsx)(w.FA,{width:"100%",ai:"center",gap:"$4",mt:"$3",children:(0,n.jsxs)(w.sL,{gap:"$3",jc:"center",width:"100%",children:[(0,n.jsx)(k.zx,{flex:1,onPress:()=>eL(!1),children:"Cancel"}),(0,n.jsx)(k.zx,{flex:1,onPress:()=>{eL(!1),tz()},borderRadius:"$4",children:"Don't Save"}),(0,n.jsx)(Y.I,{children:(0,n.jsx)(k.zx,{flex:1,color:"white",backgroundColor:"$color6",borderRadius:"$4",onPress:async()=>{await tI(),eL(!1),tz()},children:"Save"})})]})})}),tR=e_.length?e_:(null==eT?void 0:eT.name)?[eT.name]:[],tF=tR.length>1?"Delete ".concat(tR.length," cards"):'Delete "'.concat(null!==(m=tR[0])&&void 0!==m?m:"",'"'),tW=tR.length>1?"Are you sure you want to delete the selected cards?":"Are you sure you want to delete this card?";return(0,n.jsxs)(w.FA,{flex:1,position:"relative",backgroundImage:(null==j?void 0:null===(u=j.settings)||void 0===u?void 0:u.backgroundImage)?"url(".concat(j.settings.backgroundImage,")"):void 0,backgroundSize:"cover",backgroundPosition:"center",children:[B&&(0,n.jsx)(w.sL,{position:"absolute",top:"$3",left:"$3",zIndex:20,px:"$3",py:"$2",br:"$6",backgroundColor:"$gray2",borderColor:"$gray6",borderWidth:1,children:(0,n.jsx)(S.x,{color:"$gray11",fontSize:"$3",fontWeight:"600",children:"Read-only"})}),(0,n.jsx)(eI,{board:j,addOpened:!!H&&E,setAddOpened:_,onFinish:tb,states:te,icons:$,actions:tu,errors:eU},e8),tL,(0,n.jsx)(el.a,{acceptButtonProps:{color:"white",backgroundColor:"$red9"},p:"$5",acceptCaption:"Delete",setOpen:eC,open:ew,onAccept:async()=>{tR.length&&await tg(tR),eW([]),eC(!1),eE(null)},acceptTint:"red",title:tF,description:tW}),(0,n.jsx)(el.a,{acceptButtonProps:{color:"white",backgroundColor:"$color6"},p:"$5",acceptCaption:"Close",setOpen:ek,open:eS,onAccept:()=>ek(!1),title:'Api Details for "'.concat(null==eT?void 0:eT.name,'"'),description:tP}),(0,n.jsx)(el.a,{open:eR,setOpen:eF,showCancel:!0,acceptCaption:"Relayout",cancelCaption:"Cancel",title:"Relayout Graph",description:"Are you sure you want to relayout? All graph positions will be reset and recalculated automatically.",onAccept:()=>{tp()}}),(0,n.jsx)(P.Q,{reset:!0,children:(0,n.jsx)(I.Vq,{modal:!0,open:eA,onOpenChange:e=>{e?eP(!0):eO&&eV&&JSON.stringify(eO)!==eV&&H?eL(!0):tz()},children:(0,n.jsxs)(I.Vq.Portal,{zIndex:1e5,overflow:"hidden",children:[(0,n.jsx)(I.Vq.Overlay,{}),(0,n.jsx)(I.Vq.Content,{bordered:!0,elevate:!0,animateOnly:["transform","opacity"],enterStyle:{x:0,y:-20,opacity:0,scale:.9},exitStyle:{x:0,y:10,opacity:0,scale:.95},gap:"$4",p:"$0",w:"90vw",bc:"$bgContent",h:"95vh",maw:1600,children:(0,n.jsx)(tT,{board:j,actions:tu,states:te,icons:$,card:eT,tab:e4,onSave:tI,onEdit:e=>{H&&(eD(e),eG(!0))},onClose:()=>{H&&tI(),tz()},errors:eU,readOnly:!H})})]})})}),(0,n.jsx)(P.Q,{reset:!0,children:(0,n.jsx)(I.Vq,{modal:!0,open:eM,onOpenChange:eN,children:(0,n.jsxs)(I.Vq.Portal,{zIndex:1e5,overflow:"hidden",children:[(0,n.jsx)(I.Vq.Overlay,{}),(0,n.jsx)(I.Vq.Content,{bordered:!0,elevate:!0,animateOnly:["transform","opacity"],enterStyle:{x:0,y:-20,opacity:0,scale:.9},exitStyle:{x:0,y:10,opacity:0,scale:.95},gap:"$4",w:"90vw",h:"95vh",maw:1600,children:(0,n.jsx)(lA,{masksPath:"/workspace/actions",id:"file-widget-"+eM,hideCloseIcon:!1,isModified:!0,setIsModified:()=>{},icons:[(0,n.jsx)(tE.q,{onPress:()=>{eN("")},children:(0,n.jsx)(i.X,{color:"var(--color)",size:"$1"})})],currentFileName:eM.split&&eM.split("/").pop(),currentFile:eM})})]})})}),(0,n.jsxs)(w.sL,{f:1,children:[(0,n.jsx)(w.FA,{f:1,children:e1?(0,n.jsx)(lb,{language:"json",darkMode:"dark"===e7,sourceCode:(e=>{let t=e;try{let r=JSON.parse(e);t=JSON.stringify(r,null,2)}catch(e){}return t})(K),onChange:ee,options:{formatOnPaste:!0,formatOnType:!0}}):"graph"===M?(0,n.jsx)(lp,{cards:t$,layout:et,onLayoutChange:H?th:void 0,activeLayer:ep,onSelectLayer:e=>eh(e),onDeleteNodes:H?e=>{eW(e),eC(!0)}:void 0,onDeleteEdges:H?tx:void 0,onCreateEdge:H?tv:void 0,onSelectionChange:eZ,selectedIds:eJ,readOnly:!H}):(0,n.jsx)(w.FA,{f:1,p:"$6",children:t$.length>0&&null!==J?(0,n.jsx)(R.Zq,{extraScrollSpace:50,items:t$,settings:j.settings,layouts:ta.current.layouts,isDraggable:H,isResizable:H,onWidthChange:e=>{eY.current=(0,R.w7)(e)},onLayoutChange:(e,t)=>{if(H){if(G.current==eY.current){G.current=null;return}JSON.stringify(ta.current.layouts[eY.current])!=JSON.stringify(e)&&(clearTimeout(U.current),U.current=setTimeout(()=>{let t=eY.current,r=[...(ta.current.layouts[t]||[]).filter(t=>!e.find(e=>e.i===t.i)),...e];ta.current.layouts[t]=r,lj(j.name,ta.current,to,tl,{bumpVersion:!1})},100))}},onBreakpointChange:e=>{clearInterval(U.current),console.log("Breakpoint changed to: ",e),eY.current=e,G.current=e,setTimeout(()=>{G.current=null},1e3)}}):null!==J?(0,n.jsxs)(w.FA,{f:1,top:-100,ai:"center",jc:"center",gap:"$5",o:.1,className:"no-drag",children:[(0,n.jsxs)(z.H1,{children:[j.name," is empty"]}),(0,n.jsx)(z.H3,{children:"Click on the + button to add a new card"})]}):null})}),(0,n.jsx)(ea.bP,{style:{display:"ui"===M?"block":"none",position:"absolute",width:"100%",height:"100%",backgroundColor:"var(--bgContent)"},html:null!==(b=null==ej?void 0:ej.code)&&void 0!==b?b:"",data:{board:j,state:null==te?void 0:null===(p=te.boards)||void 0===p?void 0:p[j.name]},setData:e=>console.log("set data from board",e)}),(0,n.jsx)(lF,{tabVisible:W,setTabVisible:O,board:j,automationInfo:eb,boardRef:ta,actions:tu,states:te,uicodeInfo:ej,setUICodeInfo:e$,onEditBoard:tj,deviceActions:{uploadConfigFile:ti,flashDevice:ts,viewLogs:tc},readOnly:!H}),(0,n.jsx)(w.FA,{position:"fixed",left:0,height:"100vh",width:"100vw",display:"visualui"===W?"flex":"none",children:e9}),td]})]})},lE=e=>{var t;let{workspace:r,boardData:o,iconsData:l,params:a,pageSession:i}=e;return(0,n.jsx)(tD.P,{ready:"loading"!=o.status&&"loading"!=l.status,children:(0,n.jsx)(tH.QI,{board:null==o?void 0:o.data,autopilotRunning:null==o?void 0:null===(t=o.data)||void 0===t?void 0:t.autopilot,boardName:a.board,children:(0,n.jsx)(lW,{params:a,pageSession:i,workspace:r,boardData:o,iconsData:l})})})},l_=null,lW=e=>{var t,r,o,l,a;let{params:i,pageSession:s,workspace:c,boardData:d,iconsData:u}=e,{toggleJson:p,saveJson:h,toggleAutopilot:g,openAdd:x,setTabVisible:v,tabVisible:f,viewMode:b,setViewMode:y,canWrite:$}=(0,tH.dQ)(),w=e=>{y(e)},[C]=(0,Q.wj)();return(l_=null==d?void 0:null===(t=d.data)||void 0===t?void 0:t.version,(null==i?void 0:i.mode)==="ui")?"error"==d.status?(0,n.jsx)(j.Z,{msg:"Error loading board",details:d.error.error}):"loaded"==d.status?(0,n.jsx)(lT,{forceViewMode:"ui",board:d.data,icons:null===(l=u.data)||void 0===l?void 0:l.icons},(null==d?void 0:null===(a=d.data)||void 0===a?void 0:a.name)+"_"+C):null:(0,n.jsxs)(m.D,{title:i.board+" board",workspace:c,pageSession:s,onActionBarEvent:e=>{"toggle-rules"===e.type&&v("rules"===f?"":"rules"),"toggle-history"===e.type&&v("history"===f?"":"history"),"toggle-logs"===e.type&&v("logs"===f?"":"logs"),"toggle-states"===e.type&&v("states"===f?"":"states"),"toggle-devices"===e.type&&v("devices"===f?"":"devices"),"toggle-uicode"===e.type&&v("uicode"===f?"":"uicode"),"toggle-visualui"===e.type&&v("visualui"===f?"":"visualui"),"toggle-json"===e.type&&p(),"save-json"===e.type&&h(),"toggle-autopilot"===e.type&&g(),"open-add"===e.type&&$&&x(),"board-settings"===e.type&&v("board-settings"===f?"":"board-settings"),"relayout"===e.type&&$&&window.dispatchEvent(new CustomEvent("board:relayout")),"mode-ui"===e.type&&w("ui"),"mode-board"===e.type&&w("board"),"mode-graph"===e.type&&w("graph")},actionBar:{visible:"visualui"!=f&&(null==i?void 0:i.mode)!=="ui"},children:["error"==d.status&&(0,n.jsx)(j.Z,{msg:"Error loading board",details:d.error.error}),"loaded"==d.status&&(0,n.jsx)(lT,{forceViewMode:i.view,board:d.data,icons:null===(r=u.data)||void 0===r?void 0:r.icons},(null==d?void 0:null===(o=d.data)||void 0===o?void 0:o.name)+"_"+C)]})},lO=e=>{let{workspace:t,pageState:r,initialItems:o,itemData:l,pageSession:a,extraData:i,board:s,icons:c}=e,{params:d}=lC(),[u,p]=(0,F.useState)(null!=s?s:(0,f.getPendingResult)("pending")),{refresh:h}=(0,oO.lV)(d.board),[g]=(0,Q.wj)(),x=async()=>{if(l_=null,g){let e=await f.API.get({url:"/api/core/v1/boards/".concat(d.board,"/")});e.isError||p(e)}};(0,ei.rf)(()=>{x()},[g]),(0,tW.a)(e=>{f.API.get({url:"/api/core/v1/boards/".concat(d.board,"/")},e)},p,s),(0,F.useEffect)(()=>{h(!0)},[d.board]);let[v,m]=(0,F.useState)(null!=c?c:(0,f.getPendingResult)("pending"));return(0,tW.a)(e=>{f.API.get({url:"/api/core/v1/icons"},e)},m,c),(0,b.c)(()=>{var e,t,r,n,o;return"/workspace/auth/login?return="+(null===(t=document)||void 0===t?void 0:null===(e=t.location)||void 0===e?void 0:e.pathname)+(null!==(o=null===(n=document)||void 0===n?void 0:null===(r=n.location)||void 0===r?void 0:r.search)&&void 0!==o?o:"")}),(0,rO.uF)((e,t)=>{var r,n;let o=null==t?void 0:null===(n=t.parsed)||void 0===n?void 0:null===(r=n.payload)||void 0===r?void 0:r.data;console.log("Received board update event for board: ",o.name),p({status:"loaded",data:o})},{path:"boards/update/"+d.board}),(0,n.jsx)(lE,{workspace:t,boardData:u,iconsData:v,params:d,pageSession:a})}},77843:function(e,t,r){r.d(t,{M:function(){return l},oI:function(){return a},uS:function(){return n}});let n=(e,t)=>{try{return("boards"===t?"states?.boards":"board")+e.filter(e=>e).map(e=>"?.[".concat(JSON.stringify(e),"]")).join("")}catch(t){return console.error("cannot generate state code for "+e+", ",t),""}},o=e=>{try{if(!e)return"{}";return"{ ".concat(Object.entries(e).map(e=>{let[t,r]=e;return"\n	".concat(t,": ").concat("string"==typeof r?"'".concat(r,"'"):r,", // ").concat(r)}).join("")," \n}")}catch(e){return"{}"}},l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0;try{let n=o(t);if("board"===r)return'await board.execute_action({name: "'.concat(e,'", params: ').concat(n,"})");return'await executeAction({name: "'.concat(e,'", params: ').concat(n,"})")}catch(t){return console.error("cannot generate action code for "+e+", ",t),""}},a=e=>{try{return"params"+e.filter(e=>e).map(e=>"?.[".concat(JSON.stringify(e),"]")).join("")}catch(t){return console.error("cannot generate param code for "+e+", ",t),""}}},57494:function(e,t,r){r.d(t,{T:function(){return l},_:function(){return a}});var n=r(2784),o=r(79564);let l={trace:10,debug:20,info:30,warn:40,error:50,fatal:60},a=(e,t,r,a)=>{let i=(0,o.Z)("logs"+(t?"/".concat(t):"/+")+(r?"/".concat(l[r]):"/+")+(a?"/".concat(a):"/#")),s=(0,n.useRef)(0),[c,d]=(0,n.useState)(null),u=(0,n.useRef)();return u.current=e,(0,n.useEffect)(()=>{if(!(null==i?void 0:i.onMessage))return;let e=i.onMessage(e=>{try{var t;let r=JSON.parse(e.message);if(e.id<=s.current)return;s.current=e.id;let n={...e,parsed:r};null===(t=u.current)||void 0===t||t.call(u,n),d(n)}catch(e){console.error("Error parsing MQTT message:",e)}});return()=>{null==e||e()}},[null==i?void 0:i.onMessage,a,t,r]),c}},20176:function(e,t,r){r.d(t,{TX:function(){return N},tY:function(){return B}});var n=r(52322),o=r(2784),l=r(37288),a=r(17518),i=r(94291),s=r(47401),c=r(59316),d=r(93075),u=r(26602),p=r(66270),h=r(91477),g=r(15641),x=r(82468),v=r(41585),f=r(72857),m=r(83716),b=r(97344),y=r(57909),j=r(32627),$=r(23427),w=r(41473),C=r(64335),S=r(61773),k=r(57441),A=r(831),P=r(49140),I=r(50042),z=r(34178),L=r(42581),R=r(70142),F=r(86184),T=r(40826),E=r(3443),_=r(69517),W=r(75434),O=r(25184),D=r(70952),M=r(19940);let N=e=>{switch(null==e?void 0:e.toLowerCase()){case"android":case"mobile":return g.r;case"ventoagent":case"desktop":case"computer":return x.u;case"esphome":case"arduino":return v.x;default:return f.r}},V=(0,o.memo)(e=>{let{label:t,color:r}=e;return(0,n.jsx)(l.sL,{br:"$10",px:"$2",py:"$0.5",bg:r||"$color4",ai:"center",children:(0,n.jsx)(a.x,{fontSize:9,fontWeight:"500",color:"$color8",numberOfLines:1,children:t})})}),H=(0,o.memo)(e=>{let{cards:t}=e,r=(null==t?void 0:t.slice(0,5))||[],o=((null==t?void 0:t.length)||0)-5;return r.length?(0,n.jsxs)(l.sL,{gap:"$1",ai:"center",flexWrap:"wrap",children:[r.map((e,t)=>(0,n.jsx)(l.FA,{w:18,h:18,br:"action"===e.type?"$10":"$1",bg:e.color||"$color6",ai:"center",jc:"center",opacity:.85,children:e.icon&&(0,n.jsx)("img",{src:(0,F.m_)(e.icon),width:10,height:10,style:{filter:"brightness(0) invert(1)",opacity:.9}})},t)),o>0&&(0,n.jsxs)(a.x,{fontSize:9,color:"$color8",ml:"$1",children:["+",o]})]}):null}),B=(0,o.memo)(e=>{var t,r;let{board:g,platform:x="virtual",isConnected:v,isHidden:f,isPending:F=!1,isRunning:B=!1,selected:G=!1,showNavIcons:U=!1,mode:q="card",handlePosition:J,onPress:Z,onDelete:K,onApprove:Y,onReject:X,width:Q}=e,ee=(0,D.t)(),et=(0,M.Tg)("boards.update"),er=(0,M.Tg)("templates.execute"),[en,eo]=(0,o.useState)(!1),[el,ea]=(0,o.useState)(!1),[ei,es]=(0,o.useState)(null),[ec,ed]=(0,o.useState)(""),[eu,ep]=(0,o.useState)(""),eh=[{key:"graph",label:"Graph",Icon:I.h},{key:"board",label:"Dashboard",Icon:z.y},{key:"ui",label:"Presentation",Icon:L.A}],eg=(e,t)=>{var r,n;null===(r=t.stopPropagation)||void 0===r||r.call(t),null===(n=t.preventDefault)||void 0===n||n.call(t),ee.push("/boards/view?board=".concat(null==g?void 0:g.name,"#").concat(e))},ex=void 0!==v,ev=null!=v&&v,ef=N(x),em=(null==g?void 0:g.cards)||[],eb=(null==g?void 0:g.tags)||[],ey=(null==g?void 0:g.displayName)||(null==g?void 0:g.name),ej=null==g?void 0:g.autopilot,e$=null!=f?f:!(0,T.s)(g,"agents"),ew=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("style",{children:"\n        @keyframes networkCardPulse {\n          0%, 100% { box-shadow: 0 4px 12px rgba(0,0,0,0.1), 0 0 8px var(--color6); }\n          50% { box-shadow: 0 4px 12px rgba(0,0,0,0.1), 0 0 14px var(--color7); }\n        }\n      "}),(0,n.jsx)("div",{style:{width:"node"===q?260:Q||"100%",height:"node"===q?140:"auto",minHeight:"card"===q?140:void 0,maxWidth:"card"===q?Q||400:void 0,borderRadius:"var(--radius-4)",position:"relative",animation:B?"networkCardPulse 2s ease-in-out infinite":void 0,boxShadow:B?void 0:G?"0 12px 32px rgba(0,0,0,0.25), 0 0 0 2px var(--color9)":ex&&ev?"0 6px 20px rgba(0,0,0,0.12), 0 0 20px rgba(var(--color9-rgb), 0.15)":"0 4px 12px rgba(0,0,0,0.1)"},children:(0,n.jsxs)(l.FA,{width:"100%",height:"100%",minHeight:"card"===q?140:void 0,br:"$4",bg:B?"$color2":G?"$color2":"$bgPanel",borderWidth:B?2:ex&&ev?2:1,borderColor:B?"$color7":ex?ev?"$color8":"$gray6":"$color6",cursor:"pointer",hoverStyle:Z?{borderColor:ex?ev?"$color8":"$gray7":"$color8",scale:1.01}:{},pressStyle:Z?{scale:.98}:{},onPress:Z,position:"relative",children:[e$&&(0,n.jsx)(R.I,{children:(0,n.jsx)(i.w,{label:"This board is hidden from default views. You can still see it when showing boards from all views.",delay:{open:500,close:0},restMs:0,children:(0,n.jsxs)(l.sL,{position:"absolute",top:-10,right:10,bg:"$yellow9",br:"$2",px:"$2",py:"$1",ai:"center",gap:"$1",zIndex:10,children:[(0,n.jsx)(w.u,{size:12,color:"black"}),(0,n.jsx)(a.x,{fontSize:10,fontWeight:"600",color:"black",numberOfLines:1,children:"Hidden board"})]})})}),F&&(0,n.jsx)(R.I,{children:(0,n.jsx)(i.w,{label:"This device is waiting for enrollment approval",delay:{open:500,close:0},restMs:0,children:(0,n.jsxs)(l.sL,{position:"absolute",top:-10,right:10,bg:"$orange9",br:"$2",px:"$2",py:"$1",ai:"center",gap:"$1",zIndex:10,children:[(0,n.jsx)(C.S,{size:12,color:"white"}),(0,n.jsx)(a.x,{fontSize:10,fontWeight:"600",color:"white",children:"Pending Enrollment"})]})})}),(0,n.jsx)(l.FA,{p:"$3",pb:"$2",zIndex:1,children:(0,n.jsxs)(l.sL,{ai:"flex-start",jc:"space-between",children:[(0,n.jsxs)(l.sL,{ai:"center",gap:"$2",f:1,onPress:Z,children:[(0,n.jsx)(R.I,{children:(0,n.jsx)(l.FA,{w:36,h:36,br:"$3",ai:"center",jc:"center",bg:ex?ev?"$color5":"$bgContent":"$color5",children:(0,n.jsx)(ef,{size:20,color:ex?ev?"var(--color10)":"var(--gray9)":"var(--color10)"})})}),(0,n.jsxs)(l.FA,{f:1,children:[(0,n.jsxs)(l.sL,{ai:"center",gap:"$1",children:[(0,n.jsx)(a.x,{fontSize:"$3",fontWeight:"700",color:"color9",numberOfLines:1,style:{maxWidth:"card"===q?200:140},children:ey}),ej&&(0,n.jsx)($.P,{size:12,color:"var(--color9)"})]}),(0,n.jsx)(a.x,{fontSize:10,color:"$color8",numberOfLines:1,children:null==g?void 0:g.name})]})]}),(0,n.jsx)(l.sL,{ai:"center",gap:"$2",children:F?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.zx,{size:"$2",theme:"green",onPress:e=>{e.stopPropagation(),null==Y||Y(g)},icon:S.J,children:"Approve"}),(0,n.jsx)(s.zx,{size:"$2",chromeless:!0,color:"$red10",onPress:e=>{e.stopPropagation(),null==X||X(g)},icon:k.X})]}):(0,n.jsxs)(n.Fragment,{children:[ex&&(ev?(0,n.jsxs)(l.sL,{ai:"center",gap:"$1",bg:"$color2",br:"$10",px:"$2",py:"$1",children:[(0,n.jsx)(m.k,{size:10,color:"var(--color10)"}),(0,n.jsx)(a.x,{fontSize:9,fontWeight:"600",color:"$color8",children:"ON"})]}):(0,n.jsxs)(l.sL,{ai:"center",gap:"$1",bg:"$gray3",br:"$10",px:"$2",py:"$1",children:[(0,n.jsx)(b.N,{size:10,color:"var(--gray8)"}),(0,n.jsx)(a.x,{fontSize:9,fontWeight:"500",color:"$gray9",children:"OFF"})]})),K&&(0,n.jsx)(l.sL,{onClick:e=>{var t,r;null===(t=e.stopPropagation)||void 0===t||t.call(e),null===(r=e.preventDefault)||void 0===r||r.call(e)},onPointerDown:e=>{var t;null===(t=e.stopPropagation)||void 0===t||t.call(e)},children:(0,n.jsx)(E.o,{type:"item",sourceUrl:"/api/core/v1/boards/".concat(null==g?void 0:g.name),element:{data:g},deleteable:()=>!0,onDelete:K,extraMenuActions:[{text:"Settings",icon:A.O,action:e=>{var t;let r=null!==(t=null==e?void 0:e.data)&&void 0!==t?t:e;eo(!0),es({data:r})},isVisible:()=>et},{text:"Create template",icon:P.b,action:e=>{var t;let r=null!==(t=null==e?void 0:e.data)&&void 0!==t?t:e;ea(!0),es({data:r}),ep((null==r?void 0:r.name)||"")},isVisible:()=>er}]})})]})})]})}),U&&(0,n.jsx)(l.sL,{gap:"$3",ai:"center",jc:"flex-start",px:"$3",mb:"$3",mt:"$2",zIndex:1,onClick:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),children:(0,n.jsx)(R.I,{children:eh.map(e=>{let{key:t,Icon:r,label:o}=e;return(0,n.jsx)(_.z,{Icon:r,IconColor:"var(--color10)",bc:"$bgContent",hoverStyle:{bc:"var(--color5)"},pressStyle:{o:.8},size:20,tooltip:o,onClick:e=>eg(t,e)},t)})})}),(0,n.jsxs)(l.FA,{px:"$3",pb:"$3",gap:"$2",zIndex:1,children:[em.length>0&&(0,n.jsxs)(l.sL,{ai:"center",gap:"$2",children:[(0,n.jsx)(y.S,{size:11,color:"var(--color8)"}),(0,n.jsx)(H,{cards:em}),em.length>0&&(0,n.jsxs)(a.x,{fontSize:9,color:"$color8",children:[em.length," card",1!==em.length?"s":""]})]}),eb.length>0&&(0,n.jsxs)(l.sL,{ai:"center",gap:"$1",flexWrap:"wrap",children:[(0,n.jsx)(j.V,{size:10,color:"var(--color8)"}),eb.slice(0,3).map((e,t)=>(0,n.jsx)(R.I,{children:(0,n.jsx)(V,{label:e})},t)),eb.length>3&&(0,n.jsxs)(a.x,{fontSize:9,color:"$color8",children:["+",eb.length-3]})]}),(0,n.jsx)(l.sL,{ai:"center",jc:"space-between",children:(0,n.jsx)(l.sL,{br:"$2",px:"$2",py:"$0.5",bg:"$color2",children:(0,n.jsx)(a.x,{fontSize:9,fontWeight:"600",color:"$color10",textTransform:"uppercase",children:x})})})]})]})})]}),eC=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Vq,{open:en,onOpenChange:eo,children:(0,n.jsxs)(c.Vq.Portal,{className:"DialogPopup",children:[(0,n.jsx)(c.Vq.Overlay,{className:"DialogPopup"}),(0,n.jsxs)(c.Vq.Content,{overflow:"hidden",p:0,width:700,maxHeight:"85vh",backgroundColor:"$bgContent",className:"DialogPopup",onClick:e=>{e.stopPropagation()},onMouseDown:e=>{e.stopPropagation()},onPointerDown:e=>{e.stopPropagation()},children:[(0,n.jsx)(a.x,{pt:"$4",px:"$4",fos:"$8",fow:"600",className:"DialogPopup",children:"Settings"}),(0,n.jsx)(W.m,{board:null!==(r=null==ei?void 0:ei.data)&&void 0!==r?r:ei,onSave:async e=>{await O.API.post("/api/core/v1/boards/".concat(e.name),e),es(null),eo(!1)}}),(0,n.jsx)(c.Vq.Close,{})]})]})}),(0,n.jsx)(c.Vq,{open:el,onOpenChange:ea,children:(0,n.jsxs)(c.Vq.Portal,{className:"DialogPopup",children:[(0,n.jsx)(c.Vq.Overlay,{className:"DialogPopup"}),(0,n.jsxs)(c.Vq.Content,{overflow:"hidden",p:"$8",height:"400px",width:"400px",backgroundColor:"$bgContent",className:"DialogPopup",onClick:e=>{e.stopPropagation()},onMouseDown:e=>{e.stopPropagation()},onPointerDown:e=>{e.stopPropagation()},children:[(0,n.jsxs)(l.FA,{height:"100%",justifyContent:"space-between",children:[(0,n.jsx)(a.x,{fos:"$8",fow:"600",mb:"$3",className:"DialogPopup",children:"Agent Template"}),(0,n.jsx)(l.sL,{ai:"center",className:"DialogPopup",children:(0,n.jsx)(d.__,{ml:"$2",h:"$3.5",size:"$5",className:"DialogPopup",children:"Name"})}),(0,n.jsx)(u.II,{br:"8px",className:"DialogPopup",value:eu,onChange:e=>ep(e.target.value)}),(0,n.jsx)(l.sL,{ai:"center",className:"DialogPopup",children:(0,n.jsx)(d.__,{ml:"$2",h:"$3.5",size:"$5",className:"DialogPopup",children:"Description"})}),(0,n.jsx)(u.II,{br:"8px",className:"DialogPopup",value:ec,onChange:e=>ed(e.target.value)}),(0,n.jsx)(l.FA,{flex:1,className:"DialogPopup"}),(0,n.jsx)(s.zx,{className:"DialogPopup",onMouseDown:e=>{e.stopPropagation()},onPointerDown:e=>{e.stopPropagation()},onPress:async e=>{e.stopPropagation();try{var t;await O.API.post("/api/core/v2/templates/boards",{name:eu,description:ec,from:null==ei?void 0:null===(t=ei.data)||void 0===t?void 0:t.name}),es(null),ea(!1)}catch(e){console.log("e: ",e)}},children:"Create"})]}),(0,n.jsx)(c.Vq.Close,{})]})]})},null==ei?void 0:null===(t=ei.data)||void 0===t?void 0:t.name)]});return"node"===q?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{style:{position:"relative"},children:[ew,(0,n.jsx)(p.HH,{type:"target",position:J||h.Ly.Left,id:"input",style:{opacity:0,pointerEvents:"none"}})]}),eC]}):(0,n.jsxs)(n.Fragment,{children:[ew,eC]})})},56274:function(e,t,r){r.d(t,{B5:function(){return p},bP:function(){return m}});var n=r(52322),o=r(37288);r(82125),r(78031);var l=r(25184),a=r(2784);r(45467);var i=r(70142),s=r(78994);let c=(0,a.forwardRef)((e,t)=>{let{children:r,status:l,hideTitle:c,hideFrame:d,id:u,title:p,header:h,titleProps:g={},containerProps:x={},highlighted:v=!1}=e,[f,m]=(0,a.useState)(!1),b=(0,a.useRef)(0);return(0,a.useEffect)(()=>{if("running"===l){let e=Date.now();b.current=e+1e3,m(!0)}else if("running"!==l){let e=Date.now(),t=b.current-e;if(t<=0)m(!1);else{let e=setTimeout(()=>{m(!1)},t);return()=>clearTimeout(e)}}},[l]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("style",{children:"\n        @keyframes dashOffset {\n          0% { stroke-dashoffset: 100; }\n          100% { stroke-dashoffset: 0; }\n        }\n      "}),(0,n.jsx)(i.I,{children:(0,n.jsxs)(o.FA,{ref:t,enterStyle:{scale:.4,opacity:0},animation:"quick",cursor:"default",id:u,borderRadius:"var(--radius-6)",flex:1,position:"relative",...x,backgroundColor:d?"transparent":x.bgColor||x.backgroundColor||"var(--bgPanel)",style:{height:"100%",overflow:"hidden",...x.style},children:[(f||v)&&(0,n.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:0,pointerEvents:"none"},children:(0,n.jsx)("svg",{width:"100%",height:"100%",children:(0,n.jsx)("rect",{x:"1",y:"1",width:"calc(100% - 2px)",height:"calc(100% - 2px)",fill:"none",stroke:"var(--color7)",strokeWidth:v?"3":"2",rx:"10",ry:"10",...v?{}:{strokeDasharray:"8 4",strokeDashoffset:"0",style:{animation:"dashOffset 2s linear infinite"}}})})}),!f&&"running"!==l&&(0,n.jsx)(o.FA,{position:"absolute",top:0,left:0,right:0,bottom:0,borderRadius:"var(--radius-6)",borderWidth:v?3:2,borderStyle:v?"solid":"dashed",borderColor:"error"===l?"var(--red7)":"transparent",pointerEvents:"none",style:{zIndex:0}}),h,p&&!c&&!h&&(0,n.jsx)(o.sL,{w:"100%",btrr:9,btlr:9,mt:"$3",h:20,ai:"center",zIndex:1,...g,children:(0,n.jsx)(s.n,{flex:1,fow:"500",textOverflow:"ellipsis",textAlign:"center",overflow:"hidden",whiteSpace:"nowrap",fos:"$4",children:p})}),(0,n.jsx)(o.FA,{flex:1,style:{overflowY:"auto",maxHeight:"100%",zIndex:1},children:r})]},u)})]})});var d=r(6364),u=r(56334);let p=(0,a.forwardRef)((e,t)=>{let{highlighted:r=!1,status:l,title:a,hideTitle:i,hideFrame:s,id:d,children:u,onPress:p=()=>{},onDoubleClick:h,...g}=e;return(0,n.jsx)(c,{ref:t,highlighted:r,status:l,hideTitle:i,hideFrame:s,title:a,id:d,...g,children:(0,n.jsx)(o.FA,{height:"100%",onPress:p,onDoubleClick:h,borderRadius:10,backgroundColor:"$bgColor",flex:1,children:u})})}),h=(e,t,r)=>{try{return Function("data","\n            ".concat(t,"\n            ").concat(e,"\n        "))(r)}catch(e){return console.error(e),""}},g=null,x=null,v=e=>{if(g){e(g);return}if(x){x.push(e);return}x=[e],l.API.get("/api/core/v1/viewLib",null,!0).then(e=>{g=e.data,x.forEach(e=>e(g)),x=null}).catch(e=>{console.error("Failed to load view library:",e),x.forEach(e=>e(null)),x=null})},f={},m=e=>{let{html:t,data:r,setData:o=()=>{},...l}=e,[i,s]=(0,a.useState)(null!==g),[c,p]=(0,a.useState)(()=>(0,d.Z)()),[x,m]=(0,a.useState)(()=>(0,d.Z)()),b=(0,a.useRef)(),[y,j]=(0,u.U)();void 0===f[c]&&(f[c]={});let $=t.match(/^\/\/ ?@([^\n\r]*)/);if($&&$[1]){let e=t.match(/^[ \t\r\n]*\/\/ ?@([^\n\r]*)/m),r=e?e[1].trim():null;("card/react"===r||"card/reactframe"===r)&&(t="reactCard(`"+t.replace(/\\/g,"\\\\").replace(/`/g,"\\`")+"`, data.domId, data)")}let w=e=>e.includes("reactCard")||e.includes("//@react")||e.includes("//@card/react")||e.includes("// @react")||e.includes("// @card/react"),C={...r,theme:y,domId:c,setCardData:e=>o(e),cardState:f[c],setCardState:e=>{f[c]&&Object.assign(f[c],e)}},S=(0,a.useRef)(null);return(0,a.useEffect)(()=>{w(t)&&m((0,d.Z)())},[t]),(0,a.useEffect)(()=>{if(i&&g&&w(t)){if(!document.getElementById(c)){console.warn("⚠️ div not ready yet, skipping reactCard execution for",c);return}console.log("\uD83D\uDD01 Running getHTML (ReactCard) for:",c);try{h(t,g,C)}catch(e){console.error("❌ Error executing getHTML for reactCard:",e)}}},[x,i,g]),(0,a.useEffect)(()=>{var e,r,n;if(i&&g){if(t==b.current&&w(t)&&(null===(e=window._reactWidgets)||void 0===e?void 0:e[c])){null===(r=(n=window).updateReactCardProps)||void 0===r||r.call(n,c,C);return}if(console.log("not a react card or code changed, updating..."),b.current=t,S.current&&!w(t)){let e=h(t,g,C);S.current.innerHTML=e}}},[t,JSON.stringify(r),g,i]),(0,a.useEffect)(()=>(i||v(e=>{if(!e){console.error("Failed to load view library");return}g=e,s(!0)}),()=>{delete f[c]}),[]),(0,n.jsx)("div",{id:c,ref:S,...l},x)}},97909:function(e,t,r){r.d(t,{Zq:function(){return p},w7:function(){return u}});var n=r(52322),o=r(66244),l=r(22522),a=r(70142),i=r(25184),s=r(12497);let c=(0,o.WidthProvider)(o.Responsive),d={lg:1500,md:800,sm:400,xs:0},u=(e,t)=>(t||(t=d),e>=t.lg?"lg":e>=t.md?"md":e>=t.sm?"sm":"xs"),p=e=>{let{items:t=[],layouts:r={},borderRadius:o=10,padding:u=10,settings:p={},extraScrollSpace:h=0,...g}=e,[x]=(0,s.cY)(),v=t.filter(e=>(e.layer||"base")===x),f=["n","s","e","w","ne","nw","se","sw"],m=Object.fromEntries(Object.entries(r).map(e=>{let[t,r]=e;return[t,r.map(e=>({...e,resizeHandles:f}))]}));return(0,n.jsx)(a.I,{children:(0,n.jsx)(l.Kq,{style:h?{height:"100%",overflow:"auto",flex:1,minHeight:0,paddingBottom:h,boxSizing:"border-box"}:{},children:(0,n.jsx)(c,{...g,className:"layout",layouts:m,margin:[6,6],breakpoints:d,rowHeight:30,draggableCancel:".no-drag",...p,style:{...g.style,...p.style},cols:{lg:i.gridSizes.lg.totalCols,md:i.gridSizes.md.totalCols,sm:i.gridSizes.sm.totalCols,xs:i.gridSizes.xs.totalCols},children:v.map(e=>(0,n.jsx)(l.Kq,{flex:1,children:e.content},e.key))},x)})})}},31933:function(e,t,r){r.d(t,{Q:function(){return l}});var n=r(52322),o=r(37288);let l=r(2784).forwardRef((e,t)=>{var r;return(0,n.jsxs)(o.FA,{ref:t,pos:"relative",elevation:"$4",py:"$4",pt:"$6",pb:"$10",zIndex:1,br:null!==(r=e.br)&&void 0!==r?r:void 0,...e,children:[(0,n.jsx)(o.FA,{fullscreen:!0,bc:"$color3",zi:-1,o:.25,btw:1,btc:"$borderColor",br:e.br}),e.children]})});t.Z=l},96082:function(e,t,r){r.d(t,{g:function(){return i}});var n=r(52322),o=r(2784),l=r(35827),a=r(37288);let i=o.forwardRef((e,t)=>(0,n.jsx)(l._k,{ref:t,children:(0,n.jsx)(a.sL,{flex:1,overflow:"hidden",maxWidth:"100%",space:"$8",flexWrap:"nowrap",px:"$2",mb:-8,$sm:{flexDirection:"column"},$gtSm:{px:"$6"},...e,children:e.children})}));t.Z=i},46988:function(e,t,r){r.d(t,{J:function(){return C}});var n=r(52322),o=r(80270),l=r(83326),a=r(18865),i=r(81815),s=r(87074),c=r(71582),d=r(68019),u=r(34063),p=r(44),h=r(31657),g=r(45557),x=r(42853),v=r(65046),f=r(92577),m=r(33782),b=r(9657),y=r(23585),j=r(24450),$=r(32080),w=r(17477);let C=e=>{let{name:t,color:r,size:C}=e,S={color:r,size:C};switch(t){case"bold":return(0,n.jsx)(f.d,{...S});case"italic":return(0,n.jsx)(m.T,{...S});case"wallpaper":return(0,n.jsx)($.v,{...S});case"row":return(0,n.jsx)(h.c,{...S});case"row-reverse":return(0,n.jsx)(g.i,{...S});case"column-reverse":return(0,n.jsx)(x._,{...S});case"column":return(0,n.jsx)(v.D,{...S});case"start":return(0,n.jsx)(c.Y,{...S});case"end":return(0,n.jsx)(d.Q,{...S});case"ArrowLeft":case"left":return(0,n.jsx)(b.X,{...S});case"ArrowRight":case"right":return(0,n.jsx)(y.o,{...S});case"justify":return(0,n.jsx)(j.I,{...S});case"stretch":return(0,n.jsx)(u.V,{...S});case"center":return(0,n.jsx)(p.c,{...S});case"text":return(0,n.jsx)(w.x,{...S});case"type":return(0,n.jsx)(l.D,{...S});case"media":return(0,n.jsx)(s.E,{...S});case"layout":return(0,n.jsx)(i.J,{...S});case"pressable":return(0,n.jsx)(a.J,{...S});default:return(0,n.jsx)(o.w,{...S})}}},86184:function(e,t,r){r.d(t,{N1:function(){return d},m_:function(){return c},xG:function(){return h}});var n=r(52322),o=r(2784),l=r(86417),a=r(55648),i=r(37288),s=r(17518);let c=e=>"/public/icons/".concat(e,".svg"),d=e=>{let{size:t=40,name:r,color:o="var(--color8)"}=e;return(0,n.jsx)("span",{"aria-label":r,role:"img",style:{display:"inline-block",width:t,height:t,verticalAlign:"middle",backgroundColor:o,mask:"url(".concat(c(r),") no-repeat center / contain"),WebkitMask:"url(".concat(c(r),") no-repeat center / contain")}})},u=e=>(0,n.jsx)(l.c.Option,{...e,children:(0,n.jsxs)(i.FA,{style:{display:"flex",alignItems:"center",gap:"8px",width:"95px",height:"95px",justifyContent:"center"},children:[(0,n.jsx)(d,{name:e.data.value}),(0,n.jsx)(s.x,{fos:"$2",o:.6,ta:"center",height:"30px",children:e.data.value})]})}),p=e=>{let{data:t,...r}=e;return(0,n.jsx)(l.c.SingleValue,{...r,children:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"0px 4px"},children:[(0,n.jsx)("span",{"aria-label":t.value,role:"img",style:{display:"inline-block",width:24,height:24,verticalAlign:"middle",backgroundColor:"var(--color8)",mask:"url(".concat(c(t.value),") no-repeat center / contain"),WebkitMask:"url(".concat(c(t.value),") no-repeat center / contain")}}),(0,n.jsx)("span",{style:{color:"var(--color)"},children:t.value})]})})},h=e=>{let{icons:t,onSelect:r,selected:l,disabled:i=!1}=e,[s,c]=(0,o.useState)(l?{value:l,label:l}:null),[d,h]=(0,o.useState)(40),g=t.map(e=>({value:e,label:e})).slice(0,d);return(0,n.jsx)("div",{style:{flex:1},children:(0,n.jsx)(a.ZP,{options:g,components:{SingleValue:p,Option:u},onMenuScrollToBottom:e=>{h(e=>e+40)},onChange:e=>{i||(c(e),null==r||r(e.value))},onInputChange:e=>{i||(e&&e.length>0?h(t.length):h(40))},value:s,placeholder:"Select an icon...",menuPlacement:"auto",isDisabled:i,styles:{control:(e,t)=>({...e,backgroundColor:"var(--bgPanel)",borderColor:"var(--gray6)",height:"44px",borderRadius:"9px",boxShadow:t.isFocused?"0 0 3px var(--color6)":"none"}),singleValue:e=>({...e,color:"var(--color)"}),valueContainer:e=>({...e,display:"flex",alignItems:"center",padding:"2px 8px"}),menu:e=>({...e,backgroundColor:"var(--gray2)",borderRadius:"9px",zIndex:99999,overflow:"hidden",padding:"8px"}),menuList:e=>({...e,display:"flex",flexWrap:"wrap",gap:"8px",backgroundColor:"var(--gray2)"}),option:(e,t)=>({...e,backgroundColor:t.isSelected?"var(--color6)":t.isFocused?"var(--color5)":"var(--gray2)",color:"var(--color)",cursor:"pointer",borderRadius:"6px",display:"flex",alignItems:"center",gap:"8px",width:"auto",minWidth:"80px",justifyContent:"center"}),indicatorSeparator:e=>({...e,backgroundColor:"var(--color7)"}),dropdownIndicator:e=>({...e,color:"var(--color7)"})},maxMenuHeight:300})})}},50666:function(e,t,r){r.d(t,{K:function(){return a}});var n=r(52322),o=r(2784),l=r(37288);let a=o.forwardRef((e,t)=>{let{children:r,...o}=e;return(0,n.jsx)(l.FA,{ref:t,tag:"span",className:"unselectable",alignSelf:"center",marginVertical:-10,pressStyle:{opacity:1,scale:.95},hoverStyle:{opacity:.8},...o,children:r})})},24551:function(e,t,r){r.d(t,{$:function(){return i}});var n=r(52322),o=r(2784),l=r(37288),a=r(70142);let i=o.forwardRef((e,t)=>(0,n.jsx)(l.FA,{ref:t,flex:1,...e,children:(0,n.jsx)(a.I,{children:e.children})}));t.Z=i},67662:function(e,t,r){r.d(t,{j:function(){return v},p:function(){return x}});var n=r(52322),o=r(2784),l=r(93075),a=r(37288),i=r(26602),s=r(79327),c=r(37614),d=r(96862),u=r(59328);let p=e=>{let{children:t}=e;return(0,n.jsx)(l.__,{ml:"$3",h:"$3.5",color:"$text",size:"$6",fontWeight:500,children:t})},h=e=>{let{label:t,description:r,children:o,noDivider:i=!1,onPress:s}=e;return(0,n.jsxs)(a.FA,{children:[(0,n.jsxs)(a.sL,{ai:"center",justifyContent:"space-between",gap:"$5",...s?{cursor:"pointer",hoverStyle:{opacity:.8},onPress:s}:{},children:[(0,n.jsxs)(a.FA,{gap:"0px",flex:1,children:[(0,n.jsx)(l.__,{color:"$text",fontSize:"$5",lineHeight:"fit-content",children:t}),r&&(0,n.jsx)(l.__,{fontSize:"$4",color:"$gray10",lineHeight:"fit-content",children:r})]}),o]}),!i&&(0,n.jsx)(a.FA,{width:"100%",height:2,backgroundColor:"$bgContent",opacity:.7,my:"$3"})]})};h.displayName="SettingRow";let g=e=>(0,n.jsx)(i.II,{minWidth:280,backgroundColor:"$bgContent",borderColor:"$gray6",borderWidth:1,placeholderTextColor:"$gray9",borderRadius:8,...e}),x=e=>{var t,r;let{label:o,description:i,noDivider:p=!1,disabled:x=!1,onPress:v}=e;if("control"in e&&void 0!==e.control)return(0,n.jsx)(h,{label:o,description:i,noDivider:p,onPress:v,children:e.control});let{type:f}=e;if("checkbox"===f)return(0,n.jsxs)(a.FA,{children:[(0,n.jsxs)(a.sL,{ai:"center",gap:"$2",children:[(0,n.jsx)(s.XZ,{w:"$2",h:"$2",focusStyle:{outlineWidth:0},checked:e.value,onCheckedChange:e.onChange,disabled:x,className:"no-drag",backgroundColor:"$bgContent",borderColor:"$gray6",children:(0,n.jsx)(s.XZ.Indicator,{children:(0,n.jsx)(c.Z,{size:16,color:"var(--color8)"})})}),(0,n.jsx)(l.__,{children:o})]}),!p&&(0,n.jsx)(a.FA,{width:"100%",height:2,backgroundColor:"$bgContent",opacity:.7,my:"$3"})]});let m=null;switch(f){case"toggle":m=(0,n.jsx)(d.Z,{checked:e.value,onChange:e.onChange,disabled:x});break;case"select":m=(0,n.jsx)(a.FA,{minWidth:280,children:(0,n.jsx)(u.E,{triggerProps:{backgroundColor:"$bgContent",borderWidth:1,borderColor:"$gray6"},title:o,value:e.value,elements:e.options.map(e=>({value:e.value,caption:e.label})),setValue:e.onChange,disabled:x})});break;case"text":m=(0,n.jsx)(g,{value:e.value,placeholder:null!==(t=e.placeholder)&&void 0!==t?t:o,onChangeText:e.onChange,disabled:x});break;case"secret":m=(0,n.jsx)(g,{value:e.value,placeholder:null!==(r=e.placeholder)&&void 0!==r?r:"••••••••",onChangeText:e.onChange,secureTextEntry:!0,disabled:x})}return(0,n.jsx)(h,{label:o,description:i,noDivider:p,onPress:v,children:m})};x.displayName="Setting";let v=e=>{let{title:t,children:r}=e,l=o.Children.toArray(r).filter(o.isValidElement),i=-1;l.forEach((e,t)=>{if((0,o.isValidElement)(e)){var r,n;let o=(null===(r=e.type)||void 0===r?void 0:r.displayName)||(null===(n=e.type)||void 0===n?void 0:n.name)||"";("Setting"===o||"SettingRow"===o)&&(i=t)}});let s=l.map((e,t)=>{if((0,o.isValidElement)(e)){var r,n;let l=(null===(r=e.type)||void 0===r?void 0:r.displayName)||(null===(n=e.type)||void 0===n?void 0:n.name)||"";if("Setting"===l||"SettingRow"===l)return(0,o.cloneElement)(e,{noDivider:t===i})}return e});return(0,n.jsxs)(a.FA,{children:[(0,n.jsx)(p,{children:t}),(0,n.jsx)(a.FA,{borderRadius:"$3",p:"$4",backgroundColor:"$bgPanel",children:s})]})}},8448:function(e,t,r){r.d(t,{M:function(){return u}});var n=r(52322),o=r(37288),l=r(22522),a=r(17518),i=r(47401),s=r(75136),c=r(2784),d=r(70142);let u=e=>{let{slides:t,lastButtonCaption:r,onFinish:u,id:p="pages",styles:h={},hideHeader:g=!1,disabled:x=!1,loading:v=!1}=e,[f,m]=(0,c.useState)(0),b=t.length,y=f>1?f-1:0,j=f<b-1?f+1:null,$=t.filter((e,t)=>t<=f).map(e=>e.name).join(" / "),w=b===f+1;return(0,n.jsxs)(o.FA,{id:"admin-dataview-create-dlg",p:"$3",pt:"$0",w:800,f:1,...h,children:[!g&&(0,n.jsxs)(o.sL,{id:"admin-eo",justifyContent:"space-between",width:"100%",children:[(0,n.jsx)(l.Kq,{flex:1,children:(0,n.jsx)(a.x,{fontWeight:"500",fontSize:16,color:"$gray9",children:$})}),(0,n.jsx)(l.Kq,{flex:1,alignItems:"flex-end",children:(0,n.jsxs)(a.x,{fontWeight:"500",fontSize:16,color:"$gray9",children:["[",f+1,"/",b,"]"]})})]}),(0,n.jsx)(d.I,{children:(0,n.jsx)(l.Kq,{children:t[f].title&&(0,n.jsx)(a.x,{fontWeight:"500",fontSize:30,color:"$color",children:t[f].title})})}),(0,n.jsx)(l.Kq,{f:1,mt:"$2",children:t[f].component}),(0,n.jsxs)(o.sL,{gap:40,jc:"center",mb:"$1",alignItems:"flex-end",children:[0!==f&&(0,n.jsx)(i.zx,{disabled:x||v,w:250,onPress:e=>{e.stopPropagation(),f>0&&m(y)},children:"Back"}),(0,n.jsx)(d.I,{children:(0,n.jsx)(i.zx,{disabled:x||v,id:"admin-"+p+"-add-btn",w:250,onPress:async e=>{e.stopPropagation(),j?m(j):u&&await u()},icon:w&&v?(0,n.jsx)(s.$,{size:"small",color:"$color"}):void 0,children:w?r:"Next"})})]})]})}},1627:function(e,t,r){r.d(t,{P:function(){return a}});var n=r(52322),o=r(2784),l=r(37288);let a=o.forwardRef((e,t)=>(0,n.jsx)(l.FA,{ref:t,o:.75,pos:"absolute",t:0,l:0,r:0,h:2e3,className:"hero-blur",...e}));t.Z=a},63771:function(e,t,r){r.d(t,{n:function(){return d}});var n=r(52322),o=r(37288),l=r(17518),a=r(70142),i=r(2784);let s=e=>Array.isArray(e)?e:Object.keys(e).map(t=>({id:t,...e[t]})),c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16;return e?i.isValidElement(e)?e:(0,i.createElement)(e,{size:t}):null},d=i.forwardRef((e,t)=>{let{tabs:r,selectedId:i,onSelect:d,iconSize:u=16,...p}=e,h=s(r);return(0,n.jsx)(o.sL,{borderBottomColor:"$gray6",borderBottomWidth:"1px",ref:t,...p,children:h.map((e,t)=>{var r;let s=i===e.id;return(0,n.jsx)(a.I,{children:(0,n.jsxs)(o.sL,{onPress:()=>!e.disabled&&d(e.id),cursor:e.disabled?"default":"pointer",paddingVertical:"$2.5",paddingHorizontal:"$4",disabled:e.disabled,style:{boxShadow:s?"0px 2px 0px var(--color8)":"none",transition:"box-shadow 0.2s ease"},justifyContent:"center",gap:"$2",alignItems:"center",opacity:s?1:e.disabled?.2:.6,hoverStyle:{opacity:e.disabled?null:.9},children:[c(e.icon,u),e.label&&(0,n.jsx)(l.x,{fontSize:"$4",children:e.label})]})},null!==(r=e.id)&&void 0!==r?r:t)})})})},96876:function(e,t,r){r.d(t,{M:function(){return N}});var n=r(52322),o=r(13296),l=r(47401),a=r(17518),i=r(90072),s=r(37288),c=r(51775),d=r(26602),u=r(93075),p=r(65457),h=r(68346),g=r(87343),x=r(2784),v=r(4921),f=r(94182),m=r(60166),b=r(39006),y=r(73147),j=r(81023),$=r(34178),w=r(28965),C=r(63771),S=r(77843),k=r(70142);let A=e=>{var t;let r=new Set(["base"]);return(null!==(t=null==e?void 0:e.cards)&&void 0!==t?t:[]).forEach(e=>{var t;return r.add(null!==(t=null==e?void 0:e.layer)&&void 0!==t?t:"base")}),Array.from(r).sort((e,t)=>"base"===e?-1:"base"===t?1:e.localeCompare(t,void 0,{sensitivity:"base"}))},P=e=>{var t;let r=new Map;return(null!==(t=null==e?void 0:e.cards)&&void 0!==t?t:[]).forEach(e=>{var t;(null==e?void 0:e.name)&&r.set(e.name,null!==(t=e.layer)&&void 0!==t?t:"base")}),r},I=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>"base",n=new Map,o=new Set(t);for(let[t,l]of Object.entries(null!=e?e:{})){let e=r(t,l)||"base";o.add(e),n.has(e)||n.set(e,{}),n.get(e)[t]=l}let l=t&&t.length?t:Array.from(o).sort((e,t)=>"base"===e?-1:"base"===t?1:e.localeCompare(t,void 0,{sensitivity:"base"})),a={};for(let[e,t]of(l.forEach(e=>{n.has(e)&&(a[e]=n.get(e))}),n.entries()))e in a||(a[e]=t);return{data:a,order:l}},z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];for(let[n,o]of(t.forEach(t=>{(null==e?void 0:e[t])&&r.push([t,e[t]])}),Object.entries(null!=e?e:{})))t.includes(n)||r.push([n,o]);return r},L=()=>{let[e,t]=(0,x.useState)(null);return{copiedKey:e,triggerCopy:(0,x.useCallback)((e,r)=>{r&&(navigator.clipboard.writeText(r),t(e),setTimeout(()=>t(null),700))},[])}},R=e=>{let{label:t,isCopied:r,onPress:o}=e;return(0,n.jsx)(k.I,{children:(0,n.jsx)(l.zx,{bc:r?"transparent":"$bgPanel",alignSelf:"flex-start",width:"auto",size:"$2",iconAfter:(0,n.jsx)(b.C,{color:r?"transparent":"$color8"}),hoverStyle:{backgroundColor:r?"transparent":"$color5"},onPress:o,children:r?(0,n.jsx)(a.x,{numberOfLines:1,overflow:"visible",fos:"$4",color:"$color",children:"copied to clipboard!"}):(0,n.jsx)(a.x,{fos:"$4",children:t})})})},F=e=>{let{items:t,renderBody:r}=e;return(0,n.jsx)(i.U,{type:"multiple",defaultValue:t.map(e=>{let[t]=e;return t}),width:"100%",gap:"$2",children:t.map(e=>{let[t,o]=e;return(0,n.jsxs)(i.U.Item,{value:t,boc:"$gray6",w:"100%",children:[(0,n.jsx)(i.U.Trigger,{bc:"$bgPanel",unstyled:!0,p:"$3",flexDirection:"row",ai:"center",br:"$4",w:"100%",children:e=>{let{open:r}=e;return(0,n.jsxs)(s.sL,{flex:1,flexDirection:"row",ai:"center",jc:"space-between",children:[(0,n.jsxs)(s.sL,{ai:"center",gap:"$2",children:[(0,n.jsx)(j.t,{col:"$gray9",size:"$1"}),(0,n.jsx)(a.x,{fos:"$4",fow:100,children:t})]}),(0,n.jsx)(c.b,{o:.8,animation:"quick",rotate:r?"180deg":"0deg",mr:"$1.5",children:(0,n.jsx)(m._,{size:"$1"})})]})}}),(0,n.jsx)(i.U.Content,{bc:"transparent",p:"$2",pt:"$1",w:"100%",children:r(o,t)})]},t)})})},T=e=>{let{value:t,onChange:r}=e;return(0,n.jsxs)(s.sL,{gap:"$2",children:[(0,n.jsx)(w.o,{pos:"absolute",left:"$3",top:14,size:16}),(0,n.jsx)(d.II,{bg:"$bgPanel",color:"$gray12",paddingLeft:"$7",bw:0,h:"47px",boc:"$gray6",w:"100%",placeholder:"search...",placeholderTextColor:"$gray9",outlineColor:"$gray8",value:t,onChangeText:r})]})},E=e=>{let{data:t,boardName:r}=e,[o,l]=(0,x.useState)(r);return(0,n.jsx)(s.FA,{gap:"$2",ai:"flex-start",f:1,width:"100%",children:Object.keys(null!=t?t:{}).length>0?(0,n.jsx)(_,{boards:t,selectedBoard:o,onSelectBoard:l,children:(0,n.jsx)(g.W,{collapsed:1,style:{backgroundColor:"transparent"},src:null==t?void 0:t[o],collapseStringsAfterLength:100,enableClipboard:e=>{let t=(0,S.uS)([o,...e.namespace],"boards");return navigator.clipboard.writeText(t),!1}})}):(0,n.jsx)(s.FA,{f:1,w:"100%",ai:"center",mt:"$10",children:(0,n.jsx)(a.x,{fos:"$4",col:"$gray8",children:"No states found"})})})},_=e=>{let{boards:t,children:r,selectedBoard:o,onSelectBoard:l}=e,d=(0,x.useMemo)(()=>Object.keys(null!=t?t:{}),[t]);return(0,n.jsxs)(s.FA,{gap:"$2",width:"100%",children:[" ",d.map(e=>(0,n.jsx)(s.sL,{f:1,children:(0,n.jsx)(i.U,{value:o,onValueChange:l,collapsible:!0,onPress:e=>e.stopPropagation(),type:"single",flex:1,children:(0,n.jsxs)(i.U.Item,{value:e,children:[(0,n.jsx)(i.U.Trigger,{bc:"$bgPanel",unstyled:!0,p:"$3",flexDirection:"row",ai:"center",br:"$4",w:"100%",children:t=>{let{open:r}=t;return(0,n.jsxs)(s.sL,{flex:1,flexDirection:"row",ai:"center",jc:"space-between",children:[(0,n.jsxs)(s.sL,{ai:"center",gap:"$2",children:[(0,n.jsx)(y.T,{col:"$gray9",size:"$1"}),(0,n.jsx)(a.x,{fos:"$4",ml:"$2",fow:100,children:e})]}),(0,n.jsx)(c.b,{o:.8,animation:"quick",rotate:r?"180deg":"0deg",mr:"$1.5",children:(0,n.jsx)(m._,{size:"$1"})})]})}}),(0,n.jsx)(i.U.Content,{bc:"transparent",p:"$2",children:r})]})})},e))]})},W=e=>{let{data:t,onCopy:r}=e,{copiedKey:o,triggerCopy:l}=L(),i=(0,x.useMemo)(()=>{let e=[],r=t=>{if(t&&"object"==typeof t)for(let[n,o]of Object.entries(t))if(o&&"object"==typeof o&&o.url){let t=o.name||n;e.push([t,o])}else r(o)};return r(t),e.sort((e,t)=>e[0].localeCompare(t[0],void 0,{sensitivity:"base"}))},[t]),c=(0,x.useCallback)((e,t)=>{l(t,r(e))},[r,l]);return i.length?(0,n.jsx)(s.FA,{width:"100%",gap:"$2",children:i.map(e=>{let[t,r]=e,l=o===t;return(0,n.jsx)(R,{label:t,isCopied:l,onPress:()=>c(r,t)},t)})}):(0,n.jsx)(a.x,{fos:"$4",col:"$gray8",children:"No actions found"})},O=e=>{let{data:t,layerOrder:r,onCopy:o}=e,{copiedKey:l,triggerCopy:a}=L(),i=(0,x.useMemo)(()=>z(t,r),[t,r]);return(0,n.jsx)(F,{items:i,renderBody:(e,t)=>(0,n.jsx)(s.FA,{gap:"$1.5",children:Object.entries(null!=e?e:{}).map(e=>{let[r,i]=e,s="".concat(t,":").concat(r);return(0,n.jsx)(R,{label:r,isCopied:l===s,onPress:()=>a(s,o(i))},r)})})})},D=e=>{var t;let{data:r,copyMode:o="rules",format:l="actions",boardName:a="",type:i="",layerOrder:c=[]}=e,[d,u]=(0,x.useState)(a),p=e=>{if(!e||!e.url)return"";let t=function(e){let t=e.match(/^\/api\/core\/v1\/boards\/([^\/]+)\/actions\/.+$/);return t?t[1]:null}(e.url),r=e.url;if(t&&t===a&&(r=e.name),"rules"===o)return(0,S.M)(r,void 0,i);if("code"===o||"flows"===o){var n;return(0,S.M)(r,null!==(n=e.params)&&void 0!==n?n:{},i)}return""};return(0,n.jsx)(s.FA,{width:"100%",children:"boards"===l?(0,n.jsx)(_,{boards:r,selectedBoard:d,onSelectBoard:u,children:(0,n.jsx)(W,{data:null!==(t=null==r?void 0:r[d])&&void 0!==t?t:{},onCopy:p})}):(0,n.jsx)(O,{data:r,layerOrder:c,onCopy:p})})},M=(e,t)=>{var r;if(!t)return e;let n=t.toLowerCase(),o=e=>{if(!e||"object"!=typeof e)return;if(e.url){var t;return[e.name,e.description,e.url,JSON.stringify(null!==(t=e.params)&&void 0!==t?t:{})].filter(Boolean).join(" ").toLowerCase().includes(n)?e:void 0}let r={};for(let[t,l]of Object.entries(e)){let e=t.toLowerCase().includes(n),a=o(l);if(e){r[t]=l;continue}void 0!==a&&("object"!=typeof a||Object.keys(a).length>0)&&(r[t]=a)}return Object.keys(r).length>0?r:void 0};return null!==(r=o(e))&&void 0!==r?r:{}},N=e=>{var t,r,i,c;let{board:d,type:m,panels:b=["actions","states"],actions:j,states:w,copyMode:L,showActionsTabs:R=!1,showStatesTabs:_=!1}=e,[W,O]=(0,x.useState)("formatted"),[N,V]=(0,x.useState)(""),[H,B]=(0,x.useState)(d.name),[G,U]=(0,x.useState)(""),[q,J]=(0,x.useState)(d.name),Z=(0,x.useMemo)(()=>A(d),[null==d?void 0:d.cards]),K=(0,x.useMemo)(()=>{let e=new Map;return Z.forEach((t,r)=>e.set(t,r)),e},[Z]),Y=(0,x.useMemo)(()=>P(d),[null==d?void 0:d.cards]),X=(0,x.useCallback)(e=>{if(!e||"object"!=typeof e)return e;let t=Z.length;return Object.fromEntries(Object.entries(e).sort((e,r)=>{var n,o;let[l]=e,[a]=r,i=Y.get(l),s=Y.get(a),c=i&&null!==(n=K.get(i))&&void 0!==n?n:t,d=s&&null!==(o=K.get(s))&&void 0!==o?o:t;return c!==d?c-d:l.localeCompare(a,void 0,{sensitivity:"base"})}))},[Y,Z,K]),Q=(0,x.useMemo)(()=>{let e={};if(!j||"object"!=typeof j)return e;for(let[t,r]of Object.entries(j)){if(!r||"object"!=typeof r)continue;let n={};for(let[e,t]of Object.entries(r)){if(!t||"object"!=typeof t)continue;let{name:r,description:o,params:l,url:a,layer:i}=t;n[e]={name:r,description:o,params:l,url:a,layer:i}}t===(null==d?void 0:d.name)?e[t]=I(X(n),Z,e=>{var t;return null!==(t=Y.get(e))&&void 0!==t?t:"base"}).data:e[t]=I(n,[],(e,t)=>(null==t?void 0:t.layer)||"base").data}return e},[j,null==d?void 0:d.name,X,Z,Y]),ee=(0,x.useMemo)(()=>{if(!w||"object"!=typeof w)return{};let e={...w};return(null==d?void 0:d.name)&&(null==w?void 0:w[d.name])&&"object"==typeof w[d.name]&&(e[d.name]=I(X(w[d.name]),Z,e=>{var t;return null!==(t=Y.get(e))&&void 0!==t?t:"base"}).data),e},[w,null==d?void 0:d.name,X,Z,Y]),et=(0,x.useMemo)(()=>{let e="otherBoards"===q?Object.entries(null!=Q?Q:{}).filter(e=>{let[t]=e;return t!==(null==d?void 0:d.name)}).sort((e,t)=>{let[r]=e,[n]=t;return r.localeCompare(n)}).reduce((e,t)=>{let[r,n]=t;return{...e,[r]:n}},{}):null==Q?void 0:Q[q];return M(null!=e?e:{},N)},[Q,N,q,null==d?void 0:d.name]),er=(0,x.useMemo)(()=>{let e="otherBoards"===H?Object.entries(null!=ee?ee:{}).filter(e=>{let[t]=e;return t!==(null==d?void 0:d.name)}).reduce((e,t)=>{let[r,n]=t;return{...e,[r]:n}},{}):null==ee?void 0:ee[H];return function e(t,r){if(null==t)return;let n=r.toLowerCase();if("object"!=typeof t)return String(t).toLowerCase().includes(n)?t:void 0;if(Array.isArray(t)){let n=[];for(let o of t){let t=e(o,r);void 0!==t&&n.push(t)}return n.length>0?n:void 0}let o={};for(let[l,a]of Object.entries(t)){let t=l.toLowerCase().includes(n),i=e(a,r);(t||void 0!==i)&&(o[l]=void 0===i?a:i)}return Object.keys(o).length>0?o:void 0}(null!=e?e:{},G)},[ee,G,H,null==d?void 0:d.name]),en=(0,x.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.length&&Z.includes(e[0])?e.slice(1):e:[]},[Z]),eo=(0,x.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"actions";return(0,n.jsxs)(s.FA,{gap:"$2",ai:"flex-start",f:1,children:["formatted"===W&&(0,n.jsx)(D,{type:m,data:et,format:e,copyMode:L,boardName:null==d?void 0:d.name,layerOrder:Z}),"json"===W&&(0,n.jsx)(g.W,{collapsed:3,style:{backgroundColor:"transparent"},src:et})]})},[null==d?void 0:d.name,L,et,W,Z,m]),el=(0,x.useMemo)(()=>{let e=z(er,Z);return er&&0!==e.length?(0,n.jsx)(F,{items:e,renderBody:e=>(0,n.jsx)(g.W,{collapsed:1,style:{backgroundColor:"transparent"},src:null!=e?e:{},collapseStringsAfterLength:100,enableClipboard:e=>{let t=en(e.namespace),r=(0,S.uS)(t,"state");return navigator.clipboard.writeText(r),!1}})}):(0,n.jsx)(s.FA,{f:1,w:"100%",ai:"center",mt:"$10",children:(0,n.jsx)(a.x,{fos:"$4",col:"$gray8",children:"No states found"})})},[er,Z,en]),ea=(0,x.useMemo)(()=>eo("actions"),[eo]),ei=(0,x.useMemo)(()=>eo("boards"),[eo]),es=(0,x.useMemo)(()=>(0,n.jsx)(E,{data:null!=er?er:{},boardName:null==d?void 0:d.name}),[er]),ec=[{id:d.name,label:d.name,icon:(0,n.jsx)($.y,{size:"$1"}),content:ea},{id:"otherBoards",label:"Other boards",icon:(0,n.jsx)(y.T,{size:"$1"}),content:ei}],ed=[{id:d.name,label:d.name,content:el,icon:(0,n.jsx)($.y,{size:"$1"})},{id:"otherBoards",label:"Other boards",content:es,icon:(0,n.jsx)(y.T,{size:"$1"})}],eu=(0,x.useMemo)(()=>ec.find(e=>e.id===q),[ec,q]),ep=(0,x.useMemo)(()=>ed.find(e=>e.id===H),[ed,H]);return(0,n.jsx)(o.s_,{defaultSize:30,children:(0,n.jsxs)(o.eh,{direction:"vertical",children:[b&&(null==b?void 0:b.includes("actions"))&&(0,n.jsx)(o.s_,{defaultSize:50,minSize:20,maxSize:80,children:(0,n.jsxs)(s.FA,{flex:1,height:"100%",px:"$3",gap:"$2",overflow:"hidden",children:[(0,n.jsx)(k.I,{children:(0,n.jsxs)(s.sL,{jc:"space-between",width:"100%",children:[(0,n.jsx)(u.__,{pl:"$3",lineHeight:"$4",fontSize:"$5",color:"$gray9",children:"Actions"}),(0,n.jsxs)(s.sL,{gap:"$2",children:[(0,n.jsx)(l.zx,{icon:v.N,bc:"formatted"===W?"$bgPanel":"$bgContent",color:"formatted"===W?"$color8":"$color",scaleIcon:1.6,size:"$2",onPress:()=>O("formatted")}),(0,n.jsx)(l.zx,{icon:f.z,color:"json"===W?"$color8":"$color",bc:"json"===W?"$bgPanel":"$bgContent",scaleIcon:1.6,size:"$2",onPress:()=>O("json")})]})]})}),(0,n.jsx)(T,{value:N,onChange:V}),R?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(C.n,{tabs:ec,selectedId:q,onSelect:J}),(0,n.jsx)(p.p,{flex:1,width:"100%",height:"100%",children:(0,n.jsx)(s.sL,{mt:"$1",children:null!==(t=null==eu?void 0:eu.content)&&void 0!==t?t:null})})]}):(0,n.jsx)(p.p,{flex:1,width:"100%",height:"100%",children:(0,n.jsx)(s.sL,{mt:"$1",children:null!==(r=null==eu?void 0:eu.content)&&void 0!==r?r:null})})]})}),(0,n.jsx)(h.Z,{direction:"horizontal",borderLess:!1,borderColor:"var(--gray4)"}),(0,n.jsx)(o.s_,{defaultSize:50,minSize:20,maxSize:80,children:(0,n.jsxs)(s.FA,{flex:1,height:"100%",borderRadius:"$3",p:"$3",gap:"$2",overflow:"hidden",children:[(0,n.jsx)(u.__,{pl:"$3",lineHeight:"$4",fontSize:"$5",color:"$gray9",children:"States"}),(0,n.jsx)(T,{value:G,onChange:U}),_?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(C.n,{tabs:ed,selectedId:H,onSelect:B}),(0,n.jsx)(p.p,{flex:1,width:"100%",height:"100%",overflow:"auto",children:(0,n.jsx)(s.sL,{mt:"$1",children:null!==(i=null==ep?void 0:ep.content)&&void 0!==i?i:null})})]}):(0,n.jsx)(p.p,{flex:1,width:"100%",height:"100%",overflow:"auto",children:(0,n.jsx)(s.sL,{mt:"$1",children:null!==(c=null==ep?void 0:ep.content)&&void 0!==c?c:null})})]})})]})})}},6773:function(e,t,r){r.d(t,{n:function(){return v}});var n=r(52322),o=r(89250),l=r(37288),a=r(47401),i=r(54243),s=r(2784),c=r(25184),d=r(36293),u=r(16399),p=r(70142),h=r(35761),g=r(73750),x=r(57441);let v=e=>{let{htmlCode:t,setHTMLCode:r}=e,[v,f]=(0,s.useState)(!1),[m,b]=(0,s.useState)(!1),[y,j]=(0,s.useState)(""),{resolvedTheme:$}=(0,u.P)(),w=async e=>{var r;f(!0);let n=await c.API.post("/api/core/v1/autopilot/getComponent?debug=true",{sourceComponent:t,request:y});(null==n?void 0:null===(r=n.data)||void 0===r?void 0:r.jsCode)&&(f(!1),b(n.data.jsCode),j(""))},C=async()=>{r(m),b(!1)};return(0,n.jsxs)(l.FA,{width:"100%",height:"100%",flex:1,borderRadius:"$3",children:[(0,n.jsxs)(l.FA,{height:"100%",flex:1,jc:v?"center":"flex-start",ai:v?"center":"stretch",children:[v&&(0,n.jsx)(h.Z,{color:"#ececec"}),!v&&m&&(0,n.jsx)(l.FA,{flex:1,minHeight:"100%",width:"100%",backgroundColor:"$gray3",borderRadius:"$3",p:"$3",children:(0,n.jsx)(d.Monaco,{sourceCode:m||"// type into the input to generate a new version",path:"aiComponent.ts",darkMode:"dark"===$,onChange:e=>b(e),height:"100%",options:{folding:!1,lineDecorationsWidth:0,lineNumbersMinChars:0,lineNumbers:!1,minimap:{enabled:!1}}})})]}),m&&(0,n.jsxs)(l.sL,{gap:"$4",jc:"center",p:"$2",children:[(0,n.jsx)(p.I,{children:(0,n.jsx)(a.zx,{onPress:()=>b(!1),w:"120px",icon:x.X,backgroundColor:"$gray3",hoverStyle:{backgroundColor:"$gray4"},pressStyle:{backgroundColor:"$gray5"},children:"Cancel"})}),(0,n.jsx)(a.zx,{onPress:C,icon:o.S,w:"120px",children:"Accept"})]}),!m&&(0,n.jsxs)(l.FA,{gap:"$1",p:"$1",position:"relative",children:[(0,n.jsx)(i.K,{w:"100%",placeholder:"Describe the changes you want in your component...",value:y,onChangeText:j,bc:"$bgPanel",borderColor:"$gray3",br:"$4",placeholderTextColor:"$gray9",pr:"$10",rows:4,outlineColor:"transparent",onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),w())}}),(0,n.jsx)(a.zx,{themeInverse:!!y,disabled:!y,onPress:()=>w(),iconAfter:g.a,circular:!0,size:"$3",bc:"$gray1",boc:"$gray6",hoverStyle:{backgroundColor:"$gray1"},pressStyle:{backgroundColor:"$gray1"},als:"center",scaleIcon:1.2,pos:"absolute",b:"$2.5",r:"$2.5"})]})]})}},11793:function(e,t,r){r.d(t,{W:function(){return g}});var n=r(52322),o=r(2784),l=r(37288),a=r(75136),i=r(17518),s=r(47401),c=r(26602),d=r(68604),u=r(40966),p=r(76425),h=r(70142);let g=e=>{let{updateKey:t,loading:r,mode:g="needs-key",providerName:x="OpenAI"}=e,v=(0,o.useRef)(""),f=(0,p.tl)();return r?(0,n.jsx)(l.FA,{f:1,jc:"center",ai:"center",p:"$4",children:(0,n.jsx)(a.$,{size:"large"})}):"not-configured"===g?(0,n.jsxs)(l.FA,{f:1,jc:"center",ai:"center",p:"$4",gap:"$3",children:[(0,n.jsx)(i.x,{fontSize:"$4",fontWeight:"500",textAlign:"center",color:"$color11",children:"AI is not configured yet."}),(0,n.jsx)(i.x,{fontSize:"$3",textAlign:"center",color:"$color10",children:"Set up an AI provider to enable AI-powered rules."}),(0,n.jsx)(h.I,{children:(0,n.jsx)(s.zx,{size:"$4",icon:u.Z,onPress:f,backgroundColor:"$color8",color:"white",hoverStyle:{backgroundColor:"$color9"},children:"Configure AI"})})]}):(0,n.jsxs)(l.FA,{f:1,jc:"center",ai:"center",p:"$4",children:[(0,n.jsxs)(i.x,{fontSize:"$4",fontWeight:"500",textAlign:"center",mb:"$2",children:["AI Rules require a ",x," API Key."]}),(0,n.jsxs)(l.sL,{p:"$2",w:"100%",gap:"$2",ai:"center",children:[(0,n.jsx)(c.II,{f:1,placeholder:"Enter your ".concat(x," API Key"),placeholderTextColor:"$gray9",boc:"$gray4",bc:"$gray1",disabled:r,onChangeText:e=>v.current=e}),(0,n.jsx)(s.zx,{circular:!0,icon:d.v,onPress:()=>t(v.current),disabled:r})]})]})}},71276:function(e,t,r){r.d(t,{R:function(){return n}});let n={value:'//@card/react\n\nfunction Widget(card) {\n  const value = card.value;\n  return (\n      <Tinted>\n        <ProtoThemeProvider forcedTheme={window.TamaguiTheme}>\n            <YStack f={1} height="100%" ai="center" jc="center" width="100%">\n                {card.icon && card.displayIcon !== false && (\n                    <Icon name={card.icon} size={48} color={card.color}/>\n                )}\n                {card.displayResponse !== false && (\n                    <CardValue mode={card.markdownDisplay ? \'markdown\' : card.htmlDisplay ? \'html\' : \'normal\'} value={value ?? "N/A"} />\n                )}\n            </YStack>\n        </ProtoThemeProvider>\n      </Tinted>\n  );\n}\n',action:'//@card/react\n\nfunction Widget(card) {\n  const value = card.value;\n\n  const content = <YStack f={1} ai="center" jc="center" width="100%">\n      {card.icon && card.displayIcon !== false && (\n          <Icon name={card.icon} size={48} color={card.color}/>\n      )}\n      {card.displayResponse !== false && (\n          <CardValue mode={card.markdownDisplay ? \'markdown\' : card.htmlDisplay ? \'html\' : \'normal\'} value={value ?? "N/A"} />\n      )}\n  </YStack>\n\n  return (\n      <Tinted>\n        <ProtoThemeProvider forcedTheme={window.TamaguiTheme}>\n          <ActionCard data={card}>\n            {card.displayButton !== false ? <ParamsForm data={card}>{content}</ParamsForm> : card.displayResponse !== false && content}\n          </ActionCard>\n        </ProtoThemeProvider>\n      </Tinted>\n  );\n}\n'}}}]);