"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8917],{38917:function(e,t,n){n.r(t),n.d(t,{DeleteButton:function(){return eh},EditableObject:function(){return em},FormElement:function(){return eu},FormGroup:function(){return ef},GridElement:function(){return ep},OpenedSectionsContext:function(){return ea},getDefaultValue:function(){return ec},iconStyle:function(){return eo}});var r=n(52322),l=n(72186),i=n(93075),a=n(22522),o=n(78994),d=n(86407),s=n(37288),c=n(90072),u=n(51775),f=n(14444),p=n(47401),h=n(75136),m=n(89560),x=n(32627),j=n(60166),v=n(57441),y=n(43850),g=n(72374),b=n(53601),$=n(33943),w=n(25184),S=n(70142),_=n(88480),C=n(93228),O=n(2784),F=n(74433),A=n(91709),L=n(67045),P=n(3443),I=n(26602),k=n(59213),T=n(2037),D=n(54243),z=n(59328),E=n(56388);function N(e){let{showLabel:t=!0,containerProps:n,defaultValue:l,children:i,...o}=e;return(0,r.jsxs)(s.sL,{f:1,...n,children:[(0,r.jsx)(s.sL,{f:1,children:(0,r.jsxs)(E.iR,{f:1,defaultValue:[50],min:0,max:100,step:1,...o,children:[(0,r.jsx)(E.iR.Track,{f:1,children:(0,r.jsx)(E.iR.TrackActive,{})}),(0,r.jsx)(E.iR.Thumb,{index:0,size:"$1",circular:!0,elevate:!0}),i]})}),t&&(0,r.jsx)(a.Kq,{ai:"flex-end",minWidth:40,top:-8,children:o.value})]})}var Z=n(79745),R=n(41771),W=n(16505),q=n(92247);let K=e=>{let t;let{maxResults:n,options:l,getDisplayField:i,onSelectItem:a,selectedItem:o,...d}=e,[c,u]=(0,O.useState)(""),[f,p]=(0,O.useState)(!1),[h,m]=(0,O.useState)(Array.isArray(l)?l:[]),x=(0,O.useRef)(null),[j,v]=(0,O.useState)(0),[y,g]=(0,O.useState)(o),b=(0,O.useRef)(!1),$=async()=>{Array.isArray(l)?m(l.filter(e=>e.includes(c))):"function"==typeof l&&m(await l(c))};return(0,O.useEffect)(()=>{$()},[c]),(0,O.useEffect)(()=>{v(x.current.offsetWidth)},[]),t=f?c:i&&void 0!==y?i(y):y,(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(I.II,{ref:x,onBlur:e=>{b.current||p(!1)},onFocus:()=>{b.current=!1,p(!0)},onChangeText:u,value:t,...d}),(0,r.jsx)(s.FA,{children:f&&(0,r.jsxs)(W.gF,{pb:0,bc:"$bgContent",zIndex:99999999,overflow:"auto",maxHeight:300,width:j,position:"absolute",alignSelf:"center",bordered:!0,size:"$4",children:[0===h.length&&(0,r.jsx)(q.HC,{children:"No results"}),h.map((e,t)=>(0,r.jsx)(W.gF.Item,{children:(0,r.jsx)(q.HC,{onPointerDown:()=>b.current=!0,pressTheme:!0,hoverTheme:!0,onPress:()=>{a&&a(e),g(e),p(!1)},children:i?i(e):e})},t))]})})]})};var V=n(99062);let U=e=>{let{ele:t,elementDef:n,icon:l,path:i,data:o,setData:d,mode:s,customFields:c,inArray:u,arrayName:f,getFormData:p,URLTransform:h}=e;return(0,r.jsx)(ef,{simple:!0,ele:t,title:u?t._def.keyName?p(t._def.keyName,[...i,t.name]):f+" #"+(t.name+1):t.name,icon:V.a,path:i,children:(0,r.jsx)(a.Kq,{children:Object.keys(n.shape()).map((e,u)=>{let f=n.shape();return(0,r.jsx)(a.Kq,{mt:u?"$5":"$0",children:ei({ele:{...f[e],name:e},icon:l,i:0,x:0,data:o,setData:d,mode:s,customFields:c,path:[...i,t.name],URLTransform:h})},u)})})})};var M=n(7324),H=n(57909);let B=e=>{var t;let{ele:n,elementDef:l,icon:i,path:o,arrData:d,getElement:c,setFormData:u,data:f,setData:h,mode:x,customFields:j,URLTransform:v}=e;return(0,r.jsxs)(ef,{ele:n,title:" ("+d.length+")",icon:H.S,path:o,children:[(0,r.jsx)(a.Kq,{children:d.map((e,t)=>(0,r.jsxs)(s.sL,{mt:t?"$2":"$0",ml:"$1",children:["ZodObject"!=l.type._def.typeName&&(0,r.jsx)(S.I,{children:(0,r.jsx)(s.sL,{mr:"$2",top:20,children:"edit"==x||"add"==x?(0,r.jsx)(m.z,{...eo}):(0,r.jsx)(M.$,{...eo})})}),c({ele:{...l.type._def,_def:l.type._def,name:t},icon:i,i:0,x:0,data:f,setData:h,mode:x,customFields:j,path:[...o,n.name],inArray:!0,arrayName:n.name,URLTransform:v}),(0,r.jsx)(eh,{mode:x,onPress:()=>{d.splice(t,1),u(n.name,[...d])}})]},t))}),("edit"==x||"add"==x)&&(0,r.jsxs)(p.zx,{mt:"$4",onPress:()=>{let e="ZodLazy"==n._def.typeName?n._def.getter()._def:n._def;"ZodOptional"==e.typeName?e.innerType._def.type._def.typeName:e.type._def.typeName,u(n.name,[...d,ec(l.type._def.typeName)])},children:["Add",null!==(t=n._def.label)&&void 0!==t?t:n.name]})]})};var G=n(3471);let J=e=>{let{ele:t,icon:n,i:l,inArray:i,eleArray:a,formData:o,generatedOptions:d,setFormData:s}=e,c=["ZodNumber","ZodString","ZodLiteral"],u=a.map(e=>{var t;let n=null!==(t=e.typeName)&&void 0!==t?t:e._def.typeName;return c.includes(n)?String(e.value):JSON.stringify(e.value)});return(0,r.jsx)(eu,{ele:t,icon:n,i:l,inArray:i,children:(0,r.jsx)(G.C,{choices:d.length?d:u,defaultSelections:o,onSetSelections:e=>s(t.name,e)})})},X=e=>{let{ele:t,inArray:n,recordData:l,elementDef:i,icon:o,data:d,setData:c,mode:u,customFields:f,path:h,setFormData:m,URLTransform:x}=e,[j,v]=(0,O.useState)(!1),[y,g]=(0,O.useState)(""),b=(0,O.useRef)(null),[$,w]=(0,O.useContext)(ea);(0,O.useEffect)(()=>{if(j){let e=setTimeout(()=>{var e;null===(e=b.current)||void 0===e||e.focus()},100);return()=>clearTimeout(e)}},[j]);let S=async()=>{let e=ec(t._def.valueType._def.typeName),n=[...h,t.name,y].join("/");v(!1),g(""),w(function(e,t){let n=t.substring(0,t.lastIndexOf("/")+1),r=e.filter(e=>!e.startsWith(n)||e===n);return r.push(t),r}($,n)),m(t.name,{...l,[y]:e})},_=async e=>{delete l[e],m(t.name,{...l})};return(0,r.jsxs)(ef,{ele:t,title:n?" #"+(t.name+1):"...",icon:V.a,path:h,children:[(0,r.jsx)(a.Kq,{children:l?Object.keys(l).map((e,n)=>(0,r.jsxs)(s.sL,{mt:n?"$2":"$0",ml:"$1",children:[ei({ele:{...i.valueType,name:e},icon:o,i:0,x:0,data:d,setData:c,mode:u,customFields:f,path:[...h,t.name],URLTransform:x}),(0,r.jsx)(eh,{onPress:()=>_(e),mode:u},e)]},n)):null}),(0,r.jsx)(C.a,{acceptCaption:"Add field",setOpen:v,open:j,onAccept:S,title:"Add new field",description:"",children:(0,r.jsx)(s.FA,{f:1,id:"eo-add-field-input",alignItems:"center",mt:"$6",justifyContent:"center",children:(0,r.jsx)(I.II,{f:1,value:y,onChangeText:e=>g(e),textAlign:"center",id:"name",placeholder:"Field name...",ref:b,onKeyPress:e=>{"Enter"===e.key&&S()}})})}),("edit"==u||"add"==u)&&(0,r.jsx)(p.zx,{id:"eo-obj-comp-btn",mt:"$5",onPress:()=>{v(!0)},children:" Add field"})]})};var Q=n(11596),Y=n(30383),ee=n(70952),et=n(27704),en=n(79428),er=n(19025);let el=e=>{var t,n,l,i;let{ele:a,elementDef:o,icon:d,path:s,data:c,setData:u,setFormData:f,mode:p,customFields:h,inArray:m,arrayName:x,getFormData:j,URLTransform:v}=e,[y,g]=(0,O.useState)({}),b=null==o?void 0:null===(t=o.relation)||void 0===t?void 0:t.model,$=null==o?void 0:null===(n=o.relation)||void 0===n?void 0:n.displayField,S=(0,ee.t)();return b?((0,O.useEffect)(()=>{(async()=>{var e,t,n,r;let l=null!==(n=null===(e=(await w.API.get("/api/core/v1/objects/"+b+"Model")).data)||void 0===e?void 0:e.keys)&&void 0!==n?n:{},i=null!==(r=Object.keys(l).find(e=>{var t,n;return!!(null===(n=l[e])||void 0===n?void 0:null===(t=n.modifiers)||void 0===t?void 0:t.find(e=>(null==e?void 0:e.name)==="id"))}))&&void 0!==r?r:"id",a=null===(t=(await w.API.get("/api/v1/"+b)).data)||void 0===t?void 0:t.items,o={};a.forEach(e=>{let t=i;$&&e[$]&&(t=e[$]),o[t]=e[i]}),g(o)})()},[b,$]),(0,r.jsx)(eu,{ele:a,icon:d,inArray:m,children:(0,r.jsx)(z.E,{title:b,placeholder:"Select related object",elements:[...Object.keys(y),{value:"__manage__",caption:"Manage ".concat(b)}],value:null!==(i=null==c?void 0:null===(l=c[null==a?void 0:a.name])||void 0===l?void 0:l.relationId)&&void 0!==i?i:"default",setValue:e=>{if("__manage__"===e){S.push("/objects/view?object=".concat(b,"Model"));return}f(a.name,{relationId:y[e],model:b,displayField:null!=$?$:"id"})},f:1})})):(0,r.jsx)("p",{children:"Model not found in relation"})},ei=e=>{let{ele:t,icon:n,i:l,x:i,data:o,setData:d,mode:s,customFields:c={},path:u=[],inArray:f=!1,arrayName:p="",URLTransform:h=e=>e}=e,m={...t._def,...null===($=t._def)||void 0===$?void 0:null===(b=$.innerType)||void 0===b?void 0:b._def},x=m.static||m.id,j=(e,t)=>{let n=o;u.forEach(e=>{Array.isArray(n)||n.hasOwnProperty(e)||(n[e]={}),n=n[e]}),n[e]=t,d({data:o})},v=(e,t)=>{let n=null!=o?o:{};for(let e of null!=t?t:u)("object"==typeof n&&n.hasOwnProperty(e)||Array.isArray(n)&&n.length>e)&&(n=n[e]);if("string"==typeof n)return n;if(!(n&&n.hasOwnProperty(e))){var r=null==m?void 0:m.defaultValue;"function"==typeof r&&(r=r()),void 0!=r&&j(e,r)}return n&&n.hasOwnProperty(e)?n[e]:""},y=m.typeName;if("ZodLazy"==y){let e=m.getter();m=e._def,y=e.constructor.name,e.name=t.name,t=e}if(c.hasOwnProperty(t.name)||c.hasOwnProperty("*")){let e=c.hasOwnProperty(t.name)?c[t.name]:c["*"],i="function"==typeof e.component?e.component(u,v(t.name),e=>j(t.name,e),s,o):e.component;if(i)return e.hideLabel?i:(0,r.jsx)(eu,{ele:t,icon:n,i:l,inArray:f,children:i})}if("ZodUnion"==y&&"preview"!=s){let e=m.displayOptions?m.displayOptions:m.options.map(e=>e._def.value);t._def.dependsOn&&o&&o[t._def.dependsOn]&&"function"==typeof t._def.generateOptions&&(e=t._def.generateOptions(o));let i=t._def.dependsOn,a=t._def.dependsOnValue;return(0,r.jsx)(eu,{ele:t,icon:n,i:l,inArray:f,children:i?o[i]?a?a==o[i]?(0,r.jsx)(z.E,{f:1,data:o,title:t.name,elements:e,value:v(t.name),setValue:e=>j(t.name,e)}):(0,r.jsx)(I.II,{focusStyle:{outlineWidth:1},disabled:!0,placeholder:t._def.hint?t._def.hint:"Fill "+i+" property first",bc:"$backgroundTransparent"}):(0,r.jsx)(z.E,{f:1,data:o,title:t.name,elements:e,value:v(t.name),setValue:e=>j(t.name,e)}):(0,r.jsx)(I.II,{focusStyle:{outlineWidth:1},disabled:!0,f:1,placeholder:t._def.hint?t._def.hint:"Fill "+i+" property first",bc:"$backgroundTransparent"}):(0,r.jsx)(z.E,{triggerProps:{disabled:"add"!=s&&"edit"!=s},f:1,data:o,title:t.name,elements:e,value:v(t.name),setValue:e=>j(t.name,e)})})}if("ZodNumber"==y&&"preview"!=s){if(m.checks){let e=m.checks.find(e=>"min"==e.kind),i=m.checks.find(e=>"max"==e.kind);if(e&&i)return(0,r.jsx)(eu,{ele:t,icon:n,i:l,inArray:f,children:(0,r.jsx)(S.I,{children:(0,r.jsx)(a.Kq,{f:1,mt:"$4",children:(0,r.jsx)(N,{onValueChange:e=>j(t.name,e),value:[null!==(w=v(t.name))&&void 0!==w?w:e.value],width:190,min:e.value,max:i.value})})})})}}else if("ZodObject"==y)return m.relation?(0,r.jsx)(el,{ele:t,elementDef:m,icon:n,path:u,data:o,setData:d,setFormData:j,mode:s,customFields:c,inArray:f,arrayName:p,getFormData:v,URLTransform:h}):m.linkTo?(0,r.jsxs)(eu,{ele:t,icon:n,i:l,inArray:f,children:["preview"!=s&&(0,r.jsx)(a.Kq,{f:1,t:"$-2",children:(0,r.jsx)(K,{bc:"$backgroundTransparent",disabled:"view"==s||"preview"==s||"edit"==s&&x,getDisplayField:m.getDisplayField,options:e=>m.linkTo(e,h),onSelectItem:e=>j(t.name,e),selectedItem:v(t.name),f:1,placeholder:m.hint})}),"preview"==s&&(0,r.jsx)(k.J,{ml:"$3.5",mt:"$2.5",mb:"$2",children:m.getDisplayField&&m.getDisplayField(v(t.name))})]}):(0,r.jsx)(U,{ele:t,elementDef:m,icon:n,path:u,data:o,setData:d,mode:s,customFields:c,inArray:f,arrayName:p,getFormData:v,URLTransform:h});else if("ZodArray"==y){let e=v(t.name)?v(t.name):[],i=[];return("function"==typeof t._def.generateOptions&&(i=t._def.generateOptions(o)),t._def.innerType||"ZodUnion"!==t._def.type._def.typeName)?(0,r.jsx)(B,{URLTransform:h,data:o,setData:d,mode:s,ele:t,elementDef:m,icon:n,customFields:c,path:u,arrData:e||i,getElement:ei,setFormData:j}):(0,r.jsx)(J,{ele:t,icon:n,i:l,inArray:f,eleArray:t._def.type._def.options,formData:e,generatedOptions:i,setFormData:j})}else if("ZodRecord"==y){let e=v(t.name);return(0,r.jsx)(X,{URLTransform:h,ele:t,inArray:f,recordData:e,elementDef:m,icon:n,data:o,setData:d,mode:s,customFields:c,path:u,setFormData:j})}else if("ZodBoolean"==y){let e=v(t.name),i=""===e||void 0===e;return(0,r.jsx)(eu,{ele:t,icon:n,i:l,inArray:f,children:(0,r.jsx)(S.I,{children:(0,r.jsx)(a.Kq,{f:1,flexDirection:"row",gap:"$2",alignItems:"center",children:(0,r.jsx)(T.rs,{cursor:"pointer",disabled:"add"!=s&&"edit"!=s,checked:e,onCheckedChange:e=>j(t.name,e),size:"$2",children:(0,r.jsx)(T.rs.Thumb,{style:{width:i?"100%":"50%"},animation:"quick",children:i?(0,r.jsx)(a.Kq,{enterStyle:{opacity:0},alignSelf:"center",children:(0,r.jsx)(Y.Z,{size:18,fillOpacity:1,fill:"var(--color)"})}):null})})})})})}let g="";if("function"!=typeof t._def.generateOptions||(g=t._def.generateOptions(),v(t.name)||j(t.name,g)),"ZodDate"==y&&(null==m?void 0:m.hasOwnProperty("datePicker"))){var b,$,w,_,C,O,F,A=m.datePicker,L=["year","month"].includes(A);return(0,r.jsx)(eu,{ele:t,icon:n,i:l,inArray:f,children:(0,r.jsx)(a.Kq,{f:1,children:L?(0,r.jsx)(Z.M,{mode:A,offsetDate:v(t.name)?new Date(v(t.name)):null,onOffsetChange:L?e=>j(t.name,e.toISOString()):null}):(0,r.jsx)(Z.M,{mode:A,selectedDates:v(t.name)?[new Date(v(t.name))]:null,onDatesChange:L?null:e=>{var n;return j(t.name,null===(n=e[0])||void 0===n?void 0:n.toISOString())}})})})}if("ZodString"==y&&m.color)return(0,r.jsx)(eu,{ele:t,icon:n,i:l,inArray:f,children:(0,r.jsx)(a.Kq,{f:1,children:(0,r.jsx)(R.S,{color:v(t.name),onChange:e=>j(t.name,e.hex)})})});if("ZodString"==y&&m.file){let e=(0,ee.t)(),i=(0,et.l)(),o=(0,en.j)(),d=v(t.name),c=null==d?void 0:d.startsWith("http"),u=Object.fromEntries(i.entries()),p=m.extensions;return(0,r.jsx)(eu,{ele:t,icon:n,i:l,inArray:f,children:(0,r.jsx)(a.Kq,{f:1,children:(0,r.jsx)(Q.G,{disabled:"add"!=s&&"edit"!=s,fileFilter:e=>{let t=p.some(t=>e.name.endsWith(t)||"*"==t);return e.isDir||t},file:v(t.name),initialPath:m.initialPath,onFileChange:e=>j(t.name,e),onPressOpen:()=>{if(!c){let t=d?d.split("/").slice(0,-1).join("/"):m.initialPath,n=new URLSearchParams({...u,path:t}).toString();e.replace(o+"?"+n)}}})})})}return"ZodString"==y&&m.textArea?(0,r.jsx)(eu,{ele:t,icon:n,i:l,inArray:f,children:(0,r.jsx)(a.Kq,{f:1,children:(0,r.jsx)(D.K,{id:"editable-object-input-"+(null==t?void 0:t.name),height:m.textAreaHeight,..."edit"!=s&&"add"!=s?{bw:0,forceStyle:"hover"}:{},focusStyle:{outlineWidth:1},disabled:"view"==s||"preview"==s||"edit"==s&&x||t._def.dependsOn&&!o[t._def.dependsOn],secureTextEntry:t._def.secret,value:g&&!v(t.name)?g:v(t.name),onChangeText:e=>j(t.name,e),placeholder:o?null!==(C=null!==(_=t._def.hint)&&void 0!==_?_:t._def.label)&&void 0!==C?C:t.name:"",autoFocus:0==i&&0==l,bc:"$backgroundTransparent"})})}):(0,r.jsx)(eu,{ele:t,icon:n,i:l,inArray:f,children:(0,r.jsx)(a.Kq,{f:1,children:(0,r.jsx)(er.y,{id:"editable-object-input-"+(null==t?void 0:t.name),..."edit"!=s&&"add"!=s?{bw:0,forceStyle:"hover"}:{},focusStyle:{outlineWidth:1},disabled:"view"==s||"preview"==s||"edit"==s&&x||t._def.dependsOn&&!o[t._def.dependsOn],secureTextEntry:t._def.secret,value:g&&!v(t.name)?g:v(t.name),onChangeText:e=>j(t.name,"ZodNumber"==m.typeName?e.replace(/[^0-9.-]/g,""):e),placeholder:o?null!==(F=null!==(O=t._def.hint)&&void 0!==O?O:t._def.label)&&void 0!==F?F:"number"==typeof t.name?"...":t.name:"",autoFocus:0==i&&0==l,onBlur:()=>{if("ZodNumber"==m.typeName){let e=parseFloat(v(t.name));isNaN(e)||j(t.name,e)}},bc:"$backgroundTransparent"})})})},ea=(0,O.createContext)([[],e=>{}]),eo={color:"var(--color9)",size:"$1",strokeWidth:1},ed=e=>e&&e[0].toUpperCase()+e.slice(1),es={ZodString:"",ZodNumber:"0",ZodBoolean:!0,default:""},ec=e=>es.hasOwnProperty(e)?es[e]:"ZodArray"==e?[]:"ZodObject"==e?{}:es.default,eu=e=>{var t;let{ele:n,i:c,icon:u,children:f,inArray:p=!1}=e,h=!!n.isOptional&&n.isOptional();return(0,r.jsxs)(l.p,{ml:c?"$5":"$0",gap:"$2",f:1,children:[!p&&(0,r.jsxs)(i.__,{fontWeight:"bold",children:[(0,r.jsx)(S.I,{children:(0,r.jsx)(a.Kq,{mr:"$2",children:O.createElement(u,eo)})}),null!==(t=n._def.label)&&void 0!==t?t:n.name,(0,r.jsx)(S.I,{children:!h&&(0,r.jsx)(o.n,{ml:"$1",color:"$color8",children:"*"})})]}),p&&(0,r.jsx)(d.LZ,{size:"$1"}),(0,r.jsx)(s.sL,{children:f})]},c)},ef=e=>{let{ele:t,title:n,children:l,icon:i,simple:a=!1,path:f}=e,[p,h]=(0,O.useContext)(ea),m=[...f,t.name].join("/"),x=(0,r.jsx)(s.sL,{mb:"$2",id:"eo-formgroup",br:"$5",f:1,elevation:p.includes(m)?10:0,hoverStyle:{elevation:10},children:(0,r.jsx)(c.U,{value:p,onValueChange:e=>h(e),onPress:e=>e.stopPropagation(),type:"multiple",boc:"$gray6",f:1,children:(0,r.jsxs)(c.U.Item,{br:"$5",bw:1,boc:"$gray6",value:m,children:[(0,r.jsx)(c.U.Trigger,{p:0,px:8,height:43,bc:"$transparent",focusStyle:{bc:"$transparent"},br:p.includes(m)?"$0":"$5",btlr:"$5",btrr:"$5",bw:"$0",flexDirection:"row",ai:"center",children:e=>{let{open:t}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.b,{o:.8,animation:"quick",rotate:t?"180deg":"0deg",mr:"$1.5",children:(0,r.jsx)(j._,{size:"$1"})}),(0,r.jsx)(S.I,{children:a?O.createElement(i,eo):(0,r.jsx)(r.Fragment,{})}),(0,r.jsx)(o.n,{ml:"$2",children:n}),(0,r.jsx)(d.LZ,{flex:1})]})}}),(0,r.jsx)(c.U.Content,{br:"$5",children:l})]})})});return a?x:(0,r.jsx)(eu,{ele:t,icon:i,i:0,children:x})},ep=e=>{let{index:t,data:n,width:l,columns:i}=e,a=n.ele._def.size<=i?n.ele._def.size:1;return(0,r.jsx)(s.sL,{f:1,width:l*a+(1===a?n.columnMargin/2:(a-1)*n.columnMargin),children:ei({ele:n.ele,icon:n.icon,i:n.i,x:n.x,data:n.data||n.defaultData,setData:n.setData,mode:n.mode,customFields:n.customFields,URLTransform:n.URLTransform})},n.x)},eh=e=>{let{mode:t,onPress:n}=e;return(0,r.jsx)(r.Fragment,{children:("edit"==t||"add"==t)&&(0,r.jsx)(a.Kq,{mr:"$2",top:6,br:"$5",p:"$2",als:"flex-start",cursor:"pointer",position:"absolute",right:"0",pressStyle:{o:.7},hoverStyle:{bc:"$red4"},onPress:n,children:(0,r.jsx)(v.X,{color:"var(--red7)",strokeWidth:2,size:20})})})},em=e=>{let{externalErrorHandling:t,error:n,setError:l,data:i,setData:d,autoWidth:c=!1,columnMargin:u=30,columnWidth:j=350,extraMenuActions:I,disableToggleMode:k,name:T,initialData:D,loadingTop:z,spinnerSize:E,loadingText:N,title:Z,sourceUrl:R=null,onSave:W=(e,t)=>{},mode:q="view",model:K,icons:V={},extraFields:U={},numColumns:M=1,objectId:H,onDelete:B=()=>{},deleteable:G=()=>!0,customFields:J={},URLTransform:X=e=>e,disableAutoChangeMode:Q=!1,...Y}=e,ee=null!=D?D:"add"===q?{data:{}}:(0,w.getPendingResult)("pending"),[et,en]=(0,O.useState)(ee),[er,el]=(0,O.useState)(q),[ei,eo]=(0,O.useState)(""),[es,ec]=(0,O.useState)(ee),eu=i&&d;i&&d||(i=es,d=ec);let[ef,eh]=(0,O.useState)(!1),[em,ex]=(0,O.useState)();n&&l||t||(n=em,l=ex);let[ej,ev]=(0,O.useState)(!1),[ey,eg]=(0,O.useState)(!1),[eb,e$]=(0,O.useState)(!1),ew=(0,O.useRef)(),[eS,e_]=(0,O.useState)([]);(0,$.a)(e=>{"add"!=q&&w.API.get(R,e)},en,D),(0,O.useEffect)(()=>{et.data&&d(et)},[et]),(0,A.rf)(()=>el(q),[q]),(0,A.rf)(()=>{eb?eg(!0):e$(!0)},[i]);let eC=(0,O.useMemo)(()=>{var e=K.load(i.data),t=w.ProtoSchema.load(w.Schema.object(U)).isVisible(er,e),n=e.getObjectSchema().isVisible(er,e).merge(t).getLayout(1);let r={};n.forEach((e,t)=>e.forEach((e,t)=>{e._def.hasOwnProperty("defaultValue")&&(r[e.name]=e._def.defaultValue)})),e=K.load({...r,...i.data}),t=w.ProtoSchema.load(w.Schema.object(U)).isVisible(er,e);let l={};return(n=e.getObjectSchema().isVisible(er,e).merge(t).getLayout(1)).forEach((e,t)=>e.forEach((e,n)=>{var a,o;let s=V[e.name]?V[e.name]:"edit"==er||"add"==er?m.z:x.V,c=null!==(a=e._def.group)&&void 0!==a?a:0;l.hasOwnProperty(c)||(l[c]=[]),e._def.hasOwnProperty("defaultValue")&&(r[e.name]=e._def.defaultValue),l[c].push({id:t+"_"+n,icon:s,i:n,x:t,ele:e,data:i.data,setData:d,mode:er,size:null!==(o=e._def.size)&&void 0!==o?o:1,numColumns:M,customFields:J,columnMargin:u,defaultData:r,URLTransform:X})})),l},[U,i,K,u,M,er,q,et]),eO=(0,O.useMemo)(()=>Object.keys(eC).map((e,t)=>(0,r.jsxs)(s.sL,{ref:ew,width:c?"100%":j*M+(M>1?M:1)*u,f:1,children:[(0,r.jsx)(s.FA,{f:1,children:(0,r.jsx)(g.rj,{masonry:!1,containerRef:ew,spacing:u/2,data:eC[e],card:ep,itemMinWidth:j,columns:M})}),"preview"==er&&(0,r.jsx)(a.Kq,{t:"$-7",children:(0,r.jsx)(P.o,{type:"item",sourceUrl:R,onDelete:B,deleteable:G,element:K.load(i.data),extraMenuActions:I})})]})),[u,eC,j,M]),{tint:eF}=(0,L.d5)();return(0,r.jsx)(ea.Provider,{value:[eS,e_],children:(0,r.jsxs)(a.Kq,{width:"100%",...Y,children:[(0,r.jsx)(C.a,{showCancel:!0,acceptCaption:"Discard",cancelCaption:"Keep editing",onAccept:async()=>{en(await w.API.get(R)),el("view")},cancelTint:eF,acceptTint:"red",open:ej,setOpen:ev,title:"Are you sure you want to leave?",description:"",children:(0,r.jsx)(y.M,{mt:"$5",children:"All unsaved changes will be lost"})}),(0,r.jsx)(b.P,{forceLoad:"add"==er||i.data,waitForLoading:1e3,spinnerSize:E,loadingText:null!=N?N:"Loading "+H,top:null!=z?z:-30,atom:i,children:(0,r.jsxs)(s.FA,{width:"100%",children:[(0,r.jsxs)(s.sL,{ai:"center",children:[(0,r.jsx)(s.sL,{id:"eo-dlg-title",children:null!=Z?Z:(0,r.jsxs)(f.H3,{children:[(0,r.jsx)(S.I,{children:(0,r.jsx)(f.H3,{color:"$color9",children:ed(q)})})," ".concat(ed(T))]})}),!k&&("view"==er||"edit"==er)&&(0,r.jsx)(s.sL,{pressStyle:{o:.8},onPress:async()=>{"edit"==er&&ey?ev(!0):(eo(er),el("view"==er?"edit":"view"))},cursor:"pointer",children:(0,r.jsx)(S.I,{children:(0,r.jsx)(a.Kq,{children:"view"==er?(0,r.jsx)(m.z,{color:"var(--color8)"}):"view"==ei?(0,r.jsx)(v.X,{color:"var(--color8)"}):null})})})]}),(0,r.jsxs)(s.FA,{width:"100%",f:1,mt:Z?"$2":"$0",ai:"center",jc:"center",children:[n&&(0,r.jsx)(_.q,{children:(0,r.jsx)(o.n,{children:(0,F.e)(n.error)})}),eO,"preview"!=er&&(0,r.jsx)(s.FA,{mt:"$4",p:"$2",pb:"$5",width:"100%",f:1,alignSelf:"center",children:("add"==er||"edit"==er)&&!eu&&(0,r.jsx)(S.I,{children:(0,r.jsx)(p.zx,{f:1,onPress:async()=>{eh(!0);try{await W(et.data,i.data),ei==er||Q||el(ei)}catch(e){l(e),console.log("e: ",e)}eh(!1)},children:ef?(0,r.jsx)(h.$,{}):"add"==er?"Create":"Save"})})})]})]})})]})})}},19025:function(e,t,n){n.d(t,{y:function(){return u}});var r=n(52322),l=n(37288),i=n(26602),a=n(39608),o=n(75948),d=n(69517),s=n(2784),c=n(70142);let u=e=>{let{defaultVisible:t=!1,secureTextEntry:n,...u}=e,[f,p]=(0,s.useState)(t);return(0,r.jsxs)(l.sL,{f:1,ai:"center",children:[(0,r.jsx)(i.II,{placeholderTextColor:"$gray9",f:1,secureTextEntry:!!n&&!f,pr:"$7",...u}),n&&(0,r.jsx)(c.I,{children:(0,r.jsx)(d.z,{pos:"absolute",right:"$2",IconColor:f?"var(--color10)":"var(--gray9)",als:"center",onPress:()=>p(!f),Icon:f?a.b:o._})})]})}},72374:function(e,t,n){n.d(t,{rj:function(){return h}});var r=n(52322),l=n(99810),i=n(37288),a=n(2784),o=n(22522),d=n(23724),s=n(64185),c=n(23510);let u={width:0,height:0},f=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],[n,r]=(0,a.useState)(u);return(0,a.useLayoutEffect)(()=>{let{current:t}=e;if(t){let e=()=>{let e=getComputedStyle(t),n=parseFloat,l=t.clientWidth-n(e.paddingTop)-n(e.paddingBottom);r({height:t.clientHeight-n(e.paddingLeft)-n(e.paddingRight),width:l})};return e(),window.addEventListener("resize",e),window.addEventListener("orientationchange",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}}},t.concat(e.current)),n},p=e=>{let[t,n]=(0,a.useState)(!1),[r,l]=(0,a.useState)(0);return(0,a.useLayoutEffect)(()=>{let t;let{current:n}=e;if(n){let e=()=>{t||(t=window.requestAnimationFrame(()=>{l(n.scrollTop),t=void 0}))};return n.addEventListener("scroll",e),()=>{n.removeEventListener("scroll",e),t&&window.cancelAnimationFrame(t)}}},[e.current]),(0,a.useLayoutEffect)(()=>{n(!0);let e=window.setTimeout(()=>{n(!1)},1e3/6);return()=>window.clearTimeout(e)},[r]),{scrollTop:r,isScrolling:t}},h=a.forwardRef((e,t)=>{let{overScanBy:n=5,masonry:u=!0,containerRef:h,rightGap:m=0,spacing:x,children:j,data:v,card:y,columns:g,itemMinWidth:b=200,gap:$}=e;if(l.$L&&v&&y){if(u&&h){var w,S;let e={current:(null===(w=h.current)||void 0===w?void 0:w.container)?null==h?void 0:null===(S=h.current)||void 0===S?void 0:S.container.firstChild:h.current},{width:t,height:r}=f(e),{scrollTop:l,isScrolling:i}=p(e),a=(0,d.G)({width:Math.max(0,t-m),columnGutter:x,columnWidth:b}),o=(0,s.y)(a);return(0,c.$)({positioner:a,scrollTop:l,isScrolling:i,height:r,items:v,overscanBy:n,resizeObserver:o,render:y})}return(0,r.jsx)(i.sL,{flexWrap:"wrap",children:v.map((e,t)=>(0,r.jsxs)(o.Kq,{m:x/2,children:[" ",a.createElement(y,{index:e.index,data:{...e},width:b,columns:g})," "]},t))})}if(l.$L)return(0,r.jsx)("div",{ref:t,style:{gap:$,display:"grid",gridTemplateColumns:"repeat( auto-fill, minmax(".concat(b,"px, 1fr) )")},children:j});let _=a.Children.toArray(j);return(0,r.jsx)(i.sL,{alignItems:"center",justifyContent:"center",flexWrap:"wrap",children:_.map((e,t)=>e?(0,r.jsx)(i.sL,{flex:1,minWidth:b,marginRight:$,marginBottom:$,children:e},t):null)})})},75049:function(e,t,n){n.d(t,{II:function(){return g}});var r=n(52322),l=n(26602),i=n(99810),a=n(92552),o=n(57288),d=n(6364),s=n(82184),c=n(87034),u=n(87453),f=n(72992);let p=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"$true",n=arguments.length>1?arguments[1]:void 0,{props:r}=n,l=(0,c.f)(t,n),i=(0,u.H)(t,n),a=null!==(e=r.rows)&&void 0!==e?e:r.numberOfLines,o="number"==typeof a?a*(0,s.Ve)(i.lineHeight):"auto",d=(0,f.Pj)(t,{shift:-2,bounds:[2]}),p=(0,f.Pj)(t,{shift:-1,bounds:[2]});return{...l,...i,paddingVertical:d,paddingHorizontal:p,height:o}};var h=n(2784);let m=e=>{let{value:t}=e;return(0,r.jsx)("option",{value:t})},x=(0,h.forwardRef)((e,t)=>{let{children:n,listProps:l={},options:i=[],state:a,...o}=e,s="input-select-"+(0,d.Z)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{ref:t,value:null==a?void 0:a.value,onChange:e=>a&&a.set?null==a?void 0:a.set(e.target.value):null,list:s,...o,style:{fontSize:o.fontSize,...o.style}}),(0,r.jsx)("div",{...l,style:{maxHeight:"40px"},children:(0,r.jsxs)("datalist",{className:"datalist",id:s,children:[n,i.map((e,t)=>(0,r.jsx)(m,{value:e},t))]})})]})}),j={size:"$true",fontFamily:"$body",borderWidth:1,outlineWidth:0,color:"$color",...i.$L?{tabIndex:0}:{focusable:!0},borderColor:"$borderColor",backgroundColor:"$background",minWidth:0,hoverStyle:{borderColor:"$borderColorHover"},focusStyle:{outlineColor:"$borderColorFocus",outlineWidth:2,outlineStyle:"solid",borderColor:"$borderColorFocus"}},v=(0,a.z)(x,{name:"Input",acceptsClassName:!0,variants:{unstyled:{false:j},size:{"...size":function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"$true",n=arguments.length>1?arguments[1]:void 0;if(n.props.multiline||n.props.numberOfLines>1)return p(t,n);let r=(0,c.f)(t,n),l=(0,f.Pj)(t,{shift:-1,bounds:[2]}),a=(0,u.H)(t,n);return!i.$L&&a&&delete a.lineHeight,{...a,fontSize:null!==(e=a.fontSize.val)&&void 0!==e?e:a.fontSize,...r,paddingHorizontal:l}}}},defaultVariants:{unstyled:!1}},{isInput:!0}),y=v.styleable((e,t)=>{let n=(0,l.kp)(e,t);return(0,r.jsx)(v,{...n})}),g=(0,o.$e)(y,{Option:m})},41771:function(e,t,n){n.d(t,{S:function(){return c}});var r=n(52322),l=n(47246),i=n(37288),a=n(51775),o=n(90251),d=n(31288),s=n(75049);let c=e=>{let{color:t,onChange:n,placeholder:c,inputProps:u,mode:f,presetColors:p,popoverProps:h={},disabled:m=!1}=e,x=(0,l.Fg)();return m?(0,r.jsxs)(i.sL,{f:1,children:[(0,r.jsx)(s.II,{f:1,value:t,placeholder:null!=c?c:"#000000",disabled:!0,...u}),(0,r.jsx)(a.b,{size:"$2",backgroundColor:t,borderColor:"$color",borderRadius:"$2",position:"absolute",borderWidth:"$0.5",right:"8px",top:"8px",opacity:.6,style:{pointerEvents:"none"}})]}):(0,r.jsxs)(o.J2,{allowFlip:!0,children:[(0,r.jsxs)(o.J2.Trigger,{f:1,children:[(0,r.jsx)(s.II,{f:1,value:t,placeholder:null!=c?c:"#000000",...u}),(0,r.jsx)(a.b,{size:"$2",backgroundColor:t,borderColor:"$color",borderRadius:"$2",cursor:"pointer",position:"absolute",borderWidth:"$0.5",right:"8px",top:"8px"})]}),(0,r.jsx)(o.J2.Content,{backgroundColor:"$bgPanel",width:"250px",shadowRadius:"$4",shadowColor:"black",shadowOpacity:.3,...h,children:"custom"==f?(0,r.jsx)(i.sL,{gap:"$2",flexWrap:"wrap",children:null==p?void 0:p.map(e=>(0,r.jsx)(a.b,{size:30,backgroundColor:"default"==e?"transparent":e,borderRadius:"$2",cursor:"pointer",borderWidth:t===e?3:1,borderColor:"default"==e?"$red8":t===e?"$color":"$gray7",onPress:()=>n(e)},e))}):(0,r.jsx)(d.xS,{color:t,presetColors:null!=p?p:[x.orange9.val,x.yellow9.val,x.green9.val,x.blue9.val,x.purple9.val,x.pink9.val,x.red9.val,x.gray9.val,x.orange7.val,x.yellow7.val,x.green7.val,x.blue7.val,x.purple7.val,x.pink7.val,x.red7.val,x.gray7.val],onChange:n,disableAlpha:!0,styles:{default:{picker:{background:"transparent",border:"0px",boxShadow:"none",width:"210px"}}}})})]})}},3471:function(e,t,n){n.d(t,{C:function(){return s}});var r=n(52322),l=n(37288),i=n(78994),a=n(60166),o=n(2784),d=n(70142);function s(e){let{choices:t,defaultSelections:n=[],onSetSelections:s=e=>{},containerProps:c={},disabled:u=!1,...f}=e,p=(0,o.useRef)(null),[h,m]=(0,o.useState)(!1),[x,j]=(0,o.useState)(n),v=(e,n)=>{var r;if(u)return;null==e||null===(r=e.stopPropagation)||void 0===r||r.call(e);let l=t[t.indexOf(n)];if(x.includes(l)){let e=x.filter(e=>e!==l);s(e),j(e)}else{let e=x.concat(l);s(e),j(e)}};return(0,r.jsx)(d.I,{children:(0,r.jsxs)(l.sL,{ref:p,bc:"$backgroundTransparent",w:"100%",h:"fit-content",jc:"space-between",ai:"center",px:"10px",py:"7px",br:6,outlineColor:"$gray6",outlineWidth:1,outlineStyle:"solid",boc:"$gray6",cursor:u?"default":"pointer",onPress:()=>{u||m(e=>!e)},o:u?.6:1,...f,children:[(0,r.jsx)(l.sL,{fw:"wrap",h:"fit-content",ov:"hidden",f:1,gap:"$1.5",children:x.length>0?x.map((e,t)=>(0,r.jsx)(i.n,{px:"7px",py:"4px",bc:"$color7",br:4,color:"white",onPress:t=>v(t,e),children:e},t)):(0,r.jsx)(i.n,{px:"7px",py:"4px",br:4,color:"$gray8",children:"Select"})}),(0,r.jsx)(a._,{}),h?(0,r.jsx)(l.FA,{zIndex:999999999,pos:"absolute",top:"130%",left:"0%",width:"100%",bc:"$gray1",px:"7px",py:"7px",br:4,outlineColor:"$gray6",outlineWidth:1,outlineStyle:"solid",borderColor:"$borderColor",maxHeight:"150px",gap:"$1.5",ov:"scroll",...c,children:t.map((e,t)=>x.includes(e)?(0,r.jsx)(i.n,{px:"10px",py:"7px",br:4,fontSize:"$5",fontFamily:"$body",bc:"$color7",hoverStyle:{cursor:"pointer"},onPress:t=>v(t,e),children:e},t):(0,r.jsx)(i.n,{px:"10px",py:"7px",br:4,fontSize:"$5",fontFamily:"$body",color:"$color",hoverStyle:{bc:"$backgroundPress",cursor:"pointer"},onPress:t=>v(t,e),children:e}))}):null]})})}}}]);