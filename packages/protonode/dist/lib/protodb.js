var a=Object.defineProperty;var g=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var l=Object.prototype.hasOwnProperty;var y=(e,t)=>{for(var s in t)a(e,s,{get:t[s],enumerable:!0})},u=(e,t,s,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of p(t))!l.call(e,o)&&o!==s&&a(e,o,{get:()=>t[o],enumerable:!(n=g(t,o))||n.enumerable});return e};var h=e=>u(a({},"__esModule",{value:!0}),e);var d={};y(d,{ProtoDB:()=>r});module.exports=h(d);var c=require("protobase"),b=(0,c.getLogger)(),i={},r=class{constructor(t,s,n){this.location=t,this.options=s,this.config=n??{},this.capabilities=[],n&&n.context&&n.name&&(n.context[n.name]=this)}get status(){return"open"}on(t,s){t=="open"&&s()}hasCapability(t){return this.capabilities.includes(t)}async close(){}async exists(t){try{return!!this.get(t)}catch{return!1}}static getInstance(t,s,n){throw"Error: derived classes of ProtoDB should implement getInstance"}static connect(t,s,n){return t in i||(i[t]=this.getInstance(t,s,n),process.on("SIGINT",async()=>{b.info("Closing database and terminating process..."),await i[t].close(),process.exit(0)})),i[t]}static async closeDBS(){let t=Object.keys(i);for(let s of t)await i[s].close()}static async initDB(t,s={},n){throw new Error("Static method initDB must be implemented")}};0&&(module.exports={ProtoDB});
